window.cvat=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(e,t,n){(()=>{const t=n(25),r=n(27),i=n(10);class s extends Error{constructor(e){super(e);const n=(new Date).toISOString(),s=t.os.toString(),a=`${t.name} ${t.version}`,o=r.parse(this)[0],c=`${o.fileName}`,u=o.lineNumber,l=o.columnNumber,{jobID:h,taskID:p,clientID:f}=i;Object.defineProperties(this,Object.freeze({system:{get:()=>s},client:{get:()=>a},time:{get:()=>n},jobID:{get:()=>h},taskID:{get:()=>p},projID:{get:()=>{}},clientID:{get:()=>f},filename:{get:()=>c},line:{get:()=>u},column:{get:()=>l}}))}async save(){const e={system:this.system,client:this.client,time:this.time,job_id:this.jobID,task_id:this.taskID,proj_id:this.projID,client_id:this.clientID,message:this.message,filename:this.filename,line:this.line,column:this.column,stack:this.stack};try{const t=n(4);await t.server.exception(e)}catch(e){}}}e.exports={Exception:s,ArgumentError:class extends s{constructor(e){super(e)}},DataError:class extends s{constructor(e){super(e)}},ScriptingError:class extends s{constructor(e){super(e)}},PluginError:class extends s{constructor(e){super(e)}},ServerError:class extends s{constructor(e,t){super(e),Object.defineProperties(this,Object.freeze({code:{get:()=>t}}))}}}})()},function(e,t,n){"use strict";var r=n(15),i=n(44),s=Object.prototype.toString;function a(e){return"[object Array]"===s.call(e)}function o(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===s.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:i,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:c,isStream:function(e){return o(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t){(()=>{const t=Object.freeze({DIR:"DIR",REG:"REG"}),n=Object.freeze({ANNOTATION:"annotation",VALIDATION:"validation",COMPLETED:"completed"}),r=Object.freeze({ANNOTATION:"annotation",INTERPOLATION:"interpolation"}),i=Object.freeze({CHECKBOX:"checkbox",RADIO:"radio",SELECT:"select",NUMBER:"number",TEXT:"text"}),s=Object.freeze({TAG:"tag",SHAPE:"shape",TRACK:"track"}),a=Object.freeze({RECTANGLE:"rectangle",POLYGON:"polygon",POLYLINE:"polyline",POINTS:"points",CUBOID:"cuboid"}),o=Object.freeze({loadJob:"Load job",saveJob:"Save job",restoreJob:"Restore job",uploadAnnotations:"Upload annotations",sendUserActivity:"Send user activity",sendException:"Send exception",sendTaskInfo:"Send task info",drawObject:"Draw object",pasteObject:"Paste object",copyObject:"Copy object",propagateObject:"Propagate object",dragObject:"Drag object",resizeObject:"Resize object",deleteObject:"Delete object",lockObject:"Lock object",mergeObjects:"Merge objects",changeAttribute:"Change attribute",changeLabel:"Change label",changeFrame:"Change frame",moveImage:"Move image",zoomImage:"Zoom image",fitImage:"Fit image",rotateImage:"Rotate image",undoAction:"Undo action",redoAction:"Redo action",pressShortcut:"Press shortcut",debugInfo:"Debug info"}),c=Object.freeze({CHANGED_LABEL:"Changed label",CHANGED_ATTRIBUTES:"Changed attributes",CHANGED_POINTS:"Changed points",CHANGED_OUTSIDE:"Changed outside",CHANGED_OCCLUDED:"Changed occluded",CHANGED_ZORDER:"Changed z-order",CHANGED_KEYFRAME:"Changed keyframe",CHANGED_LOCK:"Changed lock",CHANGED_PINNED:"Changed pinned",CHANGED_COLOR:"Changed color",CHANGED_HIDDEN:"Changed hidden",MERGED_OBJECTS:"Merged objects",SPLITTED_TRACK:"Splitted track",GROUPED_OBJECTS:"Grouped objects",CREATED_OBJECTS:"Created objects",REMOVED_OBJECT:"Removed object"});e.exports={ShareFileType:t,TaskStatus:n,TaskMode:r,AttributeType:i,ObjectType:s,ObjectShape:a,LogType:o,HistoryActions:c,colors:["#FF355E","#E936A7","#FD5B78","#FF007C","#FF00CC","#66FF66","#50BFE6","#CCFF00","#FFFF66","#FF9966","#FF6037","#FFCC33","#AAF0D1","#FF3855","#FFF700","#A7F432","#FF5470","#FAFA37","#FF7A00","#FF9933","#AFE313","#00CC99","#FF5050","#733380"]}})()},function(e,t,n){(()=>{const{PluginError:t}=n(0),r=[];class i{static async apiWrapper(e,...n){const r=await i.list();for(const i of r){const r=i.functions.filter(t=>t.callback===e)[0];if(r&&r.enter)try{await r.enter.call(this,i,...n)}catch(e){throw e instanceof t?e:new t(`Exception in plugin ${i.name}: ${e.toString()}`)}}let s=await e.implementation.call(this,...n);for(const i of r){const r=i.functions.filter(t=>t.callback===e)[0];if(r&&r.leave)try{s=await r.leave.call(this,i,s,...n)}catch(e){throw e instanceof t?e:new t(`Exception in plugin ${i.name}: ${e.toString()}`)}}return s}static async register(e){const n=[];if("object"!=typeof e)throw new t(`Plugin should be an object, but got "${typeof e}"`);if(!("name"in e)||"string"!=typeof e.name)throw new t('Plugin must contain a "name" field and it must be a string');if(!("description"in e)||"string"!=typeof e.description)throw new t('Plugin must contain a "description" field and it must be a string');if("functions"in e)throw new t('Plugin must not contain a "functions" field');!function e(t,r){const i={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&("object"==typeof t[n]?Object.prototype.hasOwnProperty.call(r,n)&&e(t[n],r[n]):["enter","leave"].includes(n)&&"function"==typeof r&&(t[n],1)&&(i.callback=r,i[n]=t[n]));Object.keys(i).length&&n.push(i)}(e,{cvat:this}),Object.defineProperty(e,"functions",{value:n,writable:!1}),r.push(e)}static async list(){return r}}e.exports=i})()},function(e,t,n){(()=>{const t=n(29),{ServerError:r}=n(0),i=n(30),s=n(10),a=n(41);function o(e){if(e.response){const t=`${e.message}. ${JSON.stringify(e.response.data)||""}.`;return new r(t,e.response.status)}const t=`${e.message}.`;return new r(t,0)}class c{constructor(){const e=new a,t={};let n=0;e.onmessage=e=>{e.data.id in t&&(e.data.isSuccess?t[e.data.id].resolve(e.data.responseData):t[e.data.id].reject(e.data.error),delete t[e.data.id])},e.onerror=e=>{e.data.id in t&&(t[e.data.id].reject(e),delete t[e.data.id])},Object.defineProperties(this,Object.freeze({get:{value:async function(r,i){return new Promise((s,a)=>{const o=n++;t[o]={resolve:s,reject:a},e.postMessage({url:r,config:i,id:o})})},writable:!1}}))}}const u=new class{constructor(){const a=n(42);a.defaults.withCredentials=!0,a.defaults.xsrfHeaderName="X-CSRFTOKEN",a.defaults.xsrfCookieName="csrftoken";const u=new c;let l=i.get("token");async function h(e=""){const{backendAPI:t}=s;let n=null;try{n=await a.get(`${t}/tasks?page_size=10&${e}`,{proxy:s.proxy})}catch(e){throw o(e)}return n.data.results.count=n.data.count,n.data.results}async function p(e){const{backendAPI:t}=s;try{await a.delete(`${t}/tasks/${e}`)}catch(e){throw o(e)}}l&&(a.defaults.headers.common.Authorization=`Token ${l}`),Object.defineProperties(this,Object.freeze({server:{value:Object.freeze({about:async function(){const{backendAPI:e}=s;let t=null;try{t=await a.get(`${e}/server/about`,{proxy:s.proxy})}catch(e){throw o(e)}return t.data},share:async function(e){const{backendAPI:t}=s;e=encodeURIComponent(e);let n=null;try{n=await a.get(`${t}/server/share?directory=${e}`,{proxy:s.proxy})}catch(e){throw o(e)}return n.data},formats:async function(){const{backendAPI:e}=s;let t=null;try{t=await a.get(`${e}/server/annotation/formats`,{proxy:s.proxy})}catch(e){throw o(e)}return t.data},exception:async function(e){const{backendAPI:t}=s;try{await a.post(`${t}/server/exception`,JSON.stringify(e),{proxy:s.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw o(e)}},login:async function(e,t){const n=[`${encodeURIComponent("username")}=${encodeURIComponent(e)}`,`${encodeURIComponent("password")}=${encodeURIComponent(t)}`].join("&").replace(/%20/g,"+");a.defaults.headers.common.Authorization="";let r=null;try{r=await a.post(`${s.backendAPI}/auth/login`,n,{proxy:s.proxy})}catch(e){throw o(e)}if(r.headers["set-cookie"]){const e=r.headers["set-cookie"].join(";");a.defaults.headers.common.Cookie=e}l=r.data.key,i.set("token",l),a.defaults.headers.common.Authorization=`Token ${l}`},logout:async function(){try{await a.post(`${s.backendAPI}/auth/logout`,{proxy:s.proxy})}catch(e){throw o(e)}i.remove("token"),a.defaults.headers.common.Authorization=""},authorized:async function(){try{await e.exports.users.getSelf()}catch(e){if(401===e.code)return!1;throw e}return!0},register:async function(e,t,n,r,i,c){let u=null;try{const o=JSON.stringify({username:e,first_name:t,last_name:n,email:r,password1:i,password2:c});u=await a.post(`${s.backendAPI}/auth/register`,o,{proxy:s.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw o(e)}return u.data},request:async function(e,t){try{return(await a({url:e,...t})).data}catch(e){throw o(e)}}}),writable:!1},tasks:{value:Object.freeze({getTasks:h,saveTask:async function(e,t){const{backendAPI:n}=s;try{await a.patch(`${n}/tasks/${e}`,JSON.stringify(t),{proxy:s.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw o(e)}},createTask:async function(e,n,i){const{backendAPI:c}=s,u=new t;for(const[e,t]of Object.entries(n))Array.isArray(t)?t.forEach((t,n)=>{u.append(`${e}[${n}]`,t)}):u.set(e,t);let l=null;i("The task is being created on the server..");try{l=await a.post(`${c}/tasks`,JSON.stringify(e),{proxy:s.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw o(e)}i("The data is being uploaded to the server..");try{await a.post(`${c}/tasks/${l.data.id}/data`,u,{proxy:s.proxy})}catch(e){try{await p(l.data.id)}catch(e){}throw o(e)}try{await async function(e){return new Promise((t,n)=>{setTimeout((async function s(){try{const o=await a.get(`${c}/tasks/${e}/status`);if(["Queued","Started"].includes(o.data.state))""!==o.data.message&&i(o.data.message),setTimeout(s,1e3);else if("Finished"===o.data.state)t();else if("Failed"===o.data.state){const e="Could not create the task on the server. "+`${o.data.message}.`;n(new r(e,400))}else n(new r(`Unknown task state has been received: ${o.data.state}`,500))}catch(e){n(o(e))}}),1e3)})}(l.data.id)}catch(e){throw await p(l.data.id),e}return(await h(`?id=${l.id}`))[0]},deleteTask:p,exportDataset:async function(e,t){const{backendAPI:n}=s;let r=`${n}/tasks/${e}/dataset?format=${t}`;return new Promise((e,t)=>{setTimeout((async function n(){try{202===(await a.get(`${r}`,{proxy:s.proxy})).status?setTimeout(n,3e3):(r=`${r}&action=download`,e(r))}catch(e){t(o(e))}}))})}}),writable:!1},jobs:{value:Object.freeze({getJob:async function(e){const{backendAPI:t}=s;let n=null;try{n=await a.get(`${t}/jobs/${e}`,{proxy:s.proxy})}catch(e){throw o(e)}return n.data},saveJob:async function(e,t){const{backendAPI:n}=s;try{await a.patch(`${n}/jobs/${e}`,JSON.stringify(t),{proxy:s.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw o(e)}}}),writable:!1},users:{value:Object.freeze({getUsers:async function(e=null){const{backendAPI:t}=s;let n=null;try{n=null===e?await a.get(`${t}/users?page_size=all`,{proxy:s.proxy}):await a.get(`${t}/users/${e}`,{proxy:s.proxy})}catch(e){throw o(e)}return n.data.results},getSelf:async function(){const{backendAPI:e}=s;let t=null;try{t=await a.get(`${e}/users/self`,{proxy:s.proxy})}catch(e){throw o(e)}return t.data}}),writable:!1},frames:{value:Object.freeze({getData:async function(e,t){const{backendAPI:n}=s;let r=null;try{r=await u.get(`${n}/tasks/${e}/data?type=chunk&number=${t}&quality=compressed`,{proxy:s.proxy,responseType:"arraybuffer"})}catch(e){throw o(e)}return r},getMeta:async function(e){const{backendAPI:t}=s;let n=null;try{n=await a.get(`${t}/tasks/${e}/data/meta`,{proxy:s.proxy})}catch(e){throw o(e)}return n.data},getPreview:async function(e){const{backendAPI:t}=s;let n=null;try{n=await a.get(`${t}/tasks/${e}/data?type=preview`,{proxy:s.proxy,responseType:"blob"})}catch(t){const n=t.response?t.response.status:t.code;throw new r(`Could not get preview frame for the task ${e} from the server`,n)}return n.data}}),writable:!1},annotations:{value:Object.freeze({updateAnnotations:async function(e,t,n,r){const{backendAPI:i}=s;let c=null,u=null;"PUT"===r.toUpperCase()?(c=a.put.bind(a),u=`${i}/${e}s/${t}/annotations`):(c=a.patch.bind(a),u=`${i}/${e}s/${t}/annotations?action=${r}`);let l=null;try{l=await c(u,JSON.stringify(n),{proxy:s.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw o(e)}return l.data},getAnnotations:async function(e,t){const{backendAPI:n}=s;let r=null;try{r=await a.get(`${n}/${e}s/${t}/annotations`,{proxy:s.proxy})}catch(e){throw o(e)}return r.data},dumpAnnotations:async function(e,t,n){const{backendAPI:r}=s,i=`${r}/tasks/${e}/annotations`;let c=`format=${encodeURIComponent(n)}`;if(t){const e=t.replace(/\//g,"_");c+=`&filename=${encodeURIComponent(e)}`}let u=`${i}?${c}`;return new Promise((e,t)=>{setTimeout((async function n(){a.get(`${u}`,{proxy:s.proxy}).then(t=>{202===t.status?setTimeout(n,3e3):(c=`${c}&action=download`,u=`${i}?${c}`,e(u))}).catch(e=>{t(o(e))})}))})},uploadAnnotations:async function(e,n,r,i){const{backendAPI:c}=s;let u=new t;return u.append("annotation_file",r),new Promise((r,l)=>{setTimeout((async function h(){try{202===(await a.put(`${c}/${e}s/${n}/annotations?format=${i}`,u,{proxy:s.proxy})).status?(u=new t,setTimeout(h,3e3)):r()}catch(e){l(o(e))}}))})}}),writable:!1},logs:{value:Object.freeze({save:async function(e){const{backendAPI:t}=s;try{await a.post(`${t}/server/logs`,JSON.stringify(e),{proxy:s.proxy,headers:{"Content-Type":"application/json"}})}catch(e){throw o(e)}}}),writable:!1}}))}};e.exports=u})()},function(e,t,n){(function(t){var n=Object.assign?Object.assign:function(e,t,n,r){for(var i=1;i<arguments.length;i++)o(Object(arguments[i]),(function(t,n){e[n]=t}));return e},r=function(){if(Object.create)return function(e,t,r,i){var s=a(arguments,1);return n.apply(this,[Object.create(e)].concat(s))};{function e(){}return function(t,r,i,s){var o=a(arguments,1);return e.prototype=t,n.apply(this,[new e].concat(o))}}}(),i=String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},s="undefined"!=typeof window?window:t;function a(e,t){return Array.prototype.slice.call(e,t||0)}function o(e,t){c(e,(function(e,n){return t(e,n),!1}))}function c(e,t){if(u(e)){for(var n=0;n<e.length;n++)if(t(e[n],n))return e[n]}else for(var r in e)if(e.hasOwnProperty(r)&&t(e[r],r))return e[r]}function u(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}e.exports={assign:n,create:r,trim:i,bind:function(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}},slice:a,each:o,map:function(e,t){var n=u(e)?[]:{};return c(e,(function(e,r){return n[r]=t(e,r),!1})),n},pluck:c,isList:u,isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isObject:function(e){return e&&"[object Object]"==={}.toString.call(e)},Global:s}}).call(this,n(6))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(()=>{const t=n(3),r=n(20),i=n(4),{getFrame:s,getRanges:a,getPreview:o}=n(61),{ArgumentError:c}=n(0),{TaskStatus:u}=n(2),{Label:l}=n(8),h=n(14);function p(e){Object.defineProperties(e,{annotations:Object.freeze({value:{async upload(n,r){return await t.apiWrapper.call(this,e.annotations.upload,n,r)},async save(n){return await t.apiWrapper.call(this,e.annotations.save,n)},async clear(n=!1){return await t.apiWrapper.call(this,e.annotations.clear,n)},async dump(n,r=null){return await t.apiWrapper.call(this,e.annotations.dump,n,r)},async statistics(){return await t.apiWrapper.call(this,e.annotations.statistics)},async put(n=[]){return await t.apiWrapper.call(this,e.annotations.put,n)},async get(n,r=!1,i=[]){return await t.apiWrapper.call(this,e.annotations.get,n,r,i)},async search(n,r,i){return await t.apiWrapper.call(this,e.annotations.search,n,r,i)},async select(n,r,i){return await t.apiWrapper.call(this,e.annotations.select,n,r,i)},async merge(n){return await t.apiWrapper.call(this,e.annotations.merge,n)},async split(n,r){return await t.apiWrapper.call(this,e.annotations.split,n,r)},async group(n,r=!1){return await t.apiWrapper.call(this,e.annotations.group,n,r)},async import(n){return await t.apiWrapper.call(this,e.annotations.import,n)},async export(){return await t.apiWrapper.call(this,e.annotations.export)},async exportDataset(n){return await t.apiWrapper.call(this,e.annotations.exportDataset,n)},hasUnsavedChanges(){return e.annotations.hasUnsavedChanges.implementation.call(this)}},writable:!0}),frames:Object.freeze({value:{async get(n,r=!1,i=1){return await t.apiWrapper.call(this,e.frames.get,n,r,i)},async ranges(){return await t.apiWrapper.call(this,e.frames.ranges)},async preview(){return await t.apiWrapper.call(this,e.frames.preview)}},writable:!0}),logger:Object.freeze({value:{async log(n,r={},i=!1){return await t.apiWrapper.call(this,e.logger.log,n,r,i)}},writable:!0}),actions:Object.freeze({value:{async undo(n=1){return await t.apiWrapper.call(this,e.actions.undo,n)},async redo(n=1){return await t.apiWrapper.call(this,e.actions.redo,n)},async clear(){return await t.apiWrapper.call(this,e.actions.clear)},async get(){return await t.apiWrapper.call(this,e.actions.get)}},writable:!0}),events:Object.freeze({value:{async subscribe(n,r){return await t.apiWrapper.call(this,e.events.subscribe,n,r)},async unsubscribe(n,r=null){return await t.apiWrapper.call(this,e.events.unsubscribe,n,r)}},writable:!0})})}class f{constructor(){}}class d extends f{constructor(e){super();const t={id:void 0,assignee:void 0,status:void 0,start_frame:void 0,stop_frame:void 0,task:void 0};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&(n in e&&(t[n]=e[n]),void 0===t[n]))throw new c(`Job field "${n}" was not initialized`);Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},assignee:{get:()=>t.assignee,set:e=>{if(null!==e&&!(e instanceof h))throw new c("Value must be a user instance");t.assignee=e}},status:{get:()=>t.status,set:e=>{const n=u;let r=!1;for(const t in n)if(n[t]===e){r=!0;break}if(!r)throw new c("Value must be a value from the enumeration cvat.enums.TaskStatus");t.status=e}},startFrame:{get:()=>t.start_frame},stopFrame:{get:()=>t.stop_frame},task:{get:()=>t.task}})),this.annotations={get:Object.getPrototypeOf(this).annotations.get.bind(this),put:Object.getPrototypeOf(this).annotations.put.bind(this),save:Object.getPrototypeOf(this).annotations.save.bind(this),dump:Object.getPrototypeOf(this).annotations.dump.bind(this),merge:Object.getPrototypeOf(this).annotations.merge.bind(this),split:Object.getPrototypeOf(this).annotations.split.bind(this),group:Object.getPrototypeOf(this).annotations.group.bind(this),clear:Object.getPrototypeOf(this).annotations.clear.bind(this),search:Object.getPrototypeOf(this).annotations.search.bind(this),upload:Object.getPrototypeOf(this).annotations.upload.bind(this),select:Object.getPrototypeOf(this).annotations.select.bind(this),import:Object.getPrototypeOf(this).annotations.import.bind(this),export:Object.getPrototypeOf(this).annotations.export.bind(this),statistics:Object.getPrototypeOf(this).annotations.statistics.bind(this),hasUnsavedChanges:Object.getPrototypeOf(this).annotations.hasUnsavedChanges.bind(this)},this.actions={undo:Object.getPrototypeOf(this).actions.undo.bind(this),redo:Object.getPrototypeOf(this).actions.redo.bind(this),clear:Object.getPrototypeOf(this).actions.clear.bind(this),get:Object.getPrototypeOf(this).actions.get.bind(this)},this.frames={get:Object.getPrototypeOf(this).frames.get.bind(this),ranges:Object.getPrototypeOf(this).frames.ranges.bind(this),preview:Object.getPrototypeOf(this).frames.preview.bind(this)},this.logger={log:Object.getPrototypeOf(this).logger.log.bind(this)}}async save(){return await t.apiWrapper.call(this,d.prototype.save)}}class m extends f{constructor(e){super();const t={id:void 0,name:void 0,status:void 0,size:void 0,mode:void 0,owner:void 0,assignee:void 0,created_date:void 0,updated_date:void 0,bug_tracker:void 0,overlap:void 0,segment_size:void 0,z_order:void 0,image_quality:void 0,start_frame:void 0,stop_frame:void 0,frame_filter:void 0,data_chunk_size:void 0,data_compressed_chunk_type:void 0,data_original_chunk_type:void 0,use_zip_chunks:void 0};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n in e&&(t[n]=e[n]);if(t.labels=[],t.jobs=[],t.files=Object.freeze({server_files:[],client_files:[],remote_files:[]}),Array.isArray(e.segments))for(const n of e.segments)if(Array.isArray(n.jobs))for(const e of n.jobs){const r=new d({url:e.url,id:e.id,assignee:e.assignee,status:e.status,start_frame:n.start_frame,stop_frame:n.stop_frame,task:this});t.jobs.push(r)}if(Array.isArray(e.labels))for(const n of e.labels){const e=new l(n);t.labels.push(e)}Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},name:{get:()=>t.name,set:e=>{if(!e.trim().length)throw new c("Value must not be empty");t.name=e}},status:{get:()=>t.status},size:{get:()=>t.size},mode:{get:()=>t.mode},owner:{get:()=>t.owner},assignee:{get:()=>t.assignee,set:e=>{if(null!==e&&!(e instanceof h))throw new c("Value must be a user instance");t.assignee=e}},createdDate:{get:()=>t.created_date},updatedDate:{get:()=>t.updated_date},bugTracker:{get:()=>t.bug_tracker,set:e=>{t.bug_tracker=e}},overlap:{get:()=>t.overlap,set:e=>{if(!Number.isInteger(e)||e<0)throw new c("Value must be a non negative integer");t.overlap=e}},segmentSize:{get:()=>t.segment_size,set:e=>{if(!Number.isInteger(e)||e<0)throw new c("Value must be a positive integer");t.segment_size=e}},zOrder:{get:()=>t.z_order,set:e=>{if("boolean"!=typeof e)throw new c("Value must be a boolean");t.z_order=e}},imageQuality:{get:()=>t.image_quality,set:e=>{if(!Number.isInteger(e)||e<0)throw new c("Value must be a positive integer");t.image_quality=e}},useZipChunks:{get:()=>t.use_zip_chunks,set:e=>{if("boolean"!=typeof e)throw new c("Value must be a boolean");t.use_zip_chunks=e}},labels:{get:()=>[...t.labels],set:e=>{if(!Array.isArray(e))throw new c("Value must be an array of Labels");for(const t of e)if(!(t instanceof l))throw new c("Each array value must be an instance of Label. "+`${typeof t} was found`);t.labels=[...e]}},jobs:{get:()=>[...t.jobs]},serverFiles:{get:()=>[...t.files.server_files],set:e=>{if(!Array.isArray(e))throw new c(`Value must be an array. But ${typeof e} has been got.`);for(const t of e)if("string"!=typeof t)throw new c(`Array values must be a string. But ${typeof t} has been got.`);Array.prototype.push.apply(t.files.server_files,e)}},clientFiles:{get:()=>[...t.files.client_files],set:e=>{if(!Array.isArray(e))throw new c(`Value must be an array. But ${typeof e} has been got.`);for(const t of e)if(!(t instanceof File))throw new c(`Array values must be a File. But ${t.constructor.name} has been got.`);Array.prototype.push.apply(t.files.client_files,e)}},remoteFiles:{get:()=>[...t.files.remote_files],set:e=>{if(!Array.isArray(e))throw new c(`Value must be an array. But ${typeof e} has been got.`);for(const t of e)if("string"!=typeof t)throw new c(`Array values must be a string. But ${typeof t} has been got.`);Array.prototype.push.apply(t.files.remote_files,e)}},startFrame:{get:()=>t.start_frame,set:e=>{if(!Number.isInteger(e)||e<0)throw new c("Value must be a not negative integer");t.start_frame=e}},stopFrame:{get:()=>t.stop_frame,set:e=>{if(!Number.isInteger(e)||e<0)throw new c("Value must be a not negative integer");t.stop_frame=e}},frameFilter:{get:()=>t.frame_filter,set:e=>{if("string"!=typeof e)throw new c(`Filter value must be a string. But ${typeof e} has been got.`);t.frame_filter=e}},dataChunkSize:{get:()=>t.data_chunk_size,set:e=>{if("number"!=typeof e||e<1)throw new c(`Chunk size value must be a positive number. But value ${e} has been got.`);t.data_chunk_size=e}},dataChunkType:{get:()=>t.data_compressed_chunk_type}})),this.annotations={get:Object.getPrototypeOf(this).annotations.get.bind(this),put:Object.getPrototypeOf(this).annotations.put.bind(this),save:Object.getPrototypeOf(this).annotations.save.bind(this),dump:Object.getPrototypeOf(this).annotations.dump.bind(this),merge:Object.getPrototypeOf(this).annotations.merge.bind(this),split:Object.getPrototypeOf(this).annotations.split.bind(this),group:Object.getPrototypeOf(this).annotations.group.bind(this),clear:Object.getPrototypeOf(this).annotations.clear.bind(this),search:Object.getPrototypeOf(this).annotations.search.bind(this),upload:Object.getPrototypeOf(this).annotations.upload.bind(this),select:Object.getPrototypeOf(this).annotations.select.bind(this),import:Object.getPrototypeOf(this).annotations.import.bind(this),export:Object.getPrototypeOf(this).annotations.export.bind(this),statistics:Object.getPrototypeOf(this).annotations.statistics.bind(this),hasUnsavedChanges:Object.getPrototypeOf(this).annotations.hasUnsavedChanges.bind(this),exportDataset:Object.getPrototypeOf(this).annotations.exportDataset.bind(this)},this.actions={undo:Object.getPrototypeOf(this).actions.undo.bind(this),redo:Object.getPrototypeOf(this).actions.redo.bind(this),clear:Object.getPrototypeOf(this).actions.clear.bind(this),get:Object.getPrototypeOf(this).actions.get.bind(this)},this.frames={get:Object.getPrototypeOf(this).frames.get.bind(this),ranges:Object.getPrototypeOf(this).frames.ranges.bind(this),preview:Object.getPrototypeOf(this).frames.preview.bind(this)},this.logger={log:Object.getPrototypeOf(this).logger.log.bind(this)}}async save(e=(()=>{})){return await t.apiWrapper.call(this,m.prototype.save,e)}async delete(){return await t.apiWrapper.call(this,m.prototype.delete)}}e.exports={Job:d,Task:m};const{getAnnotations:b,putAnnotations:y,saveAnnotations:g,hasUnsavedChanges:v,searchAnnotations:w,mergeAnnotations:k,splitAnnotations:S,groupAnnotations:x,clearAnnotations:O,selectObject:_,annotationsStatistics:E,uploadAnnotations:C,dumpAnnotations:j,importAnnotations:T,exportAnnotations:I,exportDataset:A,undoActions:P,redoActions:N,clearActions:D,getActions:R}=n(69);p(d.prototype),p(m.prototype),d.prototype.save.implementation=async function(){if(this.id){const e={status:this.status,assignee:this.assignee?this.assignee.id:null};return await i.jobs.saveJob(this.id,e),this}throw new c("Can not save job without and id")},d.prototype.frames.get.implementation=async function(e,t,n){if(!Number.isInteger(e)||e<0)throw new c(`Frame must be a positive integer. Got: "${e}"`);if(e<this.startFrame||e>this.stopFrame)throw new c(`The frame with number ${e} is out of the job`);return await s(this.task.id,this.task.dataChunkSize,this.task.dataChunkType,this.task.mode,e,this.startFrame,this.stopFrame,t,n)},d.prototype.frames.ranges.implementation=async function(){return await a(this.task.id)},d.prototype.annotations.get.implementation=async function(e,t,n){if(!Array.isArray(n)||n.some(e=>"string"!=typeof e))throw new c("The filters argument must be an array of strings");if(!Number.isInteger(e))throw new c("The frame argument must be an integer");if(e<this.startFrame||e>this.stopFrame)throw new c(`Frame ${e} does not exist in the job`);return await b(this,e,t,n)},d.prototype.annotations.search.implementation=function(e,t,n){if(!Array.isArray(e)||e.some(e=>"string"!=typeof e))throw new c("The filters argument must be an array of strings");if(!Number.isInteger(t)||!Number.isInteger(n))throw new c("The start and end frames both must be an integer");if(t<this.startFrame||t>this.stopFrame)throw new c("The start frame is out of the job");if(n<this.startFrame||n>this.stopFrame)throw new c("The stop frame is out of the job");return w(this,e,t,n)},d.prototype.annotations.save.implementation=async function(e){return await g(this,e)},d.prototype.annotations.merge.implementation=async function(e){return await k(this,e)},d.prototype.annotations.split.implementation=async function(e,t){return await S(this,e,t)},d.prototype.annotations.group.implementation=async function(e,t){return await x(this,e,t)},d.prototype.annotations.hasUnsavedChanges.implementation=function(){return v(this)},d.prototype.annotations.clear.implementation=async function(e){return await O(this,e)},d.prototype.annotations.select.implementation=function(e,t,n){return _(this,e,t,n)},d.prototype.annotations.statistics.implementation=function(){return E(this)},d.prototype.annotations.put.implementation=function(e){return y(this,e)},d.prototype.annotations.upload.implementation=async function(e,t){return await C(this,e,t)},d.prototype.annotations.import.implementation=function(e){return T(this,e)},d.prototype.annotations.export.implementation=function(){return I(this)},d.prototype.annotations.dump.implementation=async function(e,t){return await j(this,t,e)},d.prototype.annotations.exportDataset.implementation=async function(e){return await A(this.task,e)},d.prototype.actions.undo.implementation=function(e){return P(this,e)},d.prototype.actions.redo.implementation=function(e){return N(this,e)},d.prototype.actions.clear.implementation=function(){return D(this)},d.prototype.actions.get.implementation=function(){return R(this)},d.prototype.logger.log.implementation=async function(e,t,n){return await this.task.logger.log(e,{...t,job_id:this.id},n)},m.prototype.save.implementation=async function(e){if(void 0!==this.id){const e={assignee:this.assignee?this.assignee.id:null,name:this.name,bug_tracker:this.bugTracker,z_order:this.zOrder,labels:[...this.labels.map(e=>e.toJSON())]};return await i.tasks.saveTask(this.id,e),this}const t={name:this.name,labels:this.labels.map(e=>e.toJSON()),z_order:Boolean(this.zOrder)};void 0!==this.bugTracker&&(t.bug_tracker=this.bugTracker),void 0!==this.segmentSize&&(t.segment_size=this.segmentSize),void 0!==this.overlap&&(t.overlap=this.overlap);const n={client_files:this.clientFiles,server_files:this.serverFiles,remote_files:this.remoteFiles,image_quality:this.imageQuality,use_zip_chunks:this.useZipChunks};void 0!==this.startFrame&&(n.start_frame=this.startFrame),void 0!==this.stopFrame&&(n.stop_frame=this.stopFrame),void 0!==this.frameFilter&&(n.frame_filter=this.frameFilter),void 0!==this.dataChunkSize&&(n.chunk_size=this.dataChunkSize);const r=await i.tasks.createTask(t,n,e);return new m(r)},m.prototype.delete.implementation=async function(){return await i.tasks.deleteTask(this.id)},m.prototype.frames.get.implementation=async function(e,t,n){if(!Number.isInteger(e)||e<0)throw new c(`Frame must be a positive integer. Got: "${e}"`);if(e>=this.size)throw new c(`The frame with number ${e} is out of the task`);return await s(this.id,this.dataChunkSize,this.dataChunkType,this.mode,e,0,this.size-1,t,n)},d.prototype.frames.preview.implementation=async function(){return await o(this.task.id)},m.prototype.frames.ranges.implementation=async function(){return await a(this.id)},m.prototype.frames.preview.implementation=async function(){return await o(this.id)},m.prototype.annotations.get.implementation=async function(e,t,n){if(!Array.isArray(n)||n.some(e=>"string"!=typeof e))throw new c("The filters argument must be an array of strings");if(!Number.isInteger(e)||e<0)throw new c(`Frame must be a positive integer. Got: "${e}"`);if(e>=this.size)throw new c(`Frame ${e} does not exist in the task`);return await b(this,e,t,n)},m.prototype.annotations.search.implementation=function(e,t,n){if(!Array.isArray(e)||e.some(e=>"string"!=typeof e))throw new c("The filters argument must be an array of strings");if(!Number.isInteger(t)||!Number.isInteger(n))throw new c("The start and end frames both must be an integer");if(t<0||t>=this.size)throw new c("The start frame is out of the task");if(n<0||n>=this.size)throw new c("The stop frame is out of the task");return w(this,e,t,n)},m.prototype.annotations.save.implementation=async function(e){return await g(this,e)},m.prototype.annotations.merge.implementation=async function(e){return await k(this,e)},m.prototype.annotations.split.implementation=async function(e,t){return await S(this,e,t)},m.prototype.annotations.group.implementation=async function(e,t){return await x(this,e,t)},m.prototype.annotations.hasUnsavedChanges.implementation=function(){return v(this)},m.prototype.annotations.clear.implementation=async function(e){return await O(this,e)},m.prototype.annotations.select.implementation=function(e,t,n){return _(this,e,t,n)},m.prototype.annotations.statistics.implementation=function(){return E(this)},m.prototype.annotations.put.implementation=function(e){return y(this,e)},m.prototype.annotations.upload.implementation=async function(e,t){return await C(this,e,t)},m.prototype.annotations.dump.implementation=async function(e,t){return await j(this,t,e)},m.prototype.annotations.import.implementation=function(e){return T(this,e)},m.prototype.annotations.export.implementation=function(){return I(this)},m.prototype.annotations.exportDataset.implementation=async function(e){return await A(this,e)},m.prototype.actions.undo.implementation=function(e){return P(this,e)},m.prototype.actions.redo.implementation=function(e){return N(this,e)},m.prototype.actions.clear.implementation=function(){return D(this)},m.prototype.actions.get.implementation=function(){return R(this)},m.prototype.logger.log.implementation=async function(e,t,n){return await r.log(e,{...t,task_id:this.id},n)}})()},function(e,t,n){(()=>{const{AttributeType:t,colors:r}=n(2),{ArgumentError:i}=n(0);class s{constructor(e){const n={id:void 0,default_value:void 0,input_type:void 0,mutable:void 0,name:void 0,values:void 0};for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&Object.prototype.hasOwnProperty.call(e,t)&&(Array.isArray(e[t])?n[t]=[...e[t]]:n[t]=e[t]);if(!Object.values(t).includes(n.input_type))throw new i(`Got invalid attribute type ${n.input_type}`);Object.defineProperties(this,Object.freeze({id:{get:()=>n.id},defaultValue:{get:()=>n.default_value},inputType:{get:()=>n.input_type},mutable:{get:()=>n.mutable},name:{get:()=>n.name},values:{get:()=>[...n.values]}}))}toJSON(){const e={name:this.name,mutable:this.mutable,input_type:this.inputType,default_value:this.defaultValue,values:this.values};return void 0!==this.id&&(e.id=this.id),e}}e.exports={Attribute:s,Label:class{constructor(e){const t={id:void 0,name:void 0,color:void 0};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);if(void 0!==t.id&&(t.color=r[t.id%r.length]),t.attributes=[],Object.prototype.hasOwnProperty.call(e,"attributes")&&Array.isArray(e.attributes))for(const n of e.attributes)t.attributes.push(new s(n));Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},name:{get:()=>t.name},color:{get:()=>t.color,set:e=>{if(!r.includes(e))throw new i("Trying to set unknown color");t.color=e}},attributes:{get:()=>[...t.attributes]}}))}toJSON(){const e={name:this.name,attributes:[...this.attributes.map(e=>e.toJSON())]};return void 0!==this.id&&(e.id=this.id),e}}}})()},function(e,t,n){(()=>{const{ArgumentError:t}=n(0);e.exports={isBoolean:function(e){return"boolean"==typeof e},isInteger:function(e){return"number"==typeof e&&Number.isInteger(e)},isEnum:function(e){for(const t in this)if(Object.prototype.hasOwnProperty.call(this,t)&&this[t]===e)return!0;return!1},isString:function(e){return"string"==typeof e},checkFilter:function(e,n){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(!(r in n))throw new t(`Unsupported filter property has been recieved: "${r}"`);if(!n[r](e[r]))throw new t(`Received filter property "${r}" is not satisfied for checker`)}},checkObjectType:function(e,n,r,i){if(r){if(typeof n!==r){if("integer"===r&&Number.isInteger(n))return!0;throw new t(`"${e}" is expected to be "${r}", but "${typeof n}" has been got.`)}}else if(i&&!(n instanceof i)){if(void 0!==n)throw new t(`"${e}" is expected to be ${i.name}, but `+`"${n.constructor.name}" has been got`);throw new t(`"${e}" is expected to be ${i.name}, but "undefined" has been got.`)}return!0}}})()},function(e,t){e.exports={backendAPI:"http://localhost:7000/api/v1",proxy:!1}},function(e,t,n){"use strict";(function(t){var r=n(1),i=n(46),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t)&&(o=n(16)),o),transformRequest:[function(e,t){return i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(s)})),e.exports=c}).call(this,n(12))},function(e,t){var n,r,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&f())}function f(){if(!l){var e=o(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||l||o(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){(()=>{const t=n(3),{ArgumentError:r}=n(0);class i{constructor(e){const t={label:null,attributes:{},points:null,outside:null,occluded:null,keyframe:null,zOrder:null,lock:null,color:null,hidden:null,pinned:null,keyframes:e.keyframes,group:e.group,updated:e.updated,clientID:e.clientID,serverID:e.serverID,frame:e.frame,objectType:e.objectType,shapeType:e.shapeType,updateFlags:{}};Object.defineProperty(t.updateFlags,"reset",{value:function e(){return this.label=!1,this.attributes=!1,this.points=!1,this.outside=!1,this.occluded=!1,this.keyframe=!1,this.zOrder=!1,this.pinned=!1,this.lock=!1,this.color=!1,this.hidden=!1,e},writable:!1}),Object.defineProperties(this,Object.freeze({updateFlags:{get:()=>t.updateFlags},frame:{get:()=>t.frame},objectType:{get:()=>t.objectType},shapeType:{get:()=>t.shapeType},clientID:{get:()=>t.clientID},serverID:{get:()=>t.serverID},label:{get:()=>t.label,set:e=>{t.updateFlags.label=!0,t.label=e}},color:{get:()=>t.color,set:e=>{t.updateFlags.color=!0,t.color=e}},hidden:{get:()=>t.hidden,set:e=>{t.updateFlags.hidden=!0,t.hidden=e}},points:{get:()=>t.points,set:e=>{if(!Array.isArray(e))throw new r("Points are expected to be an array "+`but got ${"object"==typeof e?e.constructor.name:typeof e}`);t.updateFlags.points=!0,t.points=[...e]}},group:{get:()=>t.group},zOrder:{get:()=>t.zOrder,set:e=>{t.updateFlags.zOrder=!0,t.zOrder=e}},outside:{get:()=>t.outside,set:e=>{t.updateFlags.outside=!0,t.outside=e}},keyframe:{get:()=>t.keyframe,set:e=>{t.updateFlags.keyframe=!0,t.keyframe=e}},keyframes:{get:()=>"object"==typeof t.keyframes?{...t.keyframes}:null},occluded:{get:()=>t.occluded,set:e=>{t.updateFlags.occluded=!0,t.occluded=e}},lock:{get:()=>t.lock,set:e=>{t.updateFlags.lock=!0,t.lock=e}},pinned:{get:()=>"boolean"==typeof t.pinned?t.pinned:null,set:e=>{t.updateFlags.pinned=!0,t.pinned=e}},updated:{get:()=>t.updated},attributes:{get:()=>t.attributes,set:e=>{if("object"!=typeof e)throw new r("Attributes are expected to be an object "+`but got ${"object"==typeof e?e.constructor.name:typeof e}`);for(const n of Object.keys(e))t.updateFlags.attributes=!0,t.attributes[n]=e[n]}}})),this.label=e.label,this.lock=e.lock,"number"==typeof e.zOrder&&(this.zOrder=e.zOrder),"boolean"==typeof e.occluded&&(this.occluded=e.occluded),"boolean"==typeof e.outside&&(this.outside=e.outside),"boolean"==typeof e.keyframe&&(this.keyframe=e.keyframe),"boolean"==typeof e.pinned&&(this.pinned=e.pinned),"boolean"==typeof e.hidden&&(this.hidden=e.hidden),"string"==typeof e.color&&(this.color=e.color),Array.isArray(e.points)&&(this.points=e.points),"object"==typeof e.attributes&&(this.attributes=e.attributes),t.updateFlags.reset()}async save(){return await t.apiWrapper.call(this,i.prototype.save)}async delete(e,n=!1){return await t.apiWrapper.call(this,i.prototype.delete,e,n)}}i.prototype.save.implementation=async function(){return this.__internal&&this.__internal.save?this.__internal.save():this},i.prototype.delete.implementation=async function(e,t){if(this.__internal&&this.__internal.delete){if(!Number.isInteger(+e)||+e<0)throw new r("Frame argument must be a non negative integer");return this.__internal.delete(e,t)}return!1},e.exports=i})()},function(e,t){e.exports=class{constructor(e){const t={id:null,username:null,email:null,first_name:null,last_name:null,groups:null,last_login:null,date_joined:null,is_staff:null,is_superuser:null,is_active:null};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n in e&&(t[n]=e[n]);Object.defineProperties(this,Object.freeze({id:{get:()=>t.id},username:{get:()=>t.username},email:{get:()=>t.email},firstName:{get:()=>t.first_name},lastName:{get:()=>t.last_name},groups:{get:()=>JSON.parse(JSON.stringify(t.groups))},lastLogin:{get:()=>t.last_login},dateJoined:{get:()=>t.date_joined},isStaff:{get:()=>t.is_staff},isSuperuser:{get:()=>t.is_superuser},isActive:{get:()=>t.is_active}}))}}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(1),i=n(47),s=n(49),a=n(50),o=n(51),c=n(17);e.exports=function(e){return new Promise((function(t,u){var l=e.data,h=e.headers;r.isFormData(l)&&delete h["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",d=e.auth.password||"";h.Authorization="Basic "+btoa(f+":"+d)}if(p.open(e.method.toUpperCase(),s(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:n,config:e,request:p};i(t,u,r),p=null}},p.onerror=function(){u(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var m=n(52),b=(e.withCredentials||o(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;b&&(h[e.xsrfHeaderName]=b)}if("setRequestHeader"in p&&r.forEach(h,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete h[t]:p.setRequestHeader(t,e)})),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),u(e),p=null)})),void 0===l&&(l=null),p.send(l)}))}},function(e,t,n){"use strict";var r=n(48);e.exports=function(e,t,n,i,s){var a=new Error(e);return r(a,t,n,i,s)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){const r=n(3),i=n(4),s=n(21),{ArgumentError:a}=n(0),{LogType:o}=n(2);class c{constructor(){this.clientID=Date.now().toString().substr(-6),this.lastLogTime=Date.now(),this.workingTime=0,this.collection=[],this.ignoreRules={},this.isActiveChecker=null,this.ignoreRules[o.zoomImage]={lastLog:null,timeThreshold:1e3,ignore(e){return Date.now()-e.time<this.timeThreshold}},this.ignoreRules[o.changeAttribute]={lastLog:null,ignore:(e,t)=>t.object_id===e.payload.object_id&&t.id===e.payload.id}}updateWorkingTime(){if(!this.isActiveChecker||this.isActiveChecker()){const e=Date.now(),t=e-this.lastLogTime;this.workingTime+=t<1e5?t:0,this.lastLogTime=e}}async configure(e,t){return await r.apiWrapper.call(this,c.prototype.configure,e,t)}async log(e,t={},n=!1){return await r.apiWrapper.call(this,c.prototype.log,e,t,n)}async save(){return await r.apiWrapper.call(this,c.prototype.save)}}c.prototype.configure.implementation=function(e,t){if("function"!=typeof e)throw new a("isActiveChecker argument must be callable");if(!Array.isArray(t))throw new a("userActivityCallback argument must be an array");this.isActiveChecker=()=>!!e(),t.push(this.updateWorkingTime.bind(this))},c.prototype.log.implementation=function(e,t,n){if("object"!=typeof t)throw new a("Payload must be an object");if("boolean"!=typeof n)throw new a("Payload must be an object");if(e in this.ignoreRules){const n=this.ignoreRules[e],{lastLog:r}=n;if(r&&n.ignore(r,t))return r.payload={...r.payload,...t},this.updateWorkingTime(),n.lastLog}const r={...t};r.client_id=this.clientID,this.isActiveChecker&&(r.is_active=this.isActiveChecker());const c=s(e,{...r});e in this.ignoreRules&&(this.ignoreRules[e].lastLog=c);const u=()=>{this.updateWorkingTime(),c.validatePayload(),c.onClose(null),this.collection.push(c)};return c.type===o.sendException?(i.server.exception(c.dump()).catch(()=>{u()}),c):(n?c.onClose(u):u(),c)},c.prototype.save.implementation=async function(){const e=[...this.collection],t=this.collection[this.collection.length-1],n={};n.client_id=this.clientID,n.working_time=this.workingTime,this.isActiveChecker&&(n.is_active=this.isActiveChecker()),t&&t.type===o.sendTaskInfo&&(n.job_id=t.payload.job_id,n.task_id=t.payload.task_id);const r=s(o.sendUserActivity,n);e.push(r),await i.logs.save(e.map(e=>e.dump()));for(const e of Object.values(this.ignoreRules))e.lastLog=null;this.collection=[],this.workingTime=0,this.lastLogTime=Date.now()},e.exports=new c},function(e,t,n){const{detect:r}=n(60),i=n(3),{ArgumentError:s}=n(0),{LogType:a}=n(2);class o{constructor(e,t){this.onCloseCallback=null,this.type=e,this.payload={...t},this.time=new Date}onClose(e){this.onCloseCallback=e}validatePayload(){if("object"!=typeof this.payload)throw new s("Payload must be an object");try{JSON.stringify(this.payload)}catch(e){const t=`Log payload must be JSON serializable. ${e.toString()}`;throw new s(t)}}dump(){const e={...this.payload},t={name:this.type,time:this.time.toISOString()};for(const n of["client_id","job_id","task_id","is_active"])n in e&&(t[n]=e[n],delete e[n]);return{...t,payload:e}}async close(e={}){return await i.apiWrapper.call(this,o.prototype.close,e)}}o.prototype.close.implementation=function(e){this.payload.duration=Date.now()-this.time.getTime(),this.payload={...this.payload,...e},this.onCloseCallback&&this.onCloseCallback()};class c extends o{validatePayload(){if(o.prototype.validatePayload.call(this),!Number.isInteger(this.payload.count)||this.payload.count<1){const e=`The field "count" is required for "${this.type}" log`+"It must be a positive integer";throw new s(e)}}}class u extends o{validatePayload(){const e=(e,t)=>{const n=`The field "${e}" is required for "${this.type}" log. ${t}`;throw new s(n)};(!Number.isInteger(this.payload["track count"])||this.payload["track count"]<0)&&e("track count","It must be an integer not less than 0"),(!Number.isInteger(this.payload["tag count"])||this.payload["tag count"]<0)&&e("tag count","It must be an integer not less than 0"),(!Number.isInteger(this.payload["object count"])||this.payload["object count"]<0)&&e("object count","It must be an integer not less than 0"),(!Number.isInteger(this.payload["frame count"])||this.payload["frame count"]<1)&&e("frame count","It must be an integer not less than 1"),(!Number.isInteger(this.payload["box count"])||this.payload["box count"]<0)&&e("box count","It must be an integer not less than 0"),(!Number.isInteger(this.payload["polygon count"])||this.payload["polygon count"]<0)&&e("polygon count","It must be an integer not less than 0"),(!Number.isInteger(this.payload["polyline count"])||this.payload["polyline count"]<0)&&e("polyline count","It must be an integer not less than 0"),(!Number.isInteger(this.payload["points count"])||this.payload["points count"]<0)&&e("points count","It must be an integer not less than 0")}}class l extends o{validatePayload(){if(o.prototype.validatePayload.call(this),!("working_time"in this.payload)||"number"===(this.payload.working_time,!1)||this.payload.working_time<0){const e=`The field "working_time" is required for ${this.type} log. `+"It must be a number not less than 0";throw new s(e)}}}class h extends o{validatePayload(){if(o.prototype.validatePayload.call(this),"string"!=typeof this.payload.message){const e=`The field "message" is required for ${this.type} log. `+"It must be a string";throw new s(e)}if("string"!=typeof this.payload.filename){const e=`The field "filename" is required for ${this.type} log. `+"It must be a string";throw new s(e)}if("number"!=typeof this.payload.line){const e=`The field "line" is required for ${this.type} log. `+"It must be a number";throw new s(e)}if("number"!=typeof this.payload.column){const e=`The field "column" is required for ${this.type} log. `+"It must be a number";throw new s(e)}if("string"!=typeof this.payload.stack){const e=`The field "stack" is required for ${this.type} log. `+"It must be a string";throw new s(e)}}dump(){let e=super.dump();const t=e.payload,n=r();return e={...e,message:t.message,filename:t.filename,line:t.line,column:t.column,stack:t.stack,system:n.os,client:n.name,version:n.version},delete t.message,delete t.filename,delete t.line,delete t.column,delete t.stack,e}}e.exports=function(e,t){return[a.deleteObject,a.mergeObjects,a.copyObject,a.undoAction,a.redoAction].includes(e)?new c(e,t):[a.sendTaskInfo,a.loadJob,a.uploadAnnotations].includes(e)?new u(e,t):e===a.sendUserActivity?new l(e,t):e===a.sendException?new h(e,t):new o(e,t)}},function(e,t){e.exports=class{constructor(e,t){Object.defineProperties(this,Object.freeze({label:{get:()=>JSON.parse(JSON.stringify(e))},total:{get:()=>JSON.parse(JSON.stringify(t))}}))}}},function(e,t){(()=>{class t{constructor(e){const t={name:e.name,format:e.ext,version:e.version};Object.defineProperties(this,{name:{get:()=>t.name},format:{get:()=>t.format},version:{get:()=>t.version}})}}class n{constructor(e){const t={name:e.name,format:e.ext,version:e.version};Object.defineProperties(this,{name:{get:()=>t.name},format:{get:()=>t.format},version:{get:()=>t.version}})}}e.exports={AnnotationFormats:class{constructor(e){const r={exporters:e.exporters.map(e=>new n(e)),importers:e.importers.map(e=>new t(e))};Object.defineProperties(this,{loaders:{get:()=>[...r.importers]},dumpers:{get:()=>[...r.exporters]}})}},Loader:t,Dumper:n}})()},function(e,t,n){e.exports=function(){const e=n(3),t=n(20),r=n(21),i=n(13),s=n(22),{Job:a,Task:o}=n(7),{Attribute:c,Label:u}=n(8),{ShareFileType:l,TaskStatus:h,TaskMode:p,AttributeType:f,ObjectType:d,ObjectShape:m,LogType:b,HistoryActions:y,colors:g}=n(2),{Exception:v,ArgumentError:w,DataError:k,ScriptingError:S,PluginError:x,ServerError:O}=n(0),_=n(14),E=n(76),C=n(10),j={server:{about:async()=>await e.apiWrapper(j.server.about),share:async(t="/")=>await e.apiWrapper(j.server.share,t),formats:async()=>await e.apiWrapper(j.server.formats),register:async(t,n,r,i,s,a)=>await e.apiWrapper(j.server.register,t,n,r,i,s,a),login:async(t,n)=>await e.apiWrapper(j.server.login,t,n),logout:async()=>await e.apiWrapper(j.server.logout),authorized:async()=>await e.apiWrapper(j.server.authorized),request:async(t,n)=>await e.apiWrapper(j.server.request,t,n)},tasks:{get:async(t={})=>await e.apiWrapper(j.tasks.get,t)},jobs:{get:async(t={})=>await e.apiWrapper(j.jobs.get,t)},users:{get:async(t={})=>await e.apiWrapper(j.users.get,t)},plugins:{list:async()=>await e.apiWrapper(j.plugins.list),register:async t=>await e.apiWrapper(j.plugins.register,t)},logger:t,config:{get backendAPI(){return C.backendAPI},set backendAPI(e){C.backendAPI=e},get proxy(){return C.proxy},set proxy(e){C.proxy=e}},client:{version:`${E.version}`},enums:{ShareFileType:l,TaskStatus:h,TaskMode:p,AttributeType:f,ObjectType:d,ObjectShape:m,LogType:b,HistoryActions:y,colors:g},exceptions:{Exception:v,ArgumentError:w,DataError:k,ScriptingError:S,PluginError:x,ServerError:O},classes:{Task:o,User:_,Job:a,Log:r,Attribute:c,Label:u,Statistics:s,ObjectState:i}};j.server=Object.freeze(j.server),j.tasks=Object.freeze(j.tasks),j.jobs=Object.freeze(j.jobs),j.users=Object.freeze(j.users),j.plugins=Object.freeze(j.plugins),j.client=Object.freeze(j.client),j.enums=Object.freeze(j.enums);const T=n(77);return Math.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},Object.freeze(T(j))}()},function(e,t,n){(function(e,r){var i;
/*!
 * Platform.js <https://mths.be/platform>
 * Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 * Copyright 2011-2013 John-David Dalton <http://allyoucanleet.com/>
 * Available under MIT license <https://mths.be/mit>
 */(function(){"use strict";var s={function:!0,object:!0},a=s[typeof window]&&window||this,o=s[typeof t]&&t,c=s[typeof e]&&e&&!e.nodeType&&e,u=o&&c&&"object"==typeof r&&r;!u||u.global!==u&&u.window!==u&&u.self!==u||(a=u);var l=Math.pow(2,53)-1,h=/\bOpera/,p=Object.prototype,f=p.hasOwnProperty,d=p.toString;function m(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function b(e){return e=k(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:m(e)}function y(e,t){for(var n in e)f.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?m(e):d.call(e).slice(8,-1)}function v(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function w(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=l)for(;++n<r;)t(e[n],n,e);else y(e,t)}(e,(function(r,i){n=t(n,r,i,e)})),n}function k(e){return String(e).replace(/^ +| +$/g,"")}var S=function e(t){var n=a,r=t&&"object"==typeof t&&"String"!=g(t);r&&(n=t,t=null);var i=n.navigator||{},s=i.userAgent||"";t||(t=s);var o,c,u,l,p,f=r?!!i.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(d.toString()),m=r?"Object":"ScriptBridgingProxyObject",S=r?"Object":"Environment",x=r&&n.java?"JavaPackage":g(n.java),O=r?"Object":"RuntimeObject",_=/\bJava/.test(x)&&n.java,E=_&&g(n.environment)==S,C=_?"a":"α",j=_?"b":"β",T=n.document||{},I=n.operamini||n.opera,A=h.test(A=r&&I?I["[[Class]]"]:g(I))?A:I=null,P=t,N=[],D=null,R=t==s,F=R&&I&&"function"==typeof I.version&&I.version(),M=w([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||v(n))+"\\b","i").exec(t)&&(n.label||n)})),$=function(e){return w(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||v(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),L=U([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),B=function(e){return w(e,(function(e,n,r){return e||(n[L]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(L)]||RegExp("\\b"+v(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}))}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),z=function(e){return w(e,(function(e,n){var r=n.pattern||v(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=b(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}))}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function U(e){return w(e,(function(e,n){var r=n.pattern||v(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=b(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}if(M&&(M=[M]),B&&!L&&(L=U([B])),(o=/\bGoogle TV\b/.exec(L))&&(L=o[0]),/\bSimulator\b/i.test(t)&&(L=(L?L+" ":"")+"Simulator"),"Opera Mini"==$&&/\bOPiOS\b/.test(t)&&N.push("running in Turbo/Uncompressed mode"),"IE"==$&&/\blike iPhone OS\b/.test(t)?(B=(o=e(t.replace(/like iPhone OS/,""))).manufacturer,L=o.product):/^iP/.test(L)?($||($="Safari"),z="iOS"+((o=/ OS ([\d_]+)/i.exec(t))?" "+o[1].replace(/_/g,"."):"")):"Konqueror"!=$||/buntu/i.test(z)?B&&"Google"!=B&&(/Chrome/.test($)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(L))||/\bAndroid\b/.test(z)&&/^Chrome/.test($)&&/\bVersion\//i.test(t)?($="Android Browser",z=/\bAndroid\b/.test(z)?z:"Android"):"Silk"==$?(/\bMobi/i.test(t)||(z="Android",N.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&N.unshift("accelerated")):"PaleMoon"==$&&(o=/\bFirefox\/([\d.]+)\b/.exec(t))?N.push("identifying as Firefox "+o[1]):"Firefox"==$&&(o=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(z||(z="Firefox OS"),L||(L=o[1])):!$||(o=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec($))?($&&!L&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(o+"/")+8))&&($=null),(o=L||B||z)&&(L||B||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(z))&&($=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(z)?z:o)+" Browser")):"Electron"==$&&(o=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&N.push("Chromium "+o):z="Kubuntu",F||(F=w(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",v($),"(?:Firefox|Minefield|NetFront)"],(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))),(o=("iCab"==M&&parseFloat(F)>3?"WebKit":/\bOpera\b/.test($)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(M)&&"WebKit"||!M&&/\bMSIE\b/i.test(t)&&("Mac OS"==z?"Tasman":"Trident")||"WebKit"==M&&/\bPlayStation\b(?! Vita\b)/i.test($)&&"NetFront")&&(M=[o]),"IE"==$&&(o=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?($+=" Mobile",z="Windows Phone "+(/\+$/.test(o)?o:o+".x"),N.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?($="IE Mobile",z="Windows Phone 8.x",N.unshift("desktop mode"),F||(F=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=$&&"Trident"==M&&(o=/\brv:([\d.]+)/.exec(t))&&($&&N.push("identifying as "+$+(F?" "+F:"")),$="IE",F=o[1]),R){if(l="global",p=null!=(u=n)?typeof u[l]:"number",/^(?:boolean|number|string|undefined)$/.test(p)||"object"==p&&!u[l])g(o=n.runtime)==m?($="Adobe AIR",z=o.flash.system.Capabilities.os):g(o=n.phantom)==O?($="PhantomJS",F=(o=o.version||null)&&o.major+"."+o.minor+"."+o.patch):"number"==typeof T.documentMode&&(o=/\bTrident\/(\d+)/i.exec(t))?(F=[F,T.documentMode],(o=+o[1]+4)!=F[1]&&(N.push("IE "+F[1]+" mode"),M&&(M[1]=""),F[1]=o),F="IE"==$?String(F[1].toFixed(1)):F[0]):"number"==typeof T.documentMode&&/^(?:Chrome|Firefox)\b/.test($)&&(N.push("masking as "+$+" "+F),$="IE",F="11.0",M=["Trident"],z="Windows");else if(_&&(P=(o=_.lang.System).getProperty("os.arch"),z=z||o.getProperty("os.name")+" "+o.getProperty("os.version")),E){try{F=n.require("ringo/engine").version.join("."),$="RingoJS"}catch(e){(o=n.system)&&o.global.system==n.system&&($="Narwhal",z||(z=o[0].os||null))}$||($="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(o=n.process)&&("object"==typeof o.versions&&("string"==typeof o.versions.electron?(N.push("Node "+o.versions.node),$="Electron",F=o.versions.electron):"string"==typeof o.versions.nw&&(N.push("Chromium "+F,"Node "+o.versions.node),$="NW.js",F=o.versions.nw)),$||($="Node.js",P=o.arch,z=o.platform,F=(F=/[\d.]+/.exec(o.version))?F[0]:null));z=z&&b(z)}if(F&&(o=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(F)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(R&&i.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(D=/b/i.test(o)?"beta":"alpha",F=F.replace(RegExp(o+"\\+?$"),"")+("beta"==D?j:C)+(/\d+\+?/.exec(o)||"")),"Fennec"==$||"Firefox"==$&&/\b(?:Android|Firefox OS)\b/.test(z))$="Firefox Mobile";else if("Maxthon"==$&&F)F=F.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(L))"Xbox 360"==L&&(z=null),"Xbox 360"==L&&/\bIEMobile\b/.test(t)&&N.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test($)&&(!$||L||/Browser|Mobi/.test($))||"Windows CE"!=z&&!/Mobi/i.test(t))if("IE"==$&&R)try{null===n.external&&N.unshift("platform preview")}catch(e){N.unshift("embedded")}else(/\bBlackBerry\b/.test(L)||/\bBB10\b/.test(t))&&(o=(RegExp(L.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||F)?(z=((o=[o,/BB10/.test(t)])[1]?(L=null,B="BlackBerry"):"Device Software")+" "+o[0],F=null):this!=y&&"Wii"!=L&&(R&&I||/Opera/.test($)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==$&&/\bOS X (?:\d+\.){2,}/.test(z)||"IE"==$&&(z&&!/^Win/.test(z)&&F>5.5||/\bWindows XP\b/.test(z)&&F>8||8==F&&!/\bTrident\b/.test(t)))&&!h.test(o=e.call(y,t.replace(h,"")+";"))&&o.name&&(o="ing as "+o.name+((o=o.version)?" "+o:""),h.test($)?(/\bIE\b/.test(o)&&"Mac OS"==z&&(z=null),o="identify"+o):(o="mask"+o,$=A?b(A.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(o)&&(z=null),R||(F=null)),M=["Presto"],N.push(o));else $+=" Mobile";(o=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(o=[parseFloat(o.replace(/\.(\d)$/,".0$1")),o],"Safari"==$&&"+"==o[1].slice(-1)?($="WebKit Nightly",D="alpha",F=o[1].slice(0,-1)):F!=o[1]&&F!=(o[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(F=null),o[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==o[0]&&537.36==o[2]&&parseFloat(o[1])>=28&&"WebKit"==M&&(M=["Blink"]),R&&(f||o[1])?(M&&(M[1]="like Chrome"),o=o[1]||((o=o[0])<530?1:o<532?2:o<532.05?3:o<533?4:o<534.03?5:o<534.07?6:o<534.1?7:o<534.13?8:o<534.16?9:o<534.24?10:o<534.3?11:o<535.01?12:o<535.02?"13+":o<535.07?15:o<535.11?16:o<535.19?17:o<536.05?18:o<536.1?19:o<537.01?20:o<537.11?"21+":o<537.13?23:o<537.18?24:o<537.24?25:o<537.36?26:"Blink"!=M?"27":"28")):(M&&(M[1]="like Safari"),o=(o=o[0])<400?1:o<500?2:o<526?3:o<533?4:o<534?"4+":o<535?5:o<537?6:o<538?7:o<601?8:"8"),M&&(M[1]+=" "+(o+="number"==typeof o?".x":/[.+]/.test(o)?"":"+")),"Safari"==$&&(!F||parseInt(F)>45)&&(F=o)),"Opera"==$&&(o=/\bzbov|zvav$/.exec(z))?($+=" ",N.unshift("desktop mode"),"zvav"==o?($+="Mini",F=null):$+="Mobile",z=z.replace(RegExp(" *"+o+"$"),"")):"Safari"==$&&/\bChrome\b/.exec(M&&M[1])&&(N.unshift("desktop mode"),$="Chrome Mobile",F=null,/\bOS X\b/.test(z)?(B="Apple",z="iOS 4.3+"):z=null),F&&0==F.indexOf(o=/[\d.]+$/.exec(z))&&t.indexOf("/"+o+"-")>-1&&(z=k(z.replace(o,""))),M&&!/\b(?:Avant|Nook)\b/.test($)&&(/Browser|Lunascape|Maxthon/.test($)||"Safari"!=$&&/^iOS/.test(z)&&/\bSafari\b/.test(M[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test($)&&M[1])&&(o=M[M.length-1])&&N.push(o),N.length&&(N=["("+N.join("; ")+")"]),B&&L&&L.indexOf(B)<0&&N.push("on "+B),L&&N.push((/^on /.test(N[N.length-1])?"":"on ")+L),z&&(o=/ ([\d.+]+)$/.exec(z),c=o&&"/"==z.charAt(z.length-o[0].length-1),z={architecture:32,family:o&&!c?z.replace(o[0],""):z,version:o?o[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(o=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(P))&&!/\bi686\b/i.test(P)?(z&&(z.architecture=64,z.family=z.family.replace(RegExp(" *"+o),"")),$&&(/\bWOW64\b/i.test(t)||R&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(t))&&N.unshift("32-bit")):z&&/^OS X/.test(z.family)&&"Chrome"==$&&parseFloat(F)>=39&&(z.architecture=64),t||(t=null);var q={};return q.description=t,q.layout=M&&M[0],q.manufacturer=B,q.name=$,q.prerelease=D,q.product=L,q.ua=t,q.version=$&&F,q.os=z||{architecture:null,family:null,version:null,toString:function(){return"null"}},q.parse=e,q.toString=function(){return this.description||""},q.version&&N.unshift(F),q.name&&N.unshift($),z&&$&&(z!=String(z).split(" ")[0]||z!=$.split(" ")[0]&&!L)&&N.push(L?"("+z+")":"on "+z),N.length&&(q.description=N.join(" ")),q}();a.platform=S,void 0===(i=function(){return S}.call(t,n,t,e))||(e.exports=i)}).call(this)}).call(this,n(26)(e),n(6))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r,i,s;!function(a,o){"use strict";i=[n(28)],void 0===(s="function"==typeof(r=function(e){var t=/(^|@)\S+:\d+/,n=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(e){return!!e.match(n)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),r=n.match(/ (\((.+):(\d+):(\d+)\)$)/),i=(n=r?n.replace(r[0],""):n).split(/\s+/).slice(1),s=this.extractLocation(r?r[1]:i.pop()),a=i.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(s[0])>-1?void 0:s[0];return new e({functionName:a,fileName:o,lineNumber:s[1],columnNumber:s[2],source:t})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(e){return!e.match(r)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=t.match(n),i=r&&r[1]?r[1]:void 0,s=this.extractLocation(t.replace(n,""));return new e({functionName:i,fileName:s[0],lineNumber:s[1],columnNumber:s[2],source:t})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),i=[],s=2,a=r.length;s<a;s+=2){var o=n.exec(r[s]);o&&i.push(new e({fileName:o[2],lineNumber:o[1],source:r[s]}))}return i},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),i=[],s=0,a=r.length;s<a;s+=2){var o=n.exec(r[s]);o&&i.push(new e({functionName:o[3]||void 0,fileName:o[2],lineNumber:o[1],source:r[s]}))}return i},parseOpera11:function(n){return n.stack.split("\n").filter((function(e){return!!e.match(t)&&!e.match(/^Error created at/)}),this).map((function(t){var n,r=t.split("@"),i=this.extractLocation(r.pop()),s=r.shift()||"",a=s.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;s.match(/\(([^)]*)\)/)&&(n=s.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var o=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e({functionName:a,args:o,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})}),this)}}})?r.apply(t,i):r)||(e.exports=s)}()},function(e,t,n){var r,i,s;!function(n,a){"use strict";i=[],void 0===(s="function"==typeof(r=function(){function e(e){return e.charAt(0).toUpperCase()+e.substring(1)}function t(e){return function(){return this[e]}}var n=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],i=["fileName","functionName","source"],s=n.concat(r,i,["args"]);function a(t){if(t)for(var n=0;n<s.length;n++)void 0!==t[s[n]]&&this["set"+e(s[n])](t[s[n]])}a.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof a)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new a(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",r=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:r?r+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},a.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),r=e.substring(0,t),i=e.substring(t+1,n).split(","),s=e.substring(n+1);if(0===s.indexOf("@"))var o=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(s,""),c=o[1],u=o[2],l=o[3];return new a({functionName:r,args:i||void 0,fileName:c,lineNumber:u||void 0,columnNumber:l||void 0})};for(var o=0;o<n.length;o++)a.prototype["get"+e(n[o])]=t(n[o]),a.prototype["set"+e(n[o])]=function(e){return function(t){this[e]=Boolean(t)}}(n[o]);for(var c=0;c<r.length;c++)a.prototype["get"+e(r[c])]=t(r[c]),a.prototype["set"+e(r[c])]=function(e){return function(t){if(n=t,isNaN(parseFloat(n))||!isFinite(n))throw new TypeError(e+" must be a Number");var n;this[e]=Number(t)}}(r[c]);for(var u=0;u<i.length;u++)a.prototype["get"+e(i[u])]=t(i[u]),a.prototype["set"+e(i[u])]=function(e){return function(t){this[e]=String(t)}}(i[u]);return a})?r.apply(t,i):r)||(e.exports=s)}()},function(e,t){e.exports="object"==typeof self?self.FormData:window.FormData},function(e,t,n){var r=n(31),i=n(32),s=[n(39)];e.exports=r.createStore(i,s)},function(e,t,n){var r=n(5),i=r.slice,s=r.pluck,a=r.each,o=r.bind,c=r.create,u=r.isList,l=r.isFunction,h=r.isObject;e.exports={createStore:f};var p={version:"2.0.12",enabled:!1,get:function(e,t){var n=this.storage.read(this._namespacePrefix+e);return this._deserialize(n,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each((function(n,r){e.call(t,t._deserialize(n),(r||"").replace(t._namespaceRegexp,""))}))},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return f.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return f(this.storage,this.plugins,e)}};function f(e,t,n){n||(n=""),e&&!u(e)&&(e=[e]),t&&!u(t)&&(t=[t]);var r=n?"__storejs_"+n+"_":"",f=n?new RegExp("^"+r):null;if(!/^[a-zA-Z0-9_\-]*$/.test(n))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var d=c({_namespacePrefix:r,_namespaceRegexp:f,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var n=e.read(t)===t;return e.remove(t),n}catch(e){return!1}},_assignPluginFnProp:function(e,t){var n=this[t];this[t]=function(){var t=i(arguments,0),r=this;function s(){if(n)return a(arguments,(function(e,n){t[n]=e})),n.apply(r,t)}var o=[s].concat(t);return e.apply(r,o)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var n="";try{n=JSON.parse(e)}catch(t){n=e}return void 0!==n?n:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(u(e))a(e,(function(e){t._addPlugin(e)}));else if(!s(this.plugins,(function(t){return e===t}))){if(this.plugins.push(e),!l(e))throw new Error("Plugins must be function values that return objects");var n=e.call(this);if(!h(n))throw new Error("Plugins must return an object of function properties");a(n,(function(n,r){if(!l(n))throw new Error("Bad plugin property: "+r+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(n,r)}))}},addStorage:function(e){!function(){var e="undefined"==typeof console?null:console;if(e){var t=e.warn?e.warn:e.log;t.apply(e,arguments)}}("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},p,{plugins:[]});return d.raw={},a(d,(function(e,t){l(e)&&(d.raw[t]=o(d,e))})),a(e,(function(e){d._addStorage(e)})),a(t,(function(e){d._addPlugin(e)})),d}},function(e,t,n){e.exports=[n(33),n(34),n(35),n(36),n(37),n(38)]},function(e,t,n){var r=n(5).Global;function i(){return r.localStorage}function s(e){return i().getItem(e)}e.exports={name:"localStorage",read:s,write:function(e,t){return i().setItem(e,t)},each:function(e){for(var t=i().length-1;t>=0;t--){var n=i().key(t);e(s(n),n)}},remove:function(e){return i().removeItem(e)},clearAll:function(){return i().clear()}}},function(e,t,n){var r=n(5).Global;e.exports={name:"oldFF-globalStorage",read:function(e){return i[e]},write:function(e,t){i[e]=t},each:s,remove:function(e){return i.removeItem(e)},clearAll:function(){s((function(e,t){delete i[e]}))}};var i=r.globalStorage;function s(e){for(var t=i.length-1;t>=0;t--){var n=i.key(t);e(i[n],n)}}},function(e,t,n){var r=n(5).Global;e.exports={name:"oldIE-userDataStorage",write:function(e,t){if(a)return;var n=c(e);s((function(e){e.setAttribute(n,t),e.save("storejs")}))},read:function(e){if(a)return;var t=c(e),n=null;return s((function(e){n=e.getAttribute(t)})),n},each:function(e){s((function(t){for(var n=t.XMLDocument.documentElement.attributes,r=n.length-1;r>=0;r--){var i=n[r];e(t.getAttribute(i.name),i.name)}}))},remove:function(e){var t=c(e);s((function(e){e.removeAttribute(t),e.save("storejs")}))},clearAll:function(){s((function(e){var t=e.XMLDocument.documentElement.attributes;e.load("storejs");for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save("storejs")}))}};var i=r.document,s=function(){if(!i||!i.documentElement||!i.documentElement.addBehavior)return null;var e,t,n;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,n=e.createElement("div")}catch(t){n=i.createElement("div"),e=i.body}return function(t){var r=[].slice.call(arguments,0);r.unshift(n),e.appendChild(n),n.addBehavior("#default#userData"),n.load("storejs"),t.apply(this,r),e.removeChild(n)}}(),a=(r.navigator?r.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);var o=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function c(e){return e.replace(/^\d/,"___$&").replace(o,"___")}},function(e,t,n){var r=n(5),i=r.Global,s=r.trim;e.exports={name:"cookieStorage",read:function(e){if(!e||!u(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(a.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){if(!e)return;a.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:o,remove:c,clearAll:function(){o((function(e,t){c(t)}))}};var a=i.document;function o(e){for(var t=a.cookie.split(/; ?/g),n=t.length-1;n>=0;n--)if(s(t[n])){var r=t[n].split("="),i=unescape(r[0]);e(unescape(r[1]),i)}}function c(e){e&&u(e)&&(a.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function u(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(a.cookie)}},function(e,t,n){var r=n(5).Global;function i(){return r.sessionStorage}function s(e){return i().getItem(e)}e.exports={name:"sessionStorage",read:s,write:function(e,t){return i().setItem(e,t)},each:function(e){for(var t=i().length-1;t>=0;t--){var n=i().key(t);e(s(n),n)}},remove:function(e){return i().removeItem(e)},clearAll:function(){return i().clear()}}},function(e,t){e.exports={name:"memoryStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:function(e){for(var t in n)n.hasOwnProperty(t)&&e(n[t],t)},remove:function(e){delete n[e]},clearAll:function(e){n={}}};var n={}},function(e,t,n){e.exports=function(){return n(40),{}}},function(module,exports){"object"!=typeof JSON&&(JSON={}),function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,a,o=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(c)){for(s=c.length,n=0;n<s;n+=1)a[n]=str(n,c)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+o+"]":"["+a.join(",")+"]",gap=o,i}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;n<s;n+=1)"string"==typeof rep[n]&&(i=str(r=rep[n],c))&&a.push(quote(r)+(gap?": ":":")+i);else for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(i=str(r,c))&&a.push(quote(r)+(gap?": ":":")+i);return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+o+"}":"{"+a.join(",")+"}",gap=o,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(void 0!==(r=walk(i,n))?i[n]=r:delete i[n]);return reviver.call(e,t,i)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},function(e,t){e.exports=function(){return new Worker("/static/engine/js/download.worker.js")}},function(e,t,n){e.exports=n(43)},function(e,t,n){"use strict";var r=n(1),i=n(15),s=n(45),a=n(11);function o(e){var t=new s(e),n=i(s.prototype.request,t);return r.extend(n,s.prototype,t),r.extend(n,t),n}var c=o(a);c.Axios=s,c.create=function(e){return o(r.merge(a,e))},c.Cancel=n(19),c.CancelToken=n(58),c.isCancel=n(18),c.all=function(e){return Promise.all(e)},c.spread=n(59),e.exports=c,e.exports.default=c},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(11),i=n(1),s=n(53),a=n(54);function o(e){this.defaults=e,this.interceptors={request:new s,response:new s}}o.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],(function(e){o.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}})),i.forEach(["post","put","patch"],(function(e){o.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=o},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(17);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e}},function(e,t,n){"use strict";var r=n(1);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),s=a.join("&")}return s&&(e+=(-1===e.indexOf("?")?"?":"&")+s),e}},function(e,t,n){"use strict";var r=n(1),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,a={};return e?(r.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,s,a){var o=[];o.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),r.isString(i)&&o.push("path="+i),r.isString(s)&&o.push("domain="+s),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(1);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";var r=n(1),i=n(55),s=n(18),a=n(11),o=n(56),c=n(57);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!o(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(u(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(19);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"BrowserInfo",(function(){return i})),n.d(t,"NodeInfo",(function(){return s})),n.d(t,"SearchBotDeviceInfo",(function(){return a})),n.d(t,"BotInfo",(function(){return o})),n.d(t,"detect",(function(){return h})),n.d(t,"browserName",(function(){return f})),n.d(t,"parseUserAgent",(function(){return d})),n.d(t,"detectOS",(function(){return m})),n.d(t,"getNodeVersion",(function(){return b}));var r=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,i++)r[i]=s[a];return r},i=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},s=function(t){this.version=t,this.type="node",this.name="node",this.os=e.platform},a=function(e,t,n,r){this.name=e,this.version=t,this.os=n,this.bot=r,this.type="bot-device"},o=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},c=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,u=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],l=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function h(e){return e?d(e):"undefined"!=typeof navigator?d(navigator.userAgent):b()}function p(e){return""!==e&&u.reduce((function(t,n){var r=n[0],i=n[1];if(t)return t;var s=i.exec(e);return!!s&&[r,s]}),!1)}function f(e){var t=p(e);return t?t[0]:null}function d(e){var t=p(e);if(!t)return null;var n=t[0],s=t[1];if("searchbot"===n)return new o;var u=s[1]&&s[1].split(/[._]/).slice(0,3);u?u.length<3&&(u=r(u,function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(3-u.length))):u=[];var l=u.join("."),h=m(e),f=c.exec(e);return f&&f[1]?new a(n,l,h,f[1]):new i(n,u.join("."),h)}function m(e){for(var t=0,n=l.length;t<n;t++){var r=l[t],i=r[0];if(r[1].exec(e))return i}return null}function b(){return void 0!==e&&e.version?new s(e.version.slice(1)):null}}.call(this,n(12))},function(e,t,n){(function(t){(()=>{const r=n(62),i=n(3),s=n(4),{isBrowser:a,isNode:o}=n(68),{Exception:c,ArgumentError:u,DataError:l}=n(0),h={};class p{constructor({width:e,height:t,name:n,taskID:r,frameNumber:i,startFrame:s,stopFrame:a,decodeForward:o}){Object.defineProperties(this,Object.freeze({filename:{value:n,writable:!1},width:{value:e,writable:!1},height:{value:t,writable:!1},tid:{value:r,writable:!1},number:{value:i,writable:!1},startFrame:{value:s,writable:!1},stopFrame:{value:a,writable:!1},decodeForward:{value:o,writable:!1}}))}async data(e=(()=>{})){return await i.apiWrapper.call(this,p.prototype.data,e)}}function f(e,t){const{meta:n,mode:r}=h[e];let i=null;if("interpolation"===r)[i]=n.frames;else{if("annotation"!==r)throw new l(`Invalid mode is specified ${r}`);if(t>=n.size)throw new u(`Meta information about frame ${t} can't be received from the server`);i=n.frames[t]}return i}p.prototype.data.implementation=async function(e){return new Promise((t,n)=>{const r=e=>(this._data={imageData:e,renderWidth:this.width,renderHeight:this.height},t(this._data));if(this._data)return void t(this._data);const{provider:i}=h[this.tid],{chunkSize:u}=h[this.tid],l=parseInt(this.number/u,10)*u,p=Math.min(this.stopFrame,(parseInt(this.number/u,10)+1)*u-1),f=Math.floor(this.number/u),d=async e=>{if(h[this.tid].activeChunkRequest&&f===h[this.tid].activeChunkRequest.chunkNumber){const t=h[this.tid].activeChunkRequest.callbacks;for(let n=t.length-1;n>=0;--n)if(t[n].frameNumber===e){const e=t[n];t.splice(n,1),e.resolve(await i.frame(e.frameNumber))}0===t.length&&(h[this.tid].activeChunkRequest=null)}},m=()=>{if(h[this.tid].activeChunkRequest&&f===h[this.tid].activeChunkRequest.chunkNumber){for(const e of h[this.tid].activeChunkRequest.callbacks)e.reject(e.frameNumber);h[this.tid].activeChunkRequest=null}},b=()=>{const e=h[this.tid],t=e.activeChunkRequest;t.request=s.frames.getData(this.tid,t.chunkNumber).then(t=>{h[this.tid].activeChunkRequest.completed=!0,e.nextChunkRequest||i.requestDecodeBlock(t,e.activeChunkRequest.start,e.activeChunkRequest.stop,e.activeChunkRequest.onDecodeAll,e.activeChunkRequest.rejectRequestAll)}).catch(e=>{n(e instanceof c?e:new c(e.message))}).finally(()=>{if(e.nextChunkRequest){if(e.activeChunkRequest)for(const t of e.activeChunkRequest.callbacks)t.reject(t.frameNumber);e.activeChunkRequest=e.nextChunkRequest,e.nextChunkRequest=null,b()}})};o?t("Dummy data"):a&&i.frame(this.number).then(t=>{if(null===t){e();const t=h[this.tid].activeChunkRequest;if(i.isChunkCached(l,p))t.callbacks.push({resolve:r,reject:n,frameNumber:this.number}),i.requestDecodeBlock(null,l,p,d,m);else if(!t||t&&t.completed&&t.chunkNumber!==f)t&&t.rejectRequestAll&&t.rejectRequestAll(),h[this.tid].activeChunkRequest={request:null,chunkNumber:f,start:l,stop:p,onDecodeAll:d,rejectRequestAll:m,completed:!1,callbacks:[{resolve:r,reject:n,frameNumber:this.number}]},b();else if(t.chunkNumber===f)t.onDecodeAll||t.rejectRequestAll||(t.onDecodeAll=d,t.rejectRequestAll=m),t.callbacks.push({resolve:r,reject:n,frameNumber:this.number});else{if(h[this.tid].nextChunkRequest){const{callbacks:e}=h[this.tid].nextChunkRequest;for(const t of e)t.reject(t.frameNumber)}h[this.tid].nextChunkRequest={request:null,chunkNumber:f,start:l,stop:p,onDecodeAll:d,rejectRequestAll:m,completed:!1,callbacks:[{resolve:r,reject:n,frameNumber:this.number}]}}}else{if(this.number%u>u/4&&i.decodedBlocksCacheSize>1&&this.decodeForward&&!i.isNextChunkExists(this.number)){const e=Math.floor(this.number/u)+1;if(e*u<this.stopFrame){i.setReadyToLoading(e);const t=e*u,n=(e+1)*u-1;i.isChunkCached(t,n)?i.requestDecodeBlock(null,t,n,null,null):h[this.tid].activeChunkRequest||(h[this.tid].activeChunkRequest={request:null,chunkNumber:e,start:t,stop:n,onDecodeAll:null,rejectRequestAll:null,completed:!1,callbacks:[]},b())}}r(t)}}).catch(e=>{n(e instanceof c?e:new c(e.message))})})};class d{constructor(e,t,n,r){this._size=e,this._buffer={},this._requestedChunks={},this._chunkSize=t,this._stopFrame=n,this._activeFillBufferRequest=!1,this._taskID=r}getFreeBufferSize(){let e=0;for(const t of Object.values(this._requestedChunks))e+=t.requestedFrames.size;return this._size-Object.keys(this._buffer).length-e}requestOneChunkFrames(e){return new Promise((t,n)=>{this._requestedChunks[e]={...this._requestedChunks[e],resolve:t,reject:n};for(const t of this._requestedChunks[e].requestedFrames.entries()){const r=t[1],i=f(this._taskID,r),s=new p({...i,taskID:this._taskID,frameNumber:r,startFrame:h[this._taskID].startFrame,stopFrame:h[this._taskID].stopFrame,decodeForward:!1});s.data().then(()=>{if(e in this._requestedChunks&&this._requestedChunks[e].requestedFrames.has(r)){if(this._requestedChunks[e].requestedFrames.delete(r),this._requestedChunks[e].buffer[r]=s,0===this._requestedChunks[e].requestedFrames.size){const t=Object.keys(this._requestedChunks[e].buffer).map(e=>+e);this._requestedChunks[e].resolve(new Set(t))}}else n(e)}).catch(()=>{n(e)})}})}fillBuffer(e,t=1,n=null){const r=this.getFreeBufferSize(),i=n?n*t:r*t,s=Math.min(e+i,this._stopFrame+1);for(let n=e;n<s;n+=t){const e=Math.floor(n/this._chunkSize);e in this._requestedChunks||(this._requestedChunks[e]={requestedFrames:new Set,resolve:null,reject:null,buffer:{}}),this._requestedChunks[e].requestedFrames.add(n)}let a=new Set;return new Promise(async(e,t)=>{for(const n in this._requestedChunks)if(Object.prototype.hasOwnProperty.call(this._requestedChunks,n))try{const r=await this.requestOneChunkFrames(n);if(!(n in this._requestedChunks)){t(n);break}a=new Set([...a,...r]),this._buffer={...this._buffer,...this._requestedChunks[n].buffer},delete this._requestedChunks[n],0===Object.keys(this._requestedChunks).length&&e(a)}catch(e){t(e);break}})}async makeFillRequest(e,t,n=null){if(!this._activeFillBufferRequest){this._activeFillBufferRequest=!0;try{await this.fillBuffer(e,t,n),this._activeFillBufferRequest=!1}catch(e){throw"number"==typeof e&&e in this._requestedChunks&&(this._activeFillBufferRequest=!1),e}}}async require(e,t,n,r){for(const t in this._buffer)(t<e||t>=e+this._size*r)&&delete this._buffer[t];this._required=e;const i=f(t,e);let s=new p({...i,taskID:t,frameNumber:e,startFrame:h[t].startFrame,stopFrame:h[t].stopFrame,decodeForward:!n});if(e in this._buffer){s=this._buffer[e],delete this._buffer[e];const t=this.cachedFrames();if(n&&!this._activeFillBufferRequest&&this._size>this._chunkSize&&t.length<3*this._size/4){const n=t?Math.max(...t):e;n<this._stopFrame&&this.makeFillRequest(n+1,r).catch(e=>{if("not needed"!==e)throw e})}}else n?(this.clear(),await this.makeFillRequest(e,r,n?null:1),s=this._buffer[e]):this.clear();return s}clear(){for(const e in this._requestedChunks)Object.prototype.hasOwnProperty.call(this._requestedChunks,e)&&this._requestedChunks[e].reject&&this._requestedChunks[e].reject("not needed");this._activeFillBufferRequest=!1,this._requestedChunks={},this._buffer={}}cachedFrames(){return Object.keys(this._buffer).map(e=>+e)}}e.exports={FrameData:p,getFrame:async function(e,t,n,i,a,o,c,u,l){if(!(e in h)){const u="video"===n?r.BlockType.MP4VIDEO:r.BlockType.ARCHIVE,l=await s.frames.getMeta(e),p=l.frames.reduce((e,t)=>e+t.width*t.height,0)/l.frames.length,m=Math.sqrt(l.frames.map(e=>Math.pow(e.width*e.height-p,2)).reduce((e,t)=>e+t)/l.frames.length),b=Math.floor(2147483648/(p+m)/4/t)||1;h[e]={meta:l,chunkSize:t,mode:i,startFrame:o,stopFrame:c,provider:new r.FrameProvider(u,t,Math.max(b,9),b,1),frameBuffer:new d(Math.min(180,b*t),t,c,e),decodedBlocksCacheSize:b,activeChunkRequest:null,nextChunkRequest:null};const y=f(e,a);h[e].provider.setRenderSize(y.width,y.height)}return h[e].frameBuffer.require(a,e,u,l)},getRanges:function(e){return e in h?{decoded:h[e].provider.cachedFrames,buffered:h[e].frameBuffer.cachedFrames()}:{decoded:[],buffered:[]}},getPreview:async function(e){return new Promise((n,r)=>{s.frames.getPreview(e).then(e=>{if(o)n(t.Buffer.from(e,"binary").toString("base64"));else if(a){const t=new FileReader;t.onload=()=>{n(t.result)},t.readAsDataURL(e)}}).catch(e=>{r(e)})})}}})()}).call(this,n(6))},function(e,t,n){const{Mutex:r}=n(63),{MP4Reader:i,Bytestream:s}=n(65),a=n(66),o=n(67),c=Object.freeze({MP4VIDEO:"mp4video",ARCHIVE:"archive"});class u{constructor(e,t,n,i=5,s=2){this._frames={},this._cachedBlockCount=Math.max(1,n),this._decodedBlocksCacheSize=i,this._blocksRanges=[],this._blocks={},this._blockSize=t,this._running=!1,this._blockType=e,this._currFrame=-1,this._requestedBlockDecode=null,this._width=null,this._height=null,this._decodingBlocks={},this._decodeThreadCount=0,this._timerId=setTimeout(this._worker.bind(this),100),this._mutex=new r,this._promisedFrames={},this._maxWorkerThreadCount=s}async _worker(){null!==this._requestedBlockDecode&&this._decodeThreadCount<this._maxWorkerThreadCount&&await this.startDecode(),this._timerId=setTimeout(this._worker.bind(this),100)}isChunkCached(e,t){return`${e}:${t}`in this._blocksRanges}async _cleanup(){if(this._blocksRanges.length>this._cachedBlockCount){const e=this._blocksRanges.shift(),[t,n]=e.split(":").map(e=>+e);delete this._blocks[t/this._blockSize];for(let e=t;e<=n;e++)delete this._frames[e]}const e=Math.floor(this._decodedBlocksCacheSize/2);for(let t=0;t<this._blocksRanges.length;t++){const[n,r]=this._blocksRanges[t].split(":").map(e=>+e);if(r<this._currFrame-e*this._blockSize||n>this._currFrame+e*this._blockSize)for(let e=n;e<=r;e++)delete this._frames[e]}}async requestDecodeBlock(e,t,n,r,i){const s=await this._mutex.acquire();try{null!==this._requestedBlockDecode&&(t===this._requestedBlockDecode.start&&n===this._requestedBlockDecode.end?(this._requestedBlockDecode.resolveCallback=r,this._requestedBlockDecode.rejectCallback=i):this._requestedBlockDecode.rejectCallback&&this._requestedBlockDecode.rejectCallback()),`${t}:${n}`in this._decodingBlocks?(this._decodingBlocks[`${t}:${n}`].rejectCallback=i,this._decodingBlocks[`${t}:${n}`].resolveCallback=r):this._requestedBlockDecode={block:e||this._blocks[Math.floor(t/this._blockSize)],start:t,end:n,resolveCallback:r,rejectCallback:i}}finally{s()}}isRequestExist(){return null!==this._requestedBlockDecode}setRenderSize(e,t){this._width=e,this._height=t}async frame(e){return this._currFrame=e,new Promise((t,n)=>{e in this._frames?null!==this._frames[e]?t(this._frames[e]):this._promisedFrames[e]={resolve:t,reject:n}:t(null)})}isNextChunkExists(e){const t=Math.floor(e/this._blockSize)+1;return"loading"===this._blocks[t]||t in this._blocks}setReadyToLoading(e){this._blocks[e]="loading"}static cropImage(e,t,n,r,i,s,a){if(0===r&&s===t&&0===i&&a===n)return new ImageData(new Uint8ClampedArray(e),s,a);const o=new Uint32Array(e),c=s*a*4,u=new ArrayBuffer(c),l=new Uint32Array(u),h=new Uint8ClampedArray(u);if(t===s)return new ImageData(new Uint8ClampedArray(e,4*i,c),s,a);let p=0;for(let e=i;e<a;e++){const n=e*t+r;l.set(o.subarray(n,n+s),p),p+=s}return new ImageData(h,s,a)}async startDecode(){const e=await this._mutex.acquire();try{const t=this._height,n=this._width,{start:r,end:l,block:h}=this._requestedBlockDecode;this._blocksRanges.push(`${r}:${l}`),this._decodingBlocks[`${r}:${l}`]=this._requestedBlockDecode,this._requestedBlockDecode=null,this._blocks[Math.floor((r+1)/this._blockSize)]=h;for(let e=r;e<=l;e++)this._frames[e]=null;if(this._cleanup(),this._blockType===c.MP4VIDEO){const e=new o;let a=r;e.onmessage=i=>{if(i.data.consoleLog)return;const s=Math.ceil(this._height/i.data.height);this._frames[a]=u.cropImage(i.data.buf,i.data.width,i.data.height,0,0,Math.floor(n/s),Math.floor(t/s)),this._decodingBlocks[`${r}:${l}`].resolveCallback&&this._decodingBlocks[`${r}:${l}`].resolveCallback(a),a in this._promisedFrames&&(this._promisedFrames[a].resolve(this._frames[a]),delete this._promisedFrames[a]),a===l&&(this._decodeThreadCount--,delete this._decodingBlocks[`${r}:${l}`],e.terminate()),a++},e.onerror=t=>{e.terminate(),this._decodeThreadCount--;for(let e=a;e<=l;e++)e in this._promisedFrames&&(this._promisedFrames[e].reject(),delete this._promisedFrames[e]);this._decodingBlocks[`${r}:${l}`].rejectCallback&&this._decodingBlocks[`${r}:${l}`].rejectCallback(Error(t)),delete this._decodingBlocks[`${r}:${l}`]},e.postMessage({type:"Broadway.js - Worker init",options:{rgb:!0,reuseMemory:!1}});const c=new i(new s(h));c.read();const p=c.tracks[1],f=c.tracks[1].trak.mdia.minf.stbl.stsd.avc1.avcC,d=f.sps[0],m=f.pps[0];e.postMessage({buf:d,offset:0,length:d.length}),e.postMessage({buf:m,offset:0,length:m.length});for(let t=0;t<p.getSampleCount();t++)p.getSampleNALUnits(t).forEach(t=>{e.postMessage({buf:t,offset:0,length:t.length})});this._decodeThreadCount++}else{const e=new a;let t=r;e.onerror=t=>{for(let e=r;e<=l;e++)e in this._promisedFrames&&(this._promisedFrames[e].reject(),delete this._promisedFrames[e]);this._decodingBlocks[`${r}:${l}`].rejectCallback&&this._decodingBlocks[`${r}:${l}`].rejectCallback(Error(t)),this._decodeThreadCount--,e.terminate()},e.onmessage=n=>{this._frames[n.data.index]=n.data.data,this._decodingBlocks[`${r}:${l}`].resolveCallback&&this._decodingBlocks[`${r}:${l}`].resolveCallback(n.data.index),n.data.index in this._promisedFrames&&(this._promisedFrames[n.data.index].resolve(this._frames[n.data.index]),delete this._promisedFrames[n.data.index]),t===l&&(e.terminate(),delete this._decodingBlocks[`${r}:${l}`],this._decodeThreadCount--),t++},e.postMessage({block:h,start:r,end:l}),this._decodeThreadCount++}}finally{e()}}get decodeThreadCount(){return this._decodeThreadCount}get decodedBlocksCacheSize(){return this._decodedBlocksCacheSize}get cachedFrames(){return[...this._blocksRanges].sort((e,t)=>e.split(":")[0]-t.split(":")[0])}}e.exports={FrameProvider:u,BlockType:c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(64);t.Mutex=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._queue=[],this._pending=!1}return e.prototype.isLocked=function(){return this._pending},e.prototype.acquire=function(){var e=this,t=new Promise((function(t){return e._queue.push(t)}));return this._pending||this._dispatchNext(),t},e.prototype.runExclusive=function(e){return this.acquire().then((function(t){var n;try{n=e()}catch(e){throw t(),e}return Promise.resolve(n).then((function(e){return t(),e}),(function(e){throw t(),e}))}))},e.prototype._dispatchNext=function(){this._queue.length>0?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1},e}();t.default=r},function(e,t){e.exports=function(){"use strict";function e(e,t){e||error(t)}var t,n=function(){function e(e,t){this.w=e,this.h=t}return e.prototype={toString:function(){return"("+this.w+", "+this.h+")"},getHalfSize:function(){return new n(this.w>>>1,this.h>>>1)},length:function(){return this.w*this.h}},e}(),r=function(){function t(e,t,n){this.bytes=new Uint8Array(e),this.start=t||0,this.pos=this.start,this.end=t+n||this.bytes.length}return t.prototype={get length(){return this.end-this.start},get position(){return this.pos},get remaining(){return this.end-this.pos},readU8Array:function(e){if(this.pos>this.end-e)return null;var t=this.bytes.subarray(this.pos,this.pos+e);return this.pos+=e,t},readU32Array:function(e,t,n){if(t=t||1,this.pos>this.end-e*t*4)return null;if(1==t){for(var r=new Uint32Array(e),i=0;i<e;i++)r[i]=this.readU32();return r}for(r=new Array(e),i=0;i<e;i++){var s=null;if(n){s={};for(var a=0;a<t;a++)s[n[a]]=this.readU32()}else{s=new Uint32Array(t);for(a=0;a<t;a++)s[a]=this.readU32()}r[i]=s}return r},read8:function(){return this.readU8()<<24>>24},readU8:function(){return this.pos>=this.end?null:this.bytes[this.pos++]},read16:function(){return this.readU16()<<16>>16},readU16:function(){if(this.pos>=this.end-1)return null;var e=this.bytes[this.pos+0]<<8|this.bytes[this.pos+1];return this.pos+=2,e},read24:function(){return this.readU24()<<8>>8},readU24:function(){var e=this.pos,t=this.bytes;if(e>this.end-3)return null;var n=t[e+0]<<16|t[e+1]<<8|t[e+2];return this.pos+=3,n},peek32:function(e){var t=this.pos,n=this.bytes;if(t>this.end-4)return null;var r=n[t+0]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3];return e&&(this.pos+=4),r},read32:function(){return this.peek32(!0)},readU32:function(){return this.peek32(!0)>>>0},read4CC:function(){var e=this.pos;if(e>this.end-4)return null;for(var t="",n=0;n<4;n++)t+=String.fromCharCode(this.bytes[e+n]);return this.pos+=4,t},readFP16:function(){return this.read32()/65536},readFP8:function(){return this.read16()/256},readISO639:function(){for(var e=this.readU16(),t="",n=0;n<3;n++){var r=e>>>5*(2-n)&31;t+=String.fromCharCode(r+96)}return t},readUTF8:function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.readU8());return t},readPString:function(t){var n=this.readU8();e(n<=t);var r=this.readUTF8(n);return this.reserved(t-n-1,0),r},skip:function(e){this.seek(this.pos+e)},reserved:function(t,n){for(var r=0;r<t;r++)e(this.readU8()==n)},seek:function(e){(e<0||e>this.end)&&error("Index out of bounds (bounds: [0, "+this.end+"], index: "+e+")."),this.pos=e},subStream:function(e,t){return new r(this.bytes.buffer,e,t)}},t}(),i=function(){function t(e){this.stream=e,this.tracks={}}return t.prototype={readBoxes:function(e,t){for(;e.peek32();){var n=this.readBox(e);if(n.type in t){var r=t[n.type];r instanceof Array||(t[n.type]=[r]),t[n.type].push(n)}else t[n.type]=n}},readBox:function(t){var n={offset:t.position};function r(){n.version=t.readU8(),n.flags=t.readU24()}function i(){return n.size-(t.position-n.offset)}function a(){t.skip(i())}var o=function(){var e=t.subStream(t.position,i());this.readBoxes(e,n),t.skip(e.length)}.bind(this);switch(n.size=t.readU32(),n.type=t.read4CC(),n.type){case"ftyp":n.name="File Type Box",n.majorBrand=t.read4CC(),n.minorVersion=t.readU32(),n.compatibleBrands=new Array((n.size-16)/4);for(var c=0;c<n.compatibleBrands.length;c++)n.compatibleBrands[c]=t.read4CC();break;case"moov":n.name="Movie Box",o();break;case"mvhd":n.name="Movie Header Box",r(),e(0==n.version),n.creationTime=t.readU32(),n.modificationTime=t.readU32(),n.timeScale=t.readU32(),n.duration=t.readU32(),n.rate=t.readFP16(),n.volume=t.readFP8(),t.skip(10),n.matrix=t.readU32Array(9),t.skip(24),n.nextTrackId=t.readU32();break;case"trak":n.name="Track Box",o(),this.tracks[n.tkhd.trackId]=new s(this,n);break;case"tkhd":n.name="Track Header Box",r(),e(0==n.version),n.creationTime=t.readU32(),n.modificationTime=t.readU32(),n.trackId=t.readU32(),t.skip(4),n.duration=t.readU32(),t.skip(8),n.layer=t.readU16(),n.alternateGroup=t.readU16(),n.volume=t.readFP8(),t.skip(2),n.matrix=t.readU32Array(9),n.width=t.readFP16(),n.height=t.readFP16();break;case"mdia":n.name="Media Box",o();break;case"mdhd":n.name="Media Header Box",r(),e(0==n.version),n.creationTime=t.readU32(),n.modificationTime=t.readU32(),n.timeScale=t.readU32(),n.duration=t.readU32(),n.language=t.readISO639(),t.skip(2);break;case"hdlr":n.name="Handler Reference Box",r(),t.skip(4),n.handlerType=t.read4CC(),t.skip(12);var u=n.size-32;u>0&&(n.name=t.readUTF8(u));break;case"minf":n.name="Media Information Box",o();break;case"stbl":n.name="Sample Table Box",o();break;case"stsd":n.name="Sample Description Box",r(),n.sd=[];t.readU32();o();break;case"avc1":t.reserved(6,0),n.dataReferenceIndex=t.readU16(),e(0==t.readU16()),e(0==t.readU16()),t.readU32(),t.readU32(),t.readU32(),n.width=t.readU16(),n.height=t.readU16(),n.horizontalResolution=t.readFP16(),n.verticalResolution=t.readFP16(),e(0==t.readU32()),n.frameCount=t.readU16(),n.compressorName=t.readPString(32),n.depth=t.readU16(),e(65535==t.readU16()),o();break;case"mp4a":t.reserved(6,0),n.dataReferenceIndex=t.readU16(),n.version=t.readU16(),t.skip(2),t.skip(4),n.channelCount=t.readU16(),n.sampleSize=t.readU16(),n.compressionId=t.readU16(),n.packetSize=t.readU16(),n.sampleRate=t.readU32()>>>16,e(0==n.version),o();break;case"esds":n.name="Elementary Stream Descriptor",r(),a();break;case"avcC":n.name="AVC Configuration Box",n.configurationVersion=t.readU8(),n.avcProfileIndication=t.readU8(),n.profileCompatibility=t.readU8(),n.avcLevelIndication=t.readU8(),n.lengthSizeMinusOne=3&t.readU8(),e(3==n.lengthSizeMinusOne,"TODO");var l=31&t.readU8();n.sps=[];for(c=0;c<l;c++)n.sps.push(t.readU8Array(t.readU16()));l=31&t.readU8();n.pps=[];for(c=0;c<l;c++)n.pps.push(t.readU8Array(t.readU16()));a();break;case"btrt":n.name="Bit Rate Box",n.bufferSizeDb=t.readU32(),n.maxBitrate=t.readU32(),n.avgBitrate=t.readU32();break;case"stts":n.name="Decoding Time to Sample Box",r(),n.table=t.readU32Array(t.readU32(),2,["count","delta"]);break;case"stss":n.name="Sync Sample Box",r(),n.samples=t.readU32Array(t.readU32());break;case"stsc":n.name="Sample to Chunk Box",r(),n.table=t.readU32Array(t.readU32(),3,["firstChunk","samplesPerChunk","sampleDescriptionId"]);break;case"stsz":n.name="Sample Size Box",r(),n.sampleSize=t.readU32();l=t.readU32();0==n.sampleSize&&(n.table=t.readU32Array(l));break;case"stco":n.name="Chunk Offset Box",r(),n.table=t.readU32Array(t.readU32());break;case"smhd":n.name="Sound Media Header Box",r(),n.balance=t.readFP8(),t.reserved(2,0);break;case"mdat":n.name="Media Data Box",e(n.size>=8,"Cannot parse large media data yet."),n.data=t.readU8Array(i());break;default:a()}return n},read:function(){var e=(new Date).getTime();this.file={},this.readBoxes(this.stream,this.file),console.info("Parsed stream in "+((new Date).getTime()-e)+" ms")},traceSamples:function(){var e=this.tracks[1],t=this.tracks[2];console.info("Video Samples: "+e.getSampleCount()),console.info("Audio Samples: "+t.getSampleCount());for(var n=0,r=0,i=0;i<100;i++){var s=e.sampleToOffset(n),a=t.sampleToOffset(r),o=e.sampleToSize(n,1),c=t.sampleToSize(r,1);s<a?(console.info("V Sample "+n+" Offset : "+s+", Size : "+o),n++):(console.info("A Sample "+r+" Offset : "+a+", Size : "+c),r++)}}},t}(),s=function(){function t(e,t){this.file=e,this.trak=t}return t.prototype={getSampleSizeTable:function(){return this.trak.mdia.minf.stbl.stsz.table},getSampleCount:function(){return this.getSampleSizeTable().length},sampleToSize:function(e,t){for(var n=this.getSampleSizeTable(),r=0,i=e;i<e+t;i++)r+=n[i];return r},sampleToChunk:function(t){var n=this.trak.mdia.minf.stbl.stsc.table;if(1===n.length)return e(1===(s=n[0]).firstChunk),{index:Math.floor(t/s.samplesPerChunk),offset:t%s.samplesPerChunk};for(var r=0,i=0;i<n.length;i++){var s=n[i];if(i>0){var a=n[i-1],o=s.firstChunk-a.firstChunk,c=a.samplesPerChunk*o;if(!(t>=c))return{index:r+Math.floor(t/a.samplesPerChunk),offset:t%a.samplesPerChunk};if(t-=c,i==n.length-1)return{index:r+o+Math.floor(t/s.samplesPerChunk),offset:t%s.samplesPerChunk};r+=o}}e(!1)},chunkToOffset:function(e){return this.trak.mdia.minf.stbl.stco.table[e]},sampleToOffset:function(e){var t=this.sampleToChunk(e);return this.chunkToOffset(t.index)+this.sampleToSize(e-t.offset,t.offset)},timeToSample:function(e){for(var t=this.trak.mdia.minf.stbl.stts.table,n=0,r=0;r<t.length;r++){var i=t[r].count*t[r].delta;if(!(e>=i))return n+Math.floor(e/t[r].delta);e-=i,n+=t[r].count}},getTotalTime:function(){for(var t=this.trak.mdia.minf.stbl.stts.table,n=0,r=0;r<t.length;r++)n+=t[r].count*t[r].delta;return e(this.trak.mdia.mdhd.duration==n),this.trak.mdia.mdhd.duration},getTotalTimeInSeconds:function(){return this.timeToSeconds(this.getTotalTime())},getTimeScale:function(){return this.trak.mdia.mdhd.timeScale},timeToSeconds:function(e){return e/this.getTimeScale()},secondsToTime:function(e){return e*this.getTimeScale()},foo:function(){},getSampleNALUnits:function(e){for(var t=this.file.stream.bytes,n=this.sampleToOffset(e),i=n+this.sampleToSize(e,1),s=[];i-n>0;){var a=new r(t.buffer,n).readU32();s.push(t.subarray(n+4,n+a+4)),n=n+a+4}return s}},t}();t=[],window.addEventListener("message",(function(e){e.source==window&&"zero-timeout-message"==e.data&&(e.stopPropagation(),t.length>0&&t.shift()())}),!0),window.setZeroTimeout=function(e){t.push(e),window.postMessage("zero-timeout-message","*")};var a=function(){function e(e,n,r,i){this.stream=e,this.useWorkers=n,this.webgl=r,this.render=i,this.statistics={videoStartTime:0,videoPictureCounter:0,windowStartTime:0,windowPictureCounter:0,fps:0,fpsMin:1e3,fpsMax:-1e3,webGLTextureUploadTime:0},this.onStatisticsUpdated=function(){},this.avc=new Player({useWorker:n,reuseMemory:!0,webgl:r,size:{width:640,height:368}}),this.webgl=this.avc.webgl;var s=this;this.avc.onPictureDecoded=function(){t.call(s)},this.canvas=this.avc.canvas}function t(){var e=this.statistics;e.videoPictureCounter+=1,e.windowPictureCounter+=1;var t=Date.now();e.videoStartTime||(e.videoStartTime=t);var n=t-e.videoStartTime;if(e.elapsed=n/1e3,!(n<1e3))if(e.windowStartTime){if(t-e.windowStartTime>1e3){var r=t-e.windowStartTime,i=e.windowPictureCounter/r*1e3;e.windowStartTime=t,e.windowPictureCounter=0,i<e.fpsMin&&(e.fpsMin=i),i>e.fpsMax&&(e.fpsMax=i),e.fps=i}i=e.videoPictureCounter/n*1e3;e.fpsSinceStart=i,this.onStatisticsUpdated(this.statistics)}else e.windowStartTime=t}return e.prototype={readAll:function(e){console.info("MP4Player::readAll()"),this.stream.readAll(null,function(t){this.reader=new i(new r(t)),this.reader.read();var s=this.reader.tracks[1];this.size=new n(s.trak.tkhd.width,s.trak.tkhd.height),console.info("MP4Player::readAll(), length: "+this.reader.stream.length),e&&e()}.bind(this))},play:function(){var e=this.reader;if(e){var t=e.tracks[1],n=(e.tracks[2],e.tracks[1].trak.mdia.minf.stbl.stsd.avc1.avcC),r=n.sps[0],i=n.pps[0];this.avc.decode(r),this.avc.decode(i);var s=0;setTimeout(function e(){var n=this.avc;t.getSampleNALUnits(s).forEach((function(e){n.decode(e)})),++s<3e3&&setTimeout(e.bind(this),1)}.bind(this),1)}else this.readAll(this.play.bind(this))}},e}(),o=function(){function e(e){var t=e.attributes.src?e.attributes.src.value:void 0,n=(e.attributes.width&&e.attributes.width.value,e.attributes.height&&e.attributes.height.value,document.createElement("div"));n.setAttribute("style","z-index: 100; position: absolute; bottom: 0px; background-color: rgba(0,0,0,0.8); height: 30px; width: 100%; text-align: left;"),this.info=document.createElement("div"),this.info.setAttribute("style","font-size: 14px; font-weight: bold; padding: 6px; color: lime;"),n.appendChild(this.info),e.appendChild(n);var r=!!e.attributes.workers&&"true"==e.attributes.workers.value,i=!!e.attributes.render&&"true"==e.attributes.render.value,s="auto";e.attributes.webgl&&("true"==e.attributes.webgl.value&&(s=!0),"false"==e.attributes.webgl.value&&(s=!1));var o="";o+=r?"worker thread ":"main thread ",this.player=new a(new Stream(t),r,s,i),this.canvas=this.player.canvas,this.canvas.onclick=function(){this.play()}.bind(this),e.appendChild(this.canvas),o+=" - webgl: "+this.player.webgl,this.info.innerHTML="Click canvas to load and play - "+o,this.score=null,this.player.onStatisticsUpdated=function(e){if(e.videoPictureCounter%10==0){var t="";e.fps&&(t+=" fps: "+e.fps.toFixed(2)),e.fpsSinceStart&&(t+=" avg: "+e.fpsSinceStart.toFixed(2));e.videoPictureCounter<1200?this.score=1200-e.videoPictureCounter:1200==e.videoPictureCounter&&(this.score=e.fpsSinceStart.toFixed(2)),this.info.innerHTML=o+t}}.bind(this)}return e.prototype={play:function(){this.player.play()}},e}();return{Size:n,Track:s,MP4Reader:i,MP4Player:a,Bytestream:r,Broadway:o}}()},function(e,t){e.exports=function(){return new Worker("/static/engine/js/unzip_imgs.worker.js")}},function(e,t){e.exports=function(){return new Worker("/static/engine/js/3rdparty/Decoder.worker.js")}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r="undefined"!=typeof window&&void 0!==window.document,i="object"===("undefined"==typeof self?"undefined":n(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,s=void 0!==e&&null!=e.versions&&null!=e.versions.node;t.isBrowser=r,t.isWebWorker=i,t.isNode=s}).call(this,n(12))},function(e,t,n){(()=>{const t=n(4),r=n(70),i=n(74),s=n(75),{checkObjectType:a}=n(9),{Task:o}=n(7),{Loader:c,Dumper:u}=n(23),{ScriptingError:l,DataError:h,ArgumentError:p}=n(0),f=new WeakMap,d=new WeakMap;function m(e){if("task"===e)return d;if("job"===e)return f;throw new l(`Unknown session type was received ${e}`)}async function b(e){const n=e instanceof o?"task":"job",a=m(n);if(!a.has(e)){const o=await t.annotations.getAnnotations(n,e.id),c="job"===n?e.startFrame:0,u="job"===n?e.stopFrame:e.size-1,l={};for(let t=c;t<=u;t++)l[t]=await e.frames.get(t);const h=new s,p=new r({labels:e.labels||e.task.labels,history:h,startFrame:c,stopFrame:u,frameMeta:l});p.import(o);const f=new i(o.version,p,e);a.set(e,{collection:p,saver:f,history:h})}}e.exports={getAnnotations:async function(e,t,n,r){const i=m(e instanceof o?"task":"job");return i.has(e)||await b(e),i.get(e).collection.get(t,n,r)},putAnnotations:function(e,t){const n=m(e instanceof o?"task":"job");if(n.has(e))return n.get(e).collection.put(t);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},saveAnnotations:async function(e,t){const n=m(e instanceof o?"task":"job");n.has(e)&&await n.get(e).saver.save(t)},hasUnsavedChanges:function(e){const t=m(e instanceof o?"task":"job");return!!t.has(e)&&t.get(e).saver.hasUnsavedChanges()},mergeAnnotations:function(e,t){const n=m(e instanceof o?"task":"job");if(n.has(e))return n.get(e).collection.merge(t);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},searchAnnotations:function(e,t,n,r){const i=m(e instanceof o?"task":"job");if(i.has(e))return i.get(e).collection.search(t,n,r);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},splitAnnotations:function(e,t,n){const r=m(e instanceof o?"task":"job");if(r.has(e))return r.get(e).collection.split(t,n);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},groupAnnotations:function(e,t,n){const r=m(e instanceof o?"task":"job");if(r.has(e))return r.get(e).collection.group(t,n);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},clearAnnotations:async function(e,t){a("reload",t,"boolean",null);const n=m(e instanceof o?"task":"job");n.has(e)&&n.get(e).collection.clear(),t&&(n.delete(e),await b(e))},annotationsStatistics:function(e){const t=m(e instanceof o?"task":"job");if(t.has(e))return t.get(e).collection.statistics();throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},selectObject:function(e,t,n,r){const i=m(e instanceof o?"task":"job");if(i.has(e))return i.get(e).collection.select(t,n,r);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},uploadAnnotations:async function(e,n,r){const i=e instanceof o?"task":"job";if(!(r instanceof c))throw new p("A loader must be instance of Loader class");await t.annotations.uploadAnnotations(i,e.id,n,r.name)},dumpAnnotations:async function(e,n,r){if(!(r instanceof u))throw new p("A dumper must be instance of Dumper class");let i=null;return i="job"===(e instanceof o?"task":"job")?await t.annotations.dumpAnnotations(e.task.id,n,r.name):await t.annotations.dumpAnnotations(e.id,n,r.name),i},importAnnotations:function(e,t){const n=m(e instanceof o?"task":"job");if(n.has(e))return n.get(e).collection.import(t);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},exportAnnotations:function(e){const t=m(e instanceof o?"task":"job");if(t.has(e))return t.get(e).collection.export();throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},exportDataset:async function(e,n){if(!(n instanceof String||"string"==typeof n))throw new p("Format must be a string");if(!(e instanceof o))throw new p("A dataset can only be created from a task");let r=null;return r=await t.tasks.exportDataset(e.id,n),r},undoActions:function(e,t){const n=m(e instanceof o?"task":"job");if(n.has(e))return n.get(e).history.undo(t);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},redoActions:function(e,t){const n=m(e instanceof o?"task":"job");if(n.has(e))return n.get(e).history.redo(t);throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},clearActions:function(e){const t=m(e instanceof o?"task":"job");if(t.has(e))return t.get(e).history.clear();throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")},getActions:function(e){const t=m(e instanceof o?"task":"job");if(t.has(e))return t.get(e).history.get();throw new h("Collection has not been initialized yet. Call annotations.get() or annotations.clear(true) before")}}})()},function(e,t,n){(()=>{const{RectangleShape:t,PolygonShape:r,PolylineShape:i,PointsShape:s,CuboidShape:a,RectangleTrack:o,PolygonTrack:c,PolylineTrack:u,PointsTrack:l,CuboidTrack:h,Track:p,Shape:f,Tag:d,objectStateFactory:m}=n(71),b=n(72),{checkObjectType:y}=n(9),g=n(22),{Label:v}=n(8),{DataError:w,ArgumentError:k,ScriptingError:S}=n(0),{HistoryActions:x,ObjectShape:O,ObjectType:_,colors:E}=n(2),C=n(13);function j(e,n,o){const{type:c}=e,u=E[n%E.length];let l=null;switch(c){case"rectangle":l=new t(e,n,u,o);break;case"polygon":l=new r(e,n,u,o);break;case"polyline":l=new i(e,n,u,o);break;case"points":l=new s(e,n,u,o);break;case"cuboid":l=new a(e,n,u,o);break;default:throw new w(`An unexpected type of shape "${c}"`)}return l}function T(e,t,n){if(e.shapes.length){const{type:r}=e.shapes[0],i=E[t%E.length];let s=null;switch(r){case"rectangle":s=new o(e,t,i,n);break;case"polygon":s=new c(e,t,i,n);break;case"polyline":s=new u(e,t,i,n);break;case"points":s=new l(e,t,i,n);break;case"cuboid":s=new h(e,t,i,n);break;default:throw new w(`An unexpected type of track "${r}"`)}return s}return console.warn("The track without any shapes had been found. It was ignored."),null}e.exports=class{constructor(e){this.startFrame=e.startFrame,this.stopFrame=e.stopFrame,this.frameMeta=e.frameMeta,this.labels=e.labels.reduce((e,t)=>(e[t.id]=t,e),{}),this.annotationsFilter=new b,this.history=e.history,this.shapes={},this.tags={},this.tracks=[],this.objects={},this.count=0,this.flush=!1,this.groups={max:0},this.injection={labels:this.labels,groups:this.groups,frameMeta:this.frameMeta,history:this.history,groupColors:{}}}import(e){const t={tags:[],shapes:[],tracks:[]};for(const n of e.tags){const e=++this.count,r=E[e%E.length],i=new d(n,e,r,this.injection);this.tags[i.frame]=this.tags[i.frame]||[],this.tags[i.frame].push(i),this.objects[e]=i,t.tags.push(i)}for(const n of e.shapes){const e=++this.count,r=j(n,e,this.injection);this.shapes[r.frame]=this.shapes[r.frame]||[],this.shapes[r.frame].push(r),this.objects[e]=r,t.shapes.push(r)}for(const n of e.tracks){const e=++this.count,r=T(n,e,this.injection);r&&(this.tracks.push(r),this.objects[e]=r,t.tracks.push(r))}return t}export(){return{tracks:this.tracks.filter(e=>!e.removed).map(e=>e.toJSON()),shapes:Object.values(this.shapes).reduce((e,t)=>(e.push(...t),e),[]).filter(e=>!e.removed).map(e=>e.toJSON()),tags:Object.values(this.tags).reduce((e,t)=>(e.push(...t),e),[]).filter(e=>!e.removed).map(e=>e.toJSON())}}get(e,t,n){const{tracks:r}=this,i=this.shapes[e]||[],s=this.tags[e]||[],a=[].concat(r,i,s),o={models:[],data:[]};for(const n of a){if(n.removed)continue;const r=n.get(e);(t||!r.outside||r.keyframe)&&(o.models.push(n),o.data.push(r))}const[,c]=this.annotationsFilter.toJSONQuery(n);let u=[];n.length&&(u=this.annotationsFilter.filter(o.data,c));const l=[];return o.data.forEach((t,r)=>{if(!n.length||u.includes(t.clientID)){const n=o.models[r],i=m.call(n,e,t);l.push(i)}}),l}merge(e){if(y("shapes for merge",e,null,Array),!e.length)return;const t=e.map(e=>{y("object state",e,null,C);const t=this.objects[e.clientID];if(void 0===t)throw new k("The object has not been saved yet. Call ObjectState.put([state]) before you can merge it");return t}),n={},{label:r,shapeType:i}=e[0];if(!(r.id in this.labels))throw new k(`Unknown label for the task: ${r.id}`);if(!Object.values(O).includes(i))throw new k(`Got unknown shapeType "${i}"`);const s=r.attributes.reduce((e,t)=>(e[t.id]=t,e),{});for(let a=0;a<t.length;a++){const o=t[a],c=e[a];if(c.label.id!==r.id)throw new k(`All shape labels are expected to be ${r.name}, but got ${c.label.name}`);if(c.shapeType!==i)throw new k(`All shapes are expected to be ${i}, but got ${c.shapeType}`);if(o instanceof f){if(o.frame in n&&!n[o.frame].outside)throw new k("Expected only one visible shape per frame");n[o.frame]={type:i,frame:o.frame,points:[...o.points],occluded:o.occluded,zOrder:o.zOrder,outside:!1,attributes:Object.keys(o.attributes).reduce((e,t)=>(t in s&&s[t].mutable&&e.push({spec_id:+t,value:o.attributes[t]}),e),[])},!(o.frame+1 in n)&&o.frame+1<=this.stopFrame&&(n[o.frame+1]=JSON.parse(JSON.stringify(n[o.frame])),n[o.frame+1].outside=!0,n[o.frame+1].frame++)}else{if(!(o instanceof p))throw new k(`Trying to merge unknown object type: ${o.constructor.name}. `+"Only shapes and tracks are expected.");{const e={};for(const t of Object.keys(o.shapes)){const r=o.shapes[t];if(t in n&&!n[t].outside){if(r.outside)continue;throw new k("Expected only one visible shape per frame")}let s=!1;for(const t in r.attributes)t in e&&e[t]===r.attributes[t]||(s=!0,e[t]=r.attributes[t]);n[t]={type:i,frame:+t,points:[...r.points],occluded:r.occluded,outside:r.outside,zOrder:r.zOrder,attributes:s?Object.keys(e).reduce((t,n)=>(t.push({spec_id:+n,value:e[n]}),t),[]):[]}}}}}let a=!1;for(const e of Object.keys(n).sort((e,t)=>+e-+t)){if(a=a||n[e].outside,a||!n[e].outside)break;delete n[e]}const o=++this.count,c=T({frame:Math.min.apply(null,Object.keys(n).map(e=>+e)),shapes:Object.values(n),group:0,label_id:r.id,attributes:Object.keys(e[0].attributes).reduce((t,n)=>(s[n].mutable||t.push({spec_id:+n,value:e[0].attributes[n]}),t),[])},o,this.injection);this.tracks.push(c),this.objects[o]=c;for(const e of t)e.removed=!0;this.history.do(x.MERGED_OBJECTS,()=>{c.removed=!0;for(const e of t)e.removed=!1},()=>{c.removed=!1;for(const e of t)e.removed=!0},[...t.map(e=>e.clientID),c.clientID],e[0].frame)}split(e,t){y("object state",e,null,C),y("frame",t,"integer",null);const n=this.objects[e.clientID];if(void 0===n)throw new k("The object has not been saved yet. Call annotations.put([state]) before");if(e.objectType!==_.TRACK)return;const r=Object.keys(n.shapes).sort((e,t)=>+e-+t);if(t<=+r[0])return;const i=n.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{}),s=n.toJSON(),a={type:e.shapeType,points:[...e.points],occluded:e.occluded,outside:e.outside,zOrder:e.zOrder,attributes:Object.keys(e.attributes).reduce((t,n)=>(i[n].mutable||t.push({spec_id:+n,value:e.attributes[n]}),t),[]),frame:t},o={frame:s.frame,group:0,label_id:s.label_id,attributes:s.attributes,shapes:[]},c=JSON.parse(JSON.stringify(o));c.frame=t,c.shapes.push(JSON.parse(JSON.stringify(a))),s.shapes.map(e=>(delete e.id,e.frame<t?o.shapes.push(JSON.parse(JSON.stringify(e))):e.frame>t&&c.shapes.push(JSON.parse(JSON.stringify(e))),e)),o.shapes.push(a),o.shapes[o.shapes.length-1].outside=!0;let u=++this.count;const l=T(o,u,this.injection);this.tracks.push(l),this.objects[u]=l,u=++this.count;const h=T(c,u,this.injection);this.tracks.push(h),this.objects[u]=h,n.removed=!0,this.history.do(x.SPLITTED_TRACK,()=>{n.removed=!1,l.removed=!0,h.removed=!0},()=>{n.removed=!0,l.removed=!1,h.removed=!1},[n.clientID,l.clientID,h.clientID],t)}group(e,t){y("shapes for group",e,null,Array);const n=e.map(e=>{y("object state",e,null,C);const t=this.objects[e.clientID];if(void 0===t)throw new k("The object has not been saved yet. Call annotations.put([state]) before");return t}),r=t?0:++this.groups.max,i=n.map(e=>e.group);for(const e of n)e.group=r;const s=n.map(e=>e.group);return this.history.do(x.GROUPED_OBJECTS,()=>{n.forEach((e,t)=>{e.group=i[t]})},()=>{n.forEach((e,t)=>{e.group=s[t]})},n.map(e=>e.clientID),e[0].frame),r}clear(){this.shapes={},this.tags={},this.tracks=[],this.objects={},this.count=0,this.flush=!0}statistics(){const e={},t={rectangle:{shape:0,track:0},polygon:{shape:0,track:0},polyline:{shape:0,track:0},points:{shape:0,track:0},cuboid:{shape:0,track:0},tags:0,manually:0,interpolated:0,total:0},n=JSON.parse(JSON.stringify(t));for(const n of Object.values(this.labels)){const{name:r}=n;e[r]=JSON.parse(JSON.stringify(t))}for(const t of Object.values(this.objects)){if(t.removed)continue;let n=null;if(t instanceof f)n="shape";else if(t instanceof p)n="track";else{if(!(t instanceof d))throw new S(`Unexpected object type: "${n}"`);n="tag"}const r=t.label.name;if("tag"===n)e[r].tags++,e[r].manually++,e[r].total++;else{const{shapeType:i}=t;if(e[r][i][n]++,"track"===n){const n=Object.keys(t.shapes).sort((e,t)=>+e-+t).map(e=>+e);let i=n[0],s=!1;for(const a of n){if(s){const t=a-i-1;e[r].interpolated+=t,e[r].total+=t}s=!t.shapes[a].outside,i=a,s&&(e[r].manually++,e[r].total++)}const a=n[n.length-1];if(a!==this.stopFrame&&!t.shapes[a].outside){const t=this.stopFrame-a;e[r].interpolated+=t,e[r].total+=t}}else e[r].manually++,e[r].total++}}for(const t of Object.keys(e))for(const r of Object.keys(e[t]))if("object"==typeof e[t][r])for(const i of Object.keys(e[t][r]))n[r][i]+=e[t][r][i];else n[r]+=e[t][r];return new g(e,n)}put(e){y("shapes for put",e,null,Array);const t={shapes:[],tracks:[],tags:[]};function n(e,t){const n=+t,r=this.attributes[t];return y("attribute id",n,"integer",null),y("attribute value",r,"string",null),e.push({spec_id:n,value:r}),e}for(const r of e){y("object state",r,null,C),y("state client ID",r.clientID,"undefined",null),y("state frame",r.frame,"integer",null),y("state attributes",r.attributes,null,Object),y("state label",r.label,null,v);const e=Object.keys(r.attributes).reduce(n.bind(r),[]),i=r.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});if("tag"===r.objectType)t.tags.push({attributes:e,frame:r.frame,label_id:r.label.id,group:0});else{y("state occluded",r.occluded,"boolean",null),y("state points",r.points,null,Array),y("state zOrder",r.zOrder,"integer",null);for(const e of r.points)y("point coordinate",e,"number",null);if(!Object.values(O).includes(r.shapeType))throw new k("Object shape must be one of: "+`${JSON.stringify(Object.values(O))}`);if("shape"===r.objectType)t.shapes.push({attributes:e,frame:r.frame,group:0,label_id:r.label.id,occluded:r.occluded||!1,points:[...r.points],type:r.shapeType,z_order:r.zOrder});else{if("track"!==r.objectType)throw new k("Object type must be one of: "+`${JSON.stringify(Object.values(_))}`);t.tracks.push({attributes:e.filter(e=>!i[e.spec_id].mutable),frame:r.frame,group:0,label_id:r.label.id,shapes:[{attributes:e.filter(e=>i[e.spec_id].mutable),frame:r.frame,occluded:r.occluded||!1,outside:!1,points:[...r.points],type:r.shapeType,z_order:r.zOrder}]})}}}const r=this.import(t),i=r.tags.concat(r.tracks).concat(r.shapes);return this.history.do(x.CREATED_OBJECTS,()=>{i.forEach(e=>{e.removed=!0})},()=>{i.forEach(e=>{e.removed=!1})},i.map(e=>e.clientID),e[0].frame),i.map(e=>e.clientID)}select(e,t,n){y("shapes for select",e,null,Array),y("x coordinate",t,"number",null),y("y coordinate",n,"number",null);let r=null,i=null;for(const s of e){if(y("object state",s,null,C),s.outside||s.hidden||s.objectType===_.TAG)continue;const e=this.objects[s.clientID];if(void 0===e)throw new k("The object has not been saved yet. Call annotations.put([state]) before");const a=e.constructor.distance(s.points,t,n);null!==a&&(null===r||a<r)&&(r=a,i=s)}return{state:i,distance:r}}search(e,t,n){const[r,i]=this.annotationsFilter.toJSONQuery(e),s=Math.sign(n-t),a=r.flat(Number.MAX_SAFE_INTEGER).some(e=>e.match(/^width/)||e.match(/^height/)),o=(e,t)=>{let[n,r]=[e,t];for(;1!==Math.abs(n-r);){const e=r+Math.floor((n-r)/2),t=this.tracks.map(t=>t.get(e));this.annotationsFilter.filter(t,i).length?r=e:n=e}return r},c={},u=s>0?e=>e<=n:e=>e>=n,l=s>0?e=>e+1:e=>e-1;for(let e=t;u(e);e=l(e)){const r=[].concat((e in this.shapes?this.shapes[e]:[]).filter(e=>!e.removed).map(t=>t.get(e)),(e in this.tags?this.tags[e]:[]).filter(e=>!e.removed).map(t=>t.get(e))),u=Object.values(this.tracks).filter(r=>e in r.shapes||e===t||e===n).filter(e=>!e.removed);if(r.push(...u.map(t=>t.get(e)).filter(e=>!e.outside)),!r.length)continue;const l=this.annotationsFilter.filter(r,i);let h=!1;if(a)for(const t of u){l.includes(t.clientID)?c[t.clientID]&&!1===c[t.clientID][0]&&(h=!0):c[t.clientID]=[l.includes(t.clientID),e]}if(h){return o((s>0?Math.min:Math.max)(...Object.values(c).map(e=>e[1])),e)}if(l.length)return e}return null}}})()},function(e,t,n){(()=>{const t=n(13),{checkObjectType:r}=n(9),{colors:i,ObjectShape:s,ObjectType:a,AttributeType:o,HistoryActions:c}=n(2),{DataError:u,ArgumentError:l,ScriptingError:h}=n(0),{Label:p}=n(8);function f(e,n){const r=new t(n);return r.__internal={save:this.save.bind(this,e,r),delete:this.delete.bind(this)},r}function d(e,t){if(e===s.RECTANGLE){if(t.length/2!=2)throw new u(`Rectangle must have 2 points, but got ${t.length/2}`)}else if(e===s.POLYGON){if(t.length/2<3)throw new u(`Polygon must have at least 3 points, but got ${t.length/2}`)}else if(e===s.POLYLINE){if(t.length/2<2)throw new u(`Polyline must have at least 2 points, but got ${t.length/2}`)}else if(e===s.POINTS){if(t.length/2<1)throw new u(`Points must have at least 1 points, but got ${t.length/2}`)}else{if(e!==s.CUBOID)throw new l(`Unknown value of shapeType has been recieved ${e}`);if(t.length/2!=8)throw new u(`Points must have exact 8 points, but got ${t.length/2}`)}}function m(e,t){const{values:n}=t,r=t.inputType;if("string"!=typeof e)throw new l(`Attribute value is expected to be string, but got ${typeof e}`);return r===o.NUMBER?+e>=+n[0]&&+e<=+n[1]&&!((+e-+n[0])%+n[2]):r===o.CHECKBOX?["true","false"].includes(e.toLowerCase()):r===o.TEXT||n.includes(e)}class b{constructor(e,t,n,r){this.taskLabels=r.labels,this.history=r.history,this.groupColors=r.groupColors,this.clientID=t,this.serverID=e.id,this.group=e.group,this.label=this.taskLabels[e.label_id],this.frame=e.frame,this.removed=!1,this.lock=!1,this.color=n,this.updated=Date.now(),this.attributes=e.attributes.reduce((e,t)=>(e[t.spec_id]=t.value,e),{}),this.groupObject=Object.defineProperties({},{color:{get:()=>this.group?this.groupColors[this.group]||i[this.group%i.length]:"#E0E0E0",set:e=>{this.group&&"string"==typeof e&&/^#[0-9A-F]{6}$/i.test(e)&&(this.groupColors[this.group]=e)}},id:{get:()=>this.group}}),this.appendDefaultAttributes(this.label),r.groups.max=Math.max(r.groups.max,this.group)}_saveLock(e,t){const n=this.lock,r=e;this.history.do(c.CHANGED_LOCK,()=>{this.lock=n,this.updated=Date.now()},()=>{this.lock=r,this.updated=Date.now()},[this.clientID],t),this.lock=e}_saveColor(e,t){const n=this.color,r=e;this.history.do(c.CHANGED_COLOR,()=>{this.color=n,this.updated=Date.now()},()=>{this.color=r,this.updated=Date.now()},[this.clientID],t),this.color=e}_saveHidden(e,t){const n=this.hidden,r=e;this.history.do(c.CHANGED_HIDDEN,()=>{this.hidden=n,this.updated=Date.now()},()=>{this.hidden=r,this.updated=Date.now()},[this.clientID],t),this.hidden=e}_saveLabel(e,t){const n=this.label,r=e,i={...this.attributes};this.label=e,this.attributes={},this.appendDefaultAttributes(e);const s={...this.attributes};this.history.do(c.CHANGED_LABEL,()=>{this.label=n,this.attributes=i,this.updated=Date.now()},()=>{this.label=r,this.attributes=s,this.updated=Date.now()},[this.clientID],t)}_saveAttributes(e,t){const n={...this.attributes};for(const t of Object.keys(e))this.attributes[t]=e[t];const r={...this.attributes};this.history.do(c.CHANGED_ATTRIBUTES,()=>{this.attributes=n,this.updated=Date.now()},()=>{this.attributes=r,this.updated=Date.now()},[this.clientID],t)}_validateStateBeforeSave(e,t,n){let i=[];n.label&&r("label",t.label,null,p);const a=t.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});if(n.attributes)for(const e of Object.keys(t.attributes)){const n=t.attributes[e];if(!(e in a))throw new l(`The label of the shape doesn't have the attribute with id ${e} and value ${n}`);if(!m(n,a[e]))throw new l(`Trying to save an attribute attribute with id ${e} and invalid value ${n}`)}if(n.points){r("points",t.points,null,Array),d(this.shapeType,t.points);const{width:n,height:a}=this.frameMeta[e];i=function(e,t,n,i){const a=[];for(let e=0;e<t.length-1;e+=2){const s=t[e],o=t[e+1];r("coordinate",s,"number",null),r("coordinate",o,"number",null),a.push(Math.clamp(s,0,n),Math.clamp(o,0,i))}return e===s.CUBOID?t:a}(this.shapeType,t.points,n,a),function(e,t){if(e===s.POINTS)return!0;let n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(let e=0;e<t.length-1;e+=2)n=Math.min(n,t[e]),r=Math.max(r,t[e]),i=Math.min(i,t[e+1]),a=Math.max(a,t[e+1]);if(e===s.POLYLINE){return Math.max(r-n,a-i)>=3}return(r-n)*(a-i)>=9}(this.shapeType,i)&&!function(e,t,n){let r=!1;for(let i=0;i<e.length-1;i+=2){const[s,a]=e.slice(i);r=r||s>=0&&s<=t&&a>=0&&a<=n}return!r}(i,n,a)||(i=[])}if(n.occluded&&r("occluded",t.occluded,"boolean",null),n.outside&&r("outside",t.outside,"boolean",null),n.zOrder&&r("zOrder",t.zOrder,"integer",null),n.lock&&r("lock",t.lock,"boolean",null),n.pinned&&r("pinned",t.pinned,"boolean",null),n.color&&(r("color",t.color,"string",null),!/^#[0-9A-F]{6}$/i.test(t.color)))throw new l(`Got invalid color value: "${t.color}"`);if(n.hidden&&r("hidden",t.hidden,"boolean",null),n.keyframe&&(r("keyframe",t.keyframe,"boolean",null),!this.shapes||1===Object.keys(this.shapes).length&&!t.keyframe))throw new l("Can not remove the latest keyframe of an object. Consider removing the object instead");return i}appendDefaultAttributes(e){const t=e.attributes;for(const e of t)e.id in this.attributes||(this.attributes[e.id]=e.defaultValue)}updateTimestamp(e){(e.label||e.attributes||e.points||e.outside||e.occluded||e.keyframe||e.zOrder||e.hidden||e.lock||e.pinned)&&(this.updated=Date.now())}delete(e,t){return this.lock&&!t||(this.removed=!0,this.history.do(c.REMOVED_OBJECT,()=>{this.serverID=void 0,this.removed=!1,this.updated=Date.now()},()=>{this.removed=!0,this.updated=Date.now()},[this.clientID],e)),this.removed}}class y extends b{constructor(e,t,n,r){super(e,t,n,r),this.frameMeta=r.frameMeta,this.hidden=!1,this.pinned=!0,this.shapeType=null}_savePinned(e,t){const n=this.pinned,r=e;this.history.do(c.CHANGED_PINNED,()=>{this.pinned=n,this.updated=Date.now()},()=>{this.pinned=r,this.updated=Date.now()},[this.clientID],t),this.pinned=e}save(){throw new h("Is not implemented")}get(){throw new h("Is not implemented")}toJSON(){throw new h("Is not implemented")}}class g extends y{constructor(e,t,n,r){super(e,t,n,r),this.points=e.points,this.occluded=e.occluded,this.zOrder=e.z_order}toJSON(){return{type:this.shapeType,clientID:this.clientID,occluded:this.occluded,z_order:this.zOrder,points:[...this.points],attributes:Object.keys(this.attributes).reduce((e,t)=>(e.push({spec_id:t,value:this.attributes[t]}),e),[]),id:this.serverID,frame:this.frame,label_id:this.label.id,group:this.group}}get(e){if(e!==this.frame)throw new h("Got frame is not equal to the frame of the shape");return{objectType:a.SHAPE,shapeType:this.shapeType,clientID:this.clientID,serverID:this.serverID,occluded:this.occluded,lock:this.lock,zOrder:this.zOrder,points:[...this.points],attributes:{...this.attributes},label:this.label,group:this.groupObject,color:this.color,hidden:this.hidden,updated:this.updated,pinned:this.pinned,frame:e}}_savePoints(e,t){const n=this.points,r=e;this.history.do(c.CHANGED_POINTS,()=>{this.points=n,this.updated=Date.now()},()=>{this.points=r,this.updated=Date.now()},[this.clientID],t),this.points=e}_saveOccluded(e,t){const n=this.occluded,r=e;this.history.do(c.CHANGED_OCCLUDED,()=>{this.occluded=n,this.updated=Date.now()},()=>{this.occluded=r,this.updated=Date.now()},[this.clientID],t),this.occluded=e}_saveZOrder(e,t){const n=this.zOrder,r=e;this.history.do(c.CHANGED_ZORDER,()=>{this.zOrder=n,this.updated=Date.now()},()=>{this.zOrder=r,this.updated=Date.now()},[this.clientID],t),this.zOrder=e}save(e,t){if(e!==this.frame)throw new h("Got frame is not equal to the frame of the shape");if(this.lock&&t.lock)return f.call(this,e,this.get(e));const n=t.updateFlags,r=this._validateStateBeforeSave(e,t,n);return n.label&&this._saveLabel(t.label,e),n.attributes&&this._saveAttributes(t.attributes,e),n.points&&r.length&&this._savePoints(r,e),n.occluded&&this._saveOccluded(t.occluded,e),n.zOrder&&this._saveZOrder(t.zOrder,e),n.lock&&this._saveLock(t.lock,e),n.pinned&&this._savePinned(t.pinned,e),n.color&&this._saveColor(t.color,e),n.hidden&&this._saveHidden(t.hidden,e),this.updateTimestamp(n),n.reset(),f.call(this,e,this.get(e))}}class v extends y{constructor(e,t,n,r){super(e,t,n,r),this.shapes=e.shapes.reduce((e,t)=>(e[t.frame]={serverID:t.id,occluded:t.occluded,zOrder:t.z_order,points:t.points,outside:t.outside,attributes:t.attributes.reduce((e,t)=>(e[t.spec_id]=t.value,e),{})},e),{})}toJSON(){const e=this.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});return{clientID:this.clientID,id:this.serverID,frame:this.frame,label_id:this.label.id,group:this.group,attributes:Object.keys(this.attributes).reduce((t,n)=>(e[n].mutable||t.push({spec_id:n,value:this.attributes[n]}),t),[]),shapes:Object.keys(this.shapes).reduce((t,n)=>(t.push({type:this.shapeType,occluded:this.shapes[n].occluded,z_order:this.shapes[n].zOrder,points:[...this.shapes[n].points],outside:this.shapes[n].outside,attributes:Object.keys(this.shapes[n].attributes).reduce((t,r)=>(e[r].mutable&&t.push({spec_id:r,value:this.shapes[n].attributes[r]}),t),[]),id:this.shapes[n].serverID,frame:+n}),t),[])}}get(e){const{prev:t,next:n,first:r,last:i}=this.boundedKeyframes(e);return{...this.getPosition(e,t,n),attributes:this.getAttributes(e),group:this.groupObject,objectType:a.TRACK,shapeType:this.shapeType,clientID:this.clientID,serverID:this.serverID,lock:this.lock,color:this.color,hidden:this.hidden,updated:this.updated,label:this.label,pinned:this.pinned,keyframes:{prev:t,next:n,first:r,last:i},frame:e}}boundedKeyframes(e){const t=Object.keys(this.shapes).map(e=>+e);let n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const a of t){a<i&&(i=a),a>s&&(s=a);const t=Math.abs(e-a);a<e&&t<n?n=t:a>e&&t<r&&(r=t)}return{prev:n===Number.MAX_SAFE_INTEGER?null:e-n,next:r===Number.MAX_SAFE_INTEGER?null:e+r,first:i,last:s}}getAttributes(e){const t={};for(const e in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,e)&&(t[e]=this.attributes[e]);const n=Object.keys(this.shapes).sort((e,t)=>+e-+t);for(const r of n)if(r<=e){const{attributes:e}=this.shapes[r];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}_saveLabel(e,t){const n=this.label,r=e,i={unmutable:{...this.attributes},mutable:Object.keys(this.shapes).map(e=>({frame:+e,attributes:{...this.shapes[e].attributes}}))};this.label=e,this.attributes={};for(const e of Object.values(this.shapes))e.attributes={};this.appendDefaultAttributes(e);const s={unmutable:{...this.attributes},mutable:Object.keys(this.shapes).map(e=>({frame:+e,attributes:{...this.shapes[e].attributes}}))};this.history.do(c.CHANGED_LABEL,()=>{this.label=n,this.attributes=i.unmutable;for(const e of i.mutable)this.shapes[e.frame].attributes=e.attributes;this.updated=Date.now()},()=>{this.label=r,this.attributes=s.unmutable;for(const e of s.mutable)this.shapes[e.frame].attributes=e.attributes;this.updated=Date.now()},[this.clientID],t)}_saveAttributes(e,t){const n=this.get(t),r=this.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{}),i=t in this.shapes,s=this.attributes,a=i?this.shapes[t]:void 0;let o=!1;const u={...this.attributes};for(const i of Object.keys(e))r[i].mutable?e[i]!==n.attributes[i]&&(o=o||!(t in this.shapes)||!(i in this.shapes[t].attributes)||this.shapes[t].attributes[i]!==e[i]):u[i]=e[i];let l;o&&(l=i?{...this.shapes[t],attributes:{...this.shapes[t].attributes}}:{frame:t,zOrder:n.zOrder,points:n.points,outside:n.outside,occluded:n.occluded,attributes:{}});for(const t of Object.keys(e))r[t].mutable&&e[t]!==n.attributes[t]&&(l.attributes[t]=e[t]);this.attributes=u,l&&(this.shapes[t]=l),this.history.do(c.CHANGED_ATTRIBUTES,()=>{this.attributes=s,a?this.shapes[t]=a:l&&delete this.shapes[t],this.updated=Date.now()},()=>{this.attributes=u,l&&(this.shapes[t]=l),this.updated=Date.now()},[this.clientID],t)}_appendShapeActionToHistory(e,t,n,r){this.history.do(e,()=>{n?this.shapes[t]=n:delete this.shapes[t],this.updated=Date.now()},()=>{r?this.shapes[t]=r:delete this.shapes[t],this.updated=Date.now()},[this.clientID],t)}_savePoints(e,t){const n=this.get(t),r=t in this.shapes,i=r?this.shapes[t]:void 0,s=r?{...this.shapes[t],points:e}:{frame:t,points:e,zOrder:n.zOrder,outside:n.outside,occluded:n.occluded,attributes:{}};this.shapes[t]=s,this._appendShapeActionToHistory(c.CHANGED_POINTS,t,i,s)}_saveOutside(e,t){const n=this.get(e),r=e in this.shapes,i=r?this.shapes[e]:void 0,s=r?{...this.shapes[e],outside:t}:{frame:e,outside:t,zOrder:n.zOrder,points:n.points,occluded:n.occluded,attributes:{}};this.shapes[e]=s,this._appendShapeActionToHistory(c.CHANGED_OUTSIDE,e,i,s)}_saveOccluded(e,t){const n=this.get(t),r=t in this.shapes,i=r?this.shapes[t]:void 0,s=r?{...this.shapes[t],occluded:e}:{frame:t,occluded:e,zOrder:n.zOrder,points:n.points,outside:n.outside,attributes:{}};this.shapes[t]=s,this._appendShapeActionToHistory(c.CHANGED_OCCLUDED,t,i,s)}_saveZOrder(e,t){const n=this.get(t),r=t in this.shapes,i=r?this.shapes[t]:void 0,s=r?{...this.shapes[t],zOrder:e}:{frame:t,zOrder:e,occluded:n.occluded,points:n.points,outside:n.outside,attributes:{}};this.shapes[t]=s,this._appendShapeActionToHistory(c.CHANGED_ZORDER,t,i,s)}_saveKeyframe(e,t){const n=this.get(e),r=e in this.shapes;if(t&&r||!t&&!r)return;const i=r?this.shapes[e]:void 0,s=t?{frame:e,zOrder:n.zOrder,points:n.points,outside:n.outside,occluded:n.occluded,attributes:{}}:void 0;s?this.shapes[e]=s:delete this.shapes[e],this._appendShapeActionToHistory(c.CHANGED_KEYFRAME,e,i,s)}save(e,t){if(this.lock&&t.lock)return f.call(this,e,this.get(e));const n=t.updateFlags,r=this._validateStateBeforeSave(e,t,n);return n.label&&this._saveLabel(t.label,e),n.lock&&this._saveLock(t.lock,e),n.pinned&&this._savePinned(t.pinned,e),n.color&&this._saveColor(t.color,e),n.hidden&&this._saveHidden(t.hidden,e),n.points&&r.length&&this._savePoints(r,e),n.outside&&this._saveOutside(e,t.outside),n.occluded&&this._saveOccluded(t.occluded,e),n.zOrder&&this._saveZOrder(t.zOrder,e),n.attributes&&this._saveAttributes(t.attributes,e),n.keyframe&&this._saveKeyframe(e,t.keyframe),this.updateTimestamp(n),n.reset(),f.call(this,e,this.get(e))}getPosition(e,t,n){const r=e in this.shapes?e:t,i=Number.isInteger(n)?this.shapes[n]:null,s=Number.isInteger(r)?this.shapes[r]:null;if(s&&i)return{...this.interpolatePosition(s,i,(e-r)/(n-r)),keyframe:e in this.shapes};if(s)return{points:[...s.points],occluded:s.occluded,outside:s.outside,zOrder:s.zOrder,keyframe:e in this.shapes};if(i)return{points:[...i.points],occluded:i.occluded,outside:!0,zOrder:i.zOrder,keyframe:e in this.shapes};throw new u("No one left position or right position was found. "+`Interpolation impossible. Client ID: ${this.clientID}`)}}class w extends g{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.RECTANGLE,this.pinned=!1,d(this.shapeType,this.points)}static distance(e,t,n){const[r,i,s,a]=e;return t>=r&&t<=s&&n>=i&&n<=a?Math.min.apply(null,[t-r,n-i,s-t,a-n]):null}}class k extends g{constructor(e,t,n,r){super(e,t,n,r)}}class S extends k{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.POLYGON,d(this.shapeType,this.points)}static distance(e,t,n){function r(e,r,i,s){return(i-e)*(n-r)-(t-e)*(s-r)}let i=0;const s=[];for(let a=0,o=e.length-2;a<e.length-1;o=a,a+=2){const c=e[o],u=e[o+1],l=e[a],h=e[a+1];u<=n?h>n&&r(c,u,l,h)>0&&i++:h<=n&&r(c,u,l,h)<0&&i--;const p=t-(u-h),f=n-(l-c);(p-c)*(l-p)>=0&&(f-u)*(h-f)>=0?s.push(Math.sqrt(Math.pow(t-p,2)+Math.pow(n-f,2))):s.push(Math.min(Math.sqrt(Math.pow(c-t,2)+Math.pow(u-n,2)),Math.sqrt(Math.pow(l-t,2)+Math.pow(h-n,2))))}return 0!==i?Math.min.apply(null,s):null}}class x extends k{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.POLYLINE,d(this.shapeType,this.points)}static distance(e,t,n){const r=[];for(let i=0;i<e.length-2;i+=2){const s=e[i],a=e[i+1],o=e[i+2],c=e[i+3];(t-s)*(o-t)>=0&&(n-a)*(c-n)>=0?r.push(Math.abs((c-a)*t-(o-s)*n+o*a-c*s)/Math.sqrt(Math.pow(c-a,2)+Math.pow(o-s,2))):r.push(Math.min(Math.sqrt(Math.pow(s-t,2)+Math.pow(a-n,2)),Math.sqrt(Math.pow(o-t,2)+Math.pow(c-n,2))))}return Math.min.apply(null,r)}}class O extends k{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.POINTS,d(this.shapeType,this.points)}static distance(e,t,n){const r=[];for(let i=0;i<e.length;i+=2){const s=e[i],a=e[i+1];r.push(Math.sqrt(Math.pow(s-t,2)+Math.pow(a-n,2)))}return Math.min.apply(null,r)}}class _ extends k{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.CUBOID,this.pinned=!1,d(this.shapeType,this.points)}static makeHull(e){const t=e.slice();return t.sort((function(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0})),function(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n+=1){const r=e[`${n}`];for(;t.length>=2;){const e=t[t.length-1],n=t[t.length-2];if(!((e.x-n.x)*(r.y-n.y)>=(e.y-n.y)*(r.x-n.x)))break;t.pop()}t.push(r)}t.pop();const n=[];for(let t=e.length-1;t>=0;t-=1){const r=e[`${t}`];for(;n.length>=2;){const e=n[n.length-1],t=n[n.length-2];if(!((e.x-t.x)*(r.y-t.y)>=(e.y-t.y)*(r.x-t.x)))break;n.pop()}n.push(r)}return n.pop(),1===t.length&&1===n.length&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}(t)}static contain(e,t,n){function r(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}e=_.makeHull(e);let i=0;for(let s=0;s<e.length;s+=1){const a=e[`${s}`],o=e[s+1]||e[0];a.y<=n?o.y>n&&r(a,o,{x:t,y:n})>0&&(i+=1):o.y<n&&r(a,o,{x:t,y:n})<0&&(i-=1)}return 0!==i}static distance(e,t,n){const r=[];for(let t=0;t<16;t+=2)r.push({x:e[t],y:e[t+1]});if(!_.contain(r,t,n))return null;let i=Number.MAX_SAFE_INTEGER;for(let e=0;e<r.length;e+=1){const s=r[`${e}`],a=r[e+1]||r[0],o=Math.abs((a.y-s.y)*t-(a.x-s.x)*n+a.x*s.y-a.y*s.x)/Math.sqrt(Math.pow(a.y-s.y,2)+Math.pow(a.x-s.x,2)),c=Math.pow(s.x-t,2)+Math.pow(s.y-n,2),u=Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2),l=Math.pow(a.x-t,2)+Math.pow(a.y-n,2);o<i&&c+u-l>=0&&l+u-c>=0&&(i=o)}return i}}class E extends v{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.RECTANGLE,this.pinned=!1;for(const e of Object.values(this.shapes))d(this.shapeType,e.points)}interpolatePosition(e,t,n){const r=e.points.map((e,n)=>t.points[n]-e);return{points:e.points.map((e,t)=>e+r[t]*n),occluded:e.occluded,outside:e.outside,zOrder:e.zOrder}}}class C extends v{constructor(e,t,n,r){super(e,t,n,r)}interpolatePosition(e,t,n){function r(e){let t=Number.MAX_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(let s=0;s<e.length;s+=2)e[s]<t&&(t=e[s]),e[s+1]<n&&(n=e[s+1]),e[s]>r&&(r=e[s]),e[s+1]>i&&(i=e[s+1]);return{xmin:t,ymin:n,xmax:r,ymax:i}}function i(e,t){const n=[],r=t.xmax-t.xmin,i=t.ymax-t.ymin;for(let s=0;s<e.length;s+=2)n.push((e[s]-t.xmin)/r,(e[s+1]-t.ymin)/i);return n}function s(e,t){const n=[],r=t.xmax-t.xmin,i=t.ymax-t.ymin;for(let s=0;s<e.length;s+=2)n.push(e[s]*r+t.xmin,e[s+1]*i+t.ymin);return n}function a(e){const t=[];for(let n=0;n<e.length;n+=2)t.push({x:e[n],y:e[n+1]});return t}function o(e){const t=[];for(const n of e)t.push(n.x,n.y);return t}function c(e,t){function n(e){let t=0;for(let n=1;n<e.length;n+=2){t+=Math.sqrt(Math.pow(e[n].x-e[n-1].x,2)+Math.pow(e[n].y-e[n-1].y,2))}return t||Number.MAX_SAFE_INTEGER}function r(e,t){let n=0;for(let r=1;r<e.length;r+=2){const i=Math.sqrt(Math.pow(e[r].x-e[r-1].x,2)+Math.pow(e[r].y-e[r-1].y,2));n+=Math.pow(i-t,2)}return n}const i=[],s=[],a=function(e,t){const n={};for(let r=0;r<e.length;r++){n[r]=n[r]||{};for(let i=0;i<t.length;i++){const s=e[r].x-t[i].x,a=e[r].y-t[i].y;n[r][i]=Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}return n}(e,t),o=function(e,t,n){const r={};for(const i of e)r[i]=t.concat().sort((e,t)=>n[i][e]-n[i][t]);const i={},s={};let a=0;for(;Object.values(s).length!==e.length;){for(const t of e){if(s[t])continue;const e=r[t][a],o=n[t][e];if(e in i&&i[e].distance>o){const t=i[e].value;delete i[e],delete s[t]}e in i||(i[e]={value:t,distance:o},s[t]=!0)}a++}const o={};for(const e of Object.keys(i))o[i[e].value]={value:e,distance:i[e].distance};return o}(Array.from(e.keys()),Array.from(t.keys()),a),c=(n(t)+n(e))/(t.length+e.length);!function(e,t){for(const n of Object.keys(e))e[n].distance>t&&delete e[n]}(o,c+3*Math.sqrt((r(e,c)+r(t,c))/(e.length+t.length)));for(const e of Object.keys(o))o[e]=o[e].value;const u=this.appendMapping(o,e,t);for(const n of u)i.push(e[n]),s.push(t[o[n]]);return[i,s]}if(0===n)return{points:[...e.points],occluded:e.occluded,outside:e.outside,zOrder:e.zOrder};let u=r(e.points),l=r(t.points);(u.xmax-u.xmin<1||l.ymax-l.ymin<1)&&(u={xmin:0,xmax:1024,ymin:0,ymax:768},l=u);const h=a(i(e.points,u)),p=a(i(t.points,l));let f=[],d=[];if(h.length>p.length){const[e,t]=c.call(this,p,h);f=t,d=e}else{const[e,t]=c.call(this,h,p);f=e,d=t}const m=s(o(f),u),b=s(o(d),l),y=[];for(let e=0;e<m.length;e++)y.push(m[e]+(b[e]-m[e])*n);return{points:y,occluded:e.occluded,outside:e.outside,zOrder:e.zOrder}}appendMapping(e,t,n){const r=Object.values(e).map(e=>+e),i=Object.keys(e).map(e=>+e),s=[];function a(e){let t=e,i=e;if(!r.length)throw new h("Interpolation mapping is empty");for(;!r.includes(t);)t--,t<0&&(t=n.length-1);for(;!r.includes(i);)i++,i>=n.length&&(i=0);return[t,i]}function o(e,t,r){const i=[];for(;t!==r;)i.push(n[t]),++t>=n.length&&(t=0);i.push(n[r]);let s=0,a=0,o=!1;for(let t=1;t<i.length;t++){const r=i[t],c=i[t-1],u=Math.sqrt(Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2));o||(a+=u),s+=u,n[e]===i[t]&&(o=!0)}return s?a/s:0}for(let c=0;c<n.length;c++){const u=r.indexOf(c);if(-1===u){const[r,i]=a(c),u=o(c,r,i),l=n[r],h=n[i],p={x:l.x+(h.x-l.x)*u,y:l.y+(h.y-l.y)*u};t.push(p),e[t.length-1]=c,s.push(t.length-1)}else s.push(i[u])}return s}}class j extends C{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.POLYGON;for(const e of Object.values(this.shapes))d(this.shapeType,e.points)}}class T extends C{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.POLYLINE;for(const e of Object.values(this.shapes))d(this.shapeType,e.points)}}class I extends C{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.POINTS;for(const e of Object.values(this.shapes))d(this.shapeType,e.points)}}class A extends C{constructor(e,t,n,r){super(e,t,n,r),this.shapeType=s.CUBOID,this.pinned=!1;for(const e of Object.values(this.shapes))d(this.shapeType,e.points)}}E.distance=w.distance,j.distance=S.distance,T.distance=x.distance,I.distance=O.distance,A.distance=_.distance,A.interpolatePosition=E.interpolatePosition,e.exports={RectangleShape:w,PolygonShape:S,PolylineShape:x,PointsShape:O,CuboidShape:_,RectangleTrack:E,PolygonTrack:j,PolylineTrack:T,PointsTrack:I,CuboidTrack:A,Track:v,Shape:g,Tag:class extends b{constructor(e,t,n,r){super(e,t,n,r)}toJSON(){return{clientID:this.clientID,id:this.serverID,frame:this.frame,label_id:this.label.id,group:this.group,attributes:Object.keys(this.attributes).reduce((e,t)=>(e.push({spec_id:t,value:this.attributes[t]}),e),[])}}get(e){if(e!==this.frame)throw new h("Got frame is not equal to the frame of the shape");return{objectType:a.TAG,clientID:this.clientID,serverID:this.serverID,lock:this.lock,attributes:{...this.attributes},label:this.label,group:this.groupObject,color:this.color,updated:this.updated,frame:e}}save(e,t){if(e!==this.frame)throw new h("Got frame is not equal to the frame of the tag");if(this.lock&&t.lock)return f.call(this,e,this.get(e));const n=t.updateFlags;return this._validateStateBeforeSave(e,t,n),n.label&&this._saveLabel(t.label,e),n.attributes&&this._saveAttributes(t.attributes,e),n.lock&&this._saveLock(t.lock,e),n.color&&this._saveColor(t.color,e),this.updateTimestamp(n),n.reset(),f.call(this,e,this.get(e))}},objectStateFactory:f}})()},function(e,t,n){const r=n(73),{AttributeType:i,ObjectType:s}=n(2),{ArgumentError:a}=n(0);e.exports=class{constructor(){this.operatorRegex=/(==|!=|<=|>=|>|<)(?=(?:[^"]*(["])[^"]*\2)*[^"]*$)/g}_splitWithOperator(e,t){const n=["|","&"],r=[];let i=0,s=!1,a=-1;for(let e=0;e<t.length;e++)if('"'===t[e]&&(s=!s),s||"("!==t[e]||i++,s||")"!==t[e]||i--,n.includes(t[e])&&!i){const n=t.substr(a+1,e-a-1).trim();r.push(n),r.push(t[e]),a=e}const o=t.substr(a+1).trim();r.push(o),r.forEach(t=>{"|"===t||"&"===t?e.push(t):this._groupByBrackets(e,t)})}_groupByBrackets(e,t){t.startsWith("(")&&t.endsWith(")")||e.push(t);let n=0,r=null,i=null,s=!1;for(let a=0;a<t.length;a++)if('"'===t[a]&&(s=!s),s||"("!==t[a]||(n++,null===r&&(r=a)),!s&&")"===t[a]&&(n--,!n)){i=a;const n=[],s=t.substr(r+1,i-1-r);this._splitWithOperator(n,s),e.push(n),r=null,i=null}if(null!==r)throw Error("Extra opening bracket found");if(null!==i)throw Error("Extra closing bracket found")}_parse(e){this._splitWithOperator([],e)}_join(e){let t="";for(const n of e)if(Array.isArray(n))t+=`(${this._join(n)})`;else if("string"==typeof n)if("|"===n||"&"===n)t+=n;else{let[e,r,,i]=n.split(this.operatorRegex);e=`@.${e.trim()}`,r=r.trim(),i=i.trim(),("width"===i||"height"===i||i.startsWith("attr"))&&(i=`@.${i}`),t+=[e,r,i].join("")}return t}_convertObjects(e){return{objects:e.map(e=>{const t=e.label.attributes.reduce((e,t)=>(e[t.id]=t,e),{});let n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,[c,u]=[null,null];e.objectType!==s.TAG&&(e.points.forEach((e,t)=>{t%2?(a=Math.min(a,e),o=Math.max(o,e)):(n=Math.min(n,e),r=Math.max(r,e))}),[c,u]=[r-n,o-a]);const l={};return Object.keys(e.attributes).reduce((n,r)=>{const s=t[r];let a=e.attributes[r].replace(/\\"/g,"`");return s.inputType===i.NUMBER?a=+a:s.inputType===i.CHECKBOX&&(a="true"===a),n[s.name]=a,n},l),{width:c,height:u,attr:l,label:e.label.name.replace(/\\"/g,"`"),serverID:e.serverID,clientID:e.clientID,type:e.objectType,shape:e.shapeType,occluded:e.occluded}})}}toJSONQuery(e){try{if(!Array.isArray(e)||e.some(e=>"string"!=typeof e))throw Error("Argument must be an array of strings");if(!e.length)return[[],"$.objects[*].clientID"];const t=[],n=e.map(e=>`(${e})`).join("|").replace(/\\"/g,"`");return this._splitWithOperator(t,n),[t,`$.objects[?(${this._join(t)})].clientID`]}catch(e){throw new a(`Wrong filter expression. ${e.toString()}`)}}filter(e,t){try{const n=this._convertObjects(e);return r.query(n,t)}catch(e){throw new a(`Could not apply the filter. ${e.toString()}`)}}}},function(e,t,n){(function(t){e.exports=function e(t,n,r){function i(a,o){if(!n[a]){if(!t[a]){if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){var n=t[a][1][e];return i(n||e)}),u,u.exports,e,t,n,r)}return n[a].exports}for(var s=!1,a=0;a<r.length;a++)i(r[a]);return i}({"./aesprim":[function(e,t,n){!function(e,t){"use strict";t(void 0!==n?n:e.esprima={})}(this,(function(e){"use strict";var t,n,r,i,s,a,o,c,u,l,h,p,f,d,m,b,y,g;function v(e,t){if(!e)throw new Error("ASSERT: "+t)}function w(e){return e>=48&&e<=57}function k(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function S(e){return"01234567".indexOf(e)>=0}function x(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function O(e){return 10===e||13===e||8232===e||8233===e}function _(e){return 64==e||36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&o.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function E(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&o.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function C(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function j(e){return"eval"===e||"arguments"===e}function T(e,t,n,r,i){var s;v("number"==typeof n,"Comment must have valid position"),y.lastCommentStart>=n||(y.lastCommentStart=n,s={type:e,value:t},g.range&&(s.range=[n,r]),g.loc&&(s.loc=i),g.comments.push(s),g.attachComment&&(g.leadingComments.push(s),g.trailingComments.push(s)))}function I(e){var t,n,r,i;for(t=h-e,n={start:{line:p,column:h-f-e}};h<d;)if(r=u.charCodeAt(h),++h,O(r))return g.comments&&(i=u.slice(t+e,h-1),n.end={line:p,column:h-f-1},T("Line",i,t,h-1,n)),13===r&&10===u.charCodeAt(h)&&++h,++p,void(f=h);g.comments&&(i=u.slice(t+e,h),n.end={line:p,column:h-f},T("Line",i,t,h,n))}function A(){var e,t,n,r;for(g.comments&&(e=h-2,t={start:{line:p,column:h-f-2}});h<d;)if(O(n=u.charCodeAt(h)))13===n&&10===u.charCodeAt(h+1)&&++h,++p,++h,f=h,h>=d&&J({},a.UnexpectedToken,"ILLEGAL");else if(42===n){if(47===u.charCodeAt(h+1))return++h,++h,void(g.comments&&(r=u.slice(e+2,h-2),t.end={line:p,column:h-f},T("Block",r,e,h,t)));++h}else++h;J({},a.UnexpectedToken,"ILLEGAL")}function P(){var e,t;for(t=0===h;h<d;)if(x(e=u.charCodeAt(h)))++h;else if(O(e))++h,13===e&&10===u.charCodeAt(h)&&++h,++p,f=h,t=!0;else if(47===e)if(47===(e=u.charCodeAt(h+1)))++h,++h,I(2),t=!0;else{if(42!==e)break;++h,++h,A()}else if(t&&45===e){if(45!==u.charCodeAt(h+1)||62!==u.charCodeAt(h+2))break;h+=3,I(3)}else{if(60!==e)break;if("!--"!==u.slice(h+1,h+4))break;++h,++h,++h,++h,I(4)}}function N(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t){if(!(h<d&&k(u[h])))return"";r=u[h++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())}return String.fromCharCode(i)}function D(){var e,t;for(e=u.charCodeAt(h++),t=String.fromCharCode(e),92===e&&(117!==u.charCodeAt(h)&&J({},a.UnexpectedToken,"ILLEGAL"),++h,(e=N("u"))&&"\\"!==e&&_(e.charCodeAt(0))||J({},a.UnexpectedToken,"ILLEGAL"),t=e);h<d&&E(e=u.charCodeAt(h));)++h,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==u.charCodeAt(h)&&J({},a.UnexpectedToken,"ILLEGAL"),++h,(e=N("u"))&&"\\"!==e&&E(e.charCodeAt(0))||J({},a.UnexpectedToken,"ILLEGAL"),t+=e);return t}function R(){var e,n;return e=h,{type:1===(n=92===u.charCodeAt(h)?D():function(){var e,t;for(e=h++;h<d;){if(92===(t=u.charCodeAt(h)))return h=e,D();if(!E(t))break;++h}return u.slice(e,h)}()).length?t.Identifier:function(e){if(l&&C(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}(n)?t.Keyword:"null"===n?t.NullLiteral:"true"===n||"false"===n?t.BooleanLiteral:t.Identifier,value:n,lineNumber:p,lineStart:f,start:e,end:h}}function F(){var e,n,r,i,s=h,o=u.charCodeAt(h),c=u[h];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++h,g.tokenize&&(40===o?g.openParenToken=g.tokens.length:123===o&&(g.openCurlyToken=g.tokens.length)),{type:t.Punctuator,value:String.fromCharCode(o),lineNumber:p,lineStart:f,start:s,end:h};default:if(61===(e=u.charCodeAt(h+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return h+=2,{type:t.Punctuator,value:String.fromCharCode(o)+String.fromCharCode(e),lineNumber:p,lineStart:f,start:s,end:h};case 33:case 61:return h+=2,61===u.charCodeAt(h)&&++h,{type:t.Punctuator,value:u.slice(s,h),lineNumber:p,lineStart:f,start:s,end:h}}}return">>>="===(i=u.substr(h,4))?{type:t.Punctuator,value:i,lineNumber:p,lineStart:f,start:s,end:h+=4}:">>>"===(r=i.substr(0,3))||"<<="===r||">>="===r?{type:t.Punctuator,value:r,lineNumber:p,lineStart:f,start:s,end:h+=3}:c===(n=r.substr(0,2))[1]&&"+-<>&|".indexOf(c)>=0||"=>"===n?{type:t.Punctuator,value:n,lineNumber:p,lineStart:f,start:s,end:h+=2}:"<>=!+-*%&|^/".indexOf(c)>=0?(++h,{type:t.Punctuator,value:c,lineNumber:p,lineStart:f,start:s,end:h}):void J({},a.UnexpectedToken,"ILLEGAL")}function M(){var e,n,r;if(v(w((r=u[h]).charCodeAt(0))||"."===r,"Numeric literal must start with a decimal digit or a decimal point"),n=h,e="","."!==r){if(e=u[h++],r=u[h],"0"===e){if("x"===r||"X"===r)return++h,function(e){for(var n="";h<d&&k(u[h]);)n+=u[h++];return 0===n.length&&J({},a.UnexpectedToken,"ILLEGAL"),_(u.charCodeAt(h))&&J({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt("0x"+n,16),lineNumber:p,lineStart:f,start:e,end:h}}(n);if(S(r))return function(e){for(var n="0"+u[h++];h<d&&S(u[h]);)n+=u[h++];return(_(u.charCodeAt(h))||w(u.charCodeAt(h)))&&J({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt(n,8),octal:!0,lineNumber:p,lineStart:f,start:e,end:h}}(n);r&&w(r.charCodeAt(0))&&J({},a.UnexpectedToken,"ILLEGAL")}for(;w(u.charCodeAt(h));)e+=u[h++];r=u[h]}if("."===r){for(e+=u[h++];w(u.charCodeAt(h));)e+=u[h++];r=u[h]}if("e"===r||"E"===r)if(e+=u[h++],"+"!==(r=u[h])&&"-"!==r||(e+=u[h++]),w(u.charCodeAt(h)))for(;w(u.charCodeAt(h));)e+=u[h++];else J({},a.UnexpectedToken,"ILLEGAL");return _(u.charCodeAt(h))&&J({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseFloat(e),lineNumber:p,lineStart:f,start:n,end:h}}function $(){var e,n,r,i;return b=null,P(),e=h,n=function(){var e,t,n,r;for(v("/"===(e=u[h]),"Regular expression literal must start with a slash"),t=u[h++],n=!1,r=!1;h<d;)if(t+=e=u[h++],"\\"===e)O((e=u[h++]).charCodeAt(0))&&J({},a.UnterminatedRegExp),t+=e;else if(O(e.charCodeAt(0)))J({},a.UnterminatedRegExp);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||J({},a.UnterminatedRegExp),{value:t.substr(1,t.length-2),literal:t}}(),r=function(){var e,t,n,r;for(t="",n="";h<d&&E((e=u[h]).charCodeAt(0));)if(++h,"\\"===e&&h<d)if("u"===(e=u[h])){if(r=++h,e=N("u"))for(n+=e,t+="\\u";r<h;++r)t+=u[r];else h=r,n+="u",t+="\\u";X({},a.UnexpectedToken,"ILLEGAL")}else t+="\\",X({},a.UnexpectedToken,"ILLEGAL");else n+=e,t+=e;return{value:n,literal:t}}(),i=function(e,t){var n;try{n=new RegExp(e,t)}catch(e){J({},a.InvalidRegExp)}return n}(n.value,r.value),g.tokenize?{type:t.RegularExpression,value:i,lineNumber:p,lineStart:f,start:e,end:h}:{literal:n.literal+r.literal,value:i,start:e,end:h}}function L(){var e,t,n,r;return P(),e=h,t={start:{line:p,column:h-f}},n=$(),t.end={line:p,column:h-f},g.tokenize||(g.tokens.length>0&&(r=g.tokens[g.tokens.length-1]).range[0]===e&&"Punctuator"===r.type&&("/"!==r.value&&"/="!==r.value||g.tokens.pop()),g.tokens.push({type:"RegularExpression",value:n.literal,range:[e,h],loc:t})),n}function B(){var e;return P(),h>=d?{type:t.EOF,lineNumber:p,lineStart:f,start:h,end:h}:_(e=u.charCodeAt(h))?R():40===e||41===e||59===e?F():39===e||34===e?function(){var e,n,r,i,s,o,c,l,m="",b=!1;for(c=p,l=f,v("'"===(e=u[h])||'"'===e,"String literal must starts with a quote"),n=h,++h;h<d;){if((r=u[h++])===e){e="";break}if("\\"===r)if((r=u[h++])&&O(r.charCodeAt(0)))++p,"\r"===r&&"\n"===u[h]&&++h,f=h;else switch(r){case"u":case"x":o=h,(s=N(r))?m+=s:(h=o,m+=r);break;case"n":m+="\n";break;case"r":m+="\r";break;case"t":m+="\t";break;case"b":m+="\b";break;case"f":m+="\f";break;case"v":m+="\v";break;default:S(r)?(0!==(i="01234567".indexOf(r))&&(b=!0),h<d&&S(u[h])&&(b=!0,i=8*i+"01234567".indexOf(u[h++]),"0123".indexOf(r)>=0&&h<d&&S(u[h])&&(i=8*i+"01234567".indexOf(u[h++]))),m+=String.fromCharCode(i)):m+=r}else{if(O(r.charCodeAt(0)))break;m+=r}}return""!==e&&J({},a.UnexpectedToken,"ILLEGAL"),{type:t.StringLiteral,value:m,octal:b,startLineNumber:c,startLineStart:l,lineNumber:p,lineStart:f,start:n,end:h}}():46===e?w(u.charCodeAt(h+1))?M():F():w(e)?M():g.tokenize&&47===e?function(){var e,t;if(!(e=g.tokens[g.tokens.length-1]))return L();if("Punctuator"===e.type){if("]"===e.value)return F();if(")"===e.value)return!(t=g.tokens[g.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?F():L();if("}"===e.value){if(g.tokens[g.openCurlyToken-3]&&"Keyword"===g.tokens[g.openCurlyToken-3].type){if(!(t=g.tokens[g.openCurlyToken-4]))return F()}else{if(!g.tokens[g.openCurlyToken-4]||"Keyword"!==g.tokens[g.openCurlyToken-4].type)return F();if(!(t=g.tokens[g.openCurlyToken-5]))return L()}return r.indexOf(t.value)>=0?F():L()}return L()}return"Keyword"===e.type?L():F()}():F()}function z(){var e,r,i;return P(),e={start:{line:p,column:h-f}},r=B(),e.end={line:p,column:h-f},r.type!==t.EOF&&(i=u.slice(r.start,r.end),g.tokens.push({type:n[r.type],value:i,range:[r.start,r.end],loc:e})),r}function U(){var e;return h=(e=b).end,p=e.lineNumber,f=e.lineStart,b=void 0!==g.tokens?z():B(),h=e.end,p=e.lineNumber,f=e.lineStart,e}function q(){var e,t,n;e=h,t=p,n=f,b=void 0!==g.tokens?z():B(),h=e,p=t,f=n}function W(e,t){this.line=e,this.column=t}function G(e,t,n,r){this.start=new W(e,t),this.end=new W(n,r)}function H(){var e,t,n,r;return e=h,t=p,n=f,P(),r=p!==t,h=e,p=t,f=n,r}function J(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(function(e,t){return v(t<r.length,"Message reference must be in range"),r[t]}));throw"number"==typeof e.lineNumber?((n=new Error("Line "+e.lineNumber+": "+i)).index=e.start,n.lineNumber=e.lineNumber,n.column=e.start-f+1):((n=new Error("Line "+p+": "+i)).index=h,n.lineNumber=p,n.column=h-f+1),n.description=i,n}function X(){try{J.apply(null,arguments)}catch(e){if(!g.errors)throw e;g.errors.push(e)}}function V(e){if(e.type===t.EOF&&J(e,a.UnexpectedEOS),e.type===t.NumericLiteral&&J(e,a.UnexpectedNumber),e.type===t.StringLiteral&&J(e,a.UnexpectedString),e.type===t.Identifier&&J(e,a.UnexpectedIdentifier),e.type===t.Keyword){if(function(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}(e.value))J(e,a.UnexpectedReserved);else if(l&&C(e.value))return void X(e,a.StrictReservedWord);J(e,a.UnexpectedToken,e.value)}J(e,a.UnexpectedToken,e.value)}function K(e){var n=U();n.type===t.Punctuator&&n.value===e||V(n)}function Z(e){var n=U();n.type===t.Keyword&&n.value===e||V(n)}function Q(e){return b.type===t.Punctuator&&b.value===e}function Y(e){return b.type===t.Keyword&&b.value===e}function ee(){var e;59===u.charCodeAt(h)||Q(";")?U():(e=p,P(),p===e&&(b.type===t.EOF||Q("}")||V(b)))}function te(e){return e.type===i.Identifier||e.type===i.MemberExpression}function ne(e,t){var n,r,i;return n=l,i=b,r=_e(),t&&l&&j(e[0].name)&&X(t,a.StrictParamName),l=n,m.markEnd(m.createFunctionExpression(null,e,[],r),i)}function re(){var e,n;return n=b,(e=U()).type===t.StringLiteral||e.type===t.NumericLiteral?(l&&e.octal&&X(e,a.StrictOctalLiteral),m.markEnd(m.createLiteral(e),n)):m.markEnd(m.createIdentifier(e.value),n)}function ie(){var e,n,r,i,s,o;return o=b,(e=b).type===t.Identifier?(r=re(),"get"!==e.value||Q(":")?"set"!==e.value||Q(":")?(K(":"),i=me(),m.markEnd(m.createProperty("init",r,i),o)):(n=re(),K("("),(e=b).type!==t.Identifier?(K(")"),X(e,a.UnexpectedToken,e.value),i=ne([])):(s=[ge()],K(")"),i=ne(s,e)),m.markEnd(m.createProperty("set",n,i),o)):(n=re(),K("("),K(")"),i=ne([]),m.markEnd(m.createProperty("get",n,i),o))):e.type!==t.EOF&&e.type!==t.Punctuator?(n=re(),K(":"),i=me(),m.markEnd(m.createProperty("init",n,i),o)):void V(e)}function se(){var e,n,r,o;if(Q("("))return function(){var e;return K("("),e=be(),K(")"),e}();if(Q("["))return function(){var e,t=[];for(e=b,K("[");!Q("]");)Q(",")?(U(),t.push(null)):(t.push(me()),Q("]")||K(","));return U(),m.markEnd(m.createArrayExpression(t),e)}();if(Q("{"))return function(){var e,t,n,r,o,c=[],u={},h=String;for(o=b,K("{");!Q("}");)t=(e=ie()).key.type===i.Identifier?e.key.name:h(e.key.value),r="init"===e.kind?s.Data:"get"===e.kind?s.Get:s.Set,n="$"+t,Object.prototype.hasOwnProperty.call(u,n)?(u[n]===s.Data?l&&r===s.Data?X({},a.StrictDuplicateProperty):r!==s.Data&&X({},a.AccessorDataProperty):r===s.Data?X({},a.AccessorDataProperty):u[n]&r&&X({},a.AccessorGetSet),u[n]|=r):u[n]=r,c.push(e),Q("}")||K(",");return K("}"),m.markEnd(m.createObjectExpression(c),o)}();if(e=b.type,o=b,e===t.Identifier)r=m.createIdentifier(U().value);else if(e===t.StringLiteral||e===t.NumericLiteral)l&&b.octal&&X(b,a.StrictOctalLiteral),r=m.createLiteral(U());else if(e===t.Keyword){if(Y("function"))return function(){var e,t,n,r,i,s,o,c,u,h=null;return u=b,Z("function"),Q("(")||(e=b,h=ge(),l?j(e.value)&&X(e,a.StrictFunctionName):j(e.value)?(n=e,r=a.StrictFunctionName):C(e.value)&&(n=e,r=a.StrictReservedWord)),i=Ee(n),s=i.params,t=i.stricted,n=i.firstRestricted,i.message&&(r=i.message),c=l,o=_e(),l&&n&&J(n,r),l&&t&&X(t,r),l=c,m.markEnd(m.createFunctionExpression(h,s,[],o),u)}();Y("this")?(U(),r=m.createThisExpression()):V(U())}else e===t.BooleanLiteral?((n=U()).value="true"===n.value,r=m.createLiteral(n)):e===t.NullLiteral?((n=U()).value=null,r=m.createLiteral(n)):Q("/")||Q("/=")?(r=void 0!==g.tokens?m.createLiteral(L()):m.createLiteral($()),q()):V(U());return m.markEnd(r,o)}function ae(){var e=[];if(K("("),!Q(")"))for(;h<d&&(e.push(me()),!Q(")"));)K(",");return K(")"),e}function oe(){var e,n;return n=b,function(e){return e.type===t.Identifier||e.type===t.Keyword||e.type===t.BooleanLiteral||e.type===t.NullLiteral}(e=U())||V(e),m.markEnd(m.createIdentifier(e.value),n)}function ce(){return K("."),oe()}function ue(){var e;return K("["),e=be(),K("]"),e}function le(){var e,t,n;return n=b,Z("new"),e=function(){var e,t,n,r;for(r=b,e=y.allowIn,t=Y("new")?le():se(),y.allowIn=e;Q(".")||Q("[");)Q("[")?(n=ue(),t=m.createMemberExpression("[",t,n)):(n=ce(),t=m.createMemberExpression(".",t,n)),m.markEnd(t,r);return t}(),t=Q("(")?ae():[],m.markEnd(m.createNewExpression(e,t),n)}function he(){var e,n,r=b;return e=function(){var e,t,n,r,i;for(i=b,e=y.allowIn,y.allowIn=!0,t=Y("new")?le():se(),y.allowIn=e;;){if(Q("."))r=ce(),t=m.createMemberExpression(".",t,r);else if(Q("("))n=ae(),t=m.createCallExpression(t,n);else{if(!Q("["))break;r=ue(),t=m.createMemberExpression("[",t,r)}m.markEnd(t,i)}return t}(),b.type===t.Punctuator&&(!Q("++")&&!Q("--")||H()||(l&&e.type===i.Identifier&&j(e.name)&&X({},a.StrictLHSPostfix),te(e)||X({},a.InvalidLHSInAssignment),n=U(),e=m.markEnd(m.createPostfixExpression(n.value,e),r))),e}function pe(){var e,n,r;return b.type!==t.Punctuator&&b.type!==t.Keyword?n=he():Q("++")||Q("--")?(r=b,e=U(),n=pe(),l&&n.type===i.Identifier&&j(n.name)&&X({},a.StrictLHSPrefix),te(n)||X({},a.InvalidLHSInAssignment),n=m.createUnaryExpression(e.value,n),n=m.markEnd(n,r)):Q("+")||Q("-")||Q("~")||Q("!")?(r=b,e=U(),n=pe(),n=m.createUnaryExpression(e.value,n),n=m.markEnd(n,r)):Y("delete")||Y("void")||Y("typeof")?(r=b,e=U(),n=pe(),n=m.createUnaryExpression(e.value,n),n=m.markEnd(n,r),l&&"delete"===n.operator&&n.argument.type===i.Identifier&&X({},a.StrictDelete)):n=he(),n}function fe(e,n){var r=0;if(e.type!==t.Punctuator&&e.type!==t.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=n?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11}return r}function de(){var e,t,n,r,i;return i=b,e=function(){var e,t,n,r,i,s,a,o,c,u;if(e=b,c=pe(),0===(i=fe(r=b,y.allowIn)))return c;for(r.prec=i,U(),t=[e,b],s=[c,r,a=pe()];(i=fe(b,y.allowIn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,c=s.pop(),n=m.createBinaryExpression(o,c,a),t.pop(),e=t[t.length-1],m.markEnd(n,e),s.push(n);(r=U()).prec=i,s.push(r),t.push(b),n=pe(),s.push(n)}for(n=s[u=s.length-1],t.pop();u>1;)n=m.createBinaryExpression(s[u-1].value,s[u-2],n),u-=2,e=t.pop(),m.markEnd(n,e);return n}(),Q("?")&&(U(),t=y.allowIn,y.allowIn=!0,n=me(),y.allowIn=t,K(":"),r=me(),e=m.createConditionalExpression(e,n,r),m.markEnd(e,i)),e}function me(){var e,n,r,s,o,c;return e=b,o=b,s=n=de(),b.type!==t.Punctuator||"="!==(c=b.value)&&"*="!==c&&"/="!==c&&"%="!==c&&"+="!==c&&"-="!==c&&"<<="!==c&&">>="!==c&&">>>="!==c&&"&="!==c&&"^="!==c&&"|="!==c||(te(n)||X({},a.InvalidLHSInAssignment),l&&n.type===i.Identifier&&j(n.name)&&X(e,a.StrictLHSAssignment),e=U(),r=me(),s=m.markEnd(m.createAssignmentExpression(e.value,n,r),o)),s}function be(){var e,t=b;if(e=me(),Q(",")){for(e=m.createSequenceExpression([e]);h<d&&Q(",");)U(),e.expressions.push(me());m.markEnd(e,t)}return e}function ye(){var e,t;return t=b,K("{"),e=function(){for(var e,t=[];h<d&&!Q("}")&&void 0!==(e=je());)t.push(e);return t}(),K("}"),m.markEnd(m.createBlockStatement(e),t)}function ge(){var e,n;return n=b,(e=U()).type!==t.Identifier&&V(e),m.markEnd(m.createIdentifier(e.value),n)}function ve(e){var t,n,r=null;return n=b,t=ge(),l&&j(t.name)&&X({},a.StrictVarName),"const"===e?(K("="),r=me()):Q("=")&&(U(),r=me()),m.markEnd(m.createVariableDeclarator(t,r),n)}function we(e){var t=[];do{if(t.push(ve(e)),!Q(","))break;U()}while(h<d);return t}function ke(){var e,t,n,r,i,s,o,c,u,l;return e=t=n=null,Z("for"),K("("),Q(";")?U():(Y("var")||Y("let")?(y.allowIn=!1,l=b,c=U(),u=we(),e=m.markEnd(m.createVariableDeclaration(u,c.value),l),y.allowIn=!0,1===e.declarations.length&&Y("in")&&(U(),r=e,i=be(),e=null)):(y.allowIn=!1,e=be(),y.allowIn=!0,Y("in")&&(te(e)||X({},a.InvalidLHSInForIn),U(),r=e,i=be(),e=null)),void 0===r&&K(";")),void 0===r&&(Q(";")||(t=be()),K(";"),Q(")")||(n=be())),K(")"),o=y.inIteration,y.inIteration=!0,s=Oe(),y.inIteration=o,void 0===r?m.createForStatement(e,t,n,s):m.createForInStatement(r,i,s)}function Se(){var e,t,n,r=[];for(n=b,Y("default")?(U(),e=null):(Z("case"),e=be()),K(":");h<d&&!(Q("}")||Y("default")||Y("case"));)t=Oe(),r.push(t);return m.markEnd(m.createSwitchCase(e,r),n)}function xe(){var e,t,n,r,i=[],s=null;return Z("try"),e=ye(),Y("catch")&&i.push((r=b,Z("catch"),K("("),Q(")")&&V(b),t=ge(),l&&j(t.name)&&X({},a.StrictCatchVariable),K(")"),n=ye(),m.markEnd(m.createCatchClause(t,n),r))),Y("finally")&&(U(),s=ye()),0!==i.length||s||J({},a.NoCatchOrFinally),m.createTryStatement(e,[],i,s)}function Oe(){var e,n,r,s,o,c,p,f,g,v=b.type;if(v===t.EOF&&V(b),v===t.Punctuator&&"{"===b.value)return ye();if(s=b,v===t.Punctuator)switch(b.value){case";":return m.markEnd((K(";"),m.createEmptyStatement()),s);case"(":return m.markEnd(function(){var e=be();return ee(),m.createExpressionStatement(e)}(),s)}if(v===t.Keyword)switch(b.value){case"break":return m.markEnd(function(){var e,n=null;return Z("break"),59===u.charCodeAt(h)?(U(),y.inIteration||y.inSwitch||J({},a.IllegalBreak),m.createBreakStatement(null)):H()?(y.inIteration||y.inSwitch||J({},a.IllegalBreak),m.createBreakStatement(null)):(b.type===t.Identifier&&(e="$"+(n=ge()).name,Object.prototype.hasOwnProperty.call(y.labelSet,e)||J({},a.UnknownLabel,n.name)),ee(),null!==n||y.inIteration||y.inSwitch||J({},a.IllegalBreak),m.createBreakStatement(n))}(),s);case"continue":return m.markEnd(function(){var e,n=null;return Z("continue"),59===u.charCodeAt(h)?(U(),y.inIteration||J({},a.IllegalContinue),m.createContinueStatement(null)):H()?(y.inIteration||J({},a.IllegalContinue),m.createContinueStatement(null)):(b.type===t.Identifier&&(e="$"+(n=ge()).name,Object.prototype.hasOwnProperty.call(y.labelSet,e)||J({},a.UnknownLabel,n.name)),ee(),null!==n||y.inIteration||J({},a.IllegalContinue),m.createContinueStatement(n))}(),s);case"debugger":return m.markEnd((Z("debugger"),ee(),m.createDebuggerStatement()),s);case"do":return m.markEnd((Z("do"),g=y.inIteration,y.inIteration=!0,p=Oe(),y.inIteration=g,Z("while"),K("("),f=be(),K(")"),Q(";")&&U(),m.createDoWhileStatement(p,f)),s);case"for":return m.markEnd(ke(),s);case"function":return m.markEnd(Ce(),s);case"if":return m.markEnd(function(){var e,t,n;return Z("if"),K("("),e=be(),K(")"),t=Oe(),Y("else")?(U(),n=Oe()):n=null,m.createIfStatement(e,t,n)}(),s);case"return":return m.markEnd((c=null,Z("return"),y.inFunctionBody||X({},a.IllegalReturn),32===u.charCodeAt(h)&&_(u.charCodeAt(h+1))?(c=be(),ee(),m.createReturnStatement(c)):H()?m.createReturnStatement(null):(Q(";")||Q("}")||b.type===t.EOF||(c=be()),ee(),m.createReturnStatement(c))),s);case"switch":return m.markEnd(function(){var e,t,n,r,i;if(Z("switch"),K("("),e=be(),K(")"),K("{"),t=[],Q("}"))return U(),m.createSwitchStatement(e,t);for(r=y.inSwitch,y.inSwitch=!0,i=!1;h<d&&!Q("}");)null===(n=Se()).test&&(i&&J({},a.MultipleDefaultsInSwitch),i=!0),t.push(n);return y.inSwitch=r,K("}"),m.createSwitchStatement(e,t)}(),s);case"throw":return m.markEnd(function(){var e;return Z("throw"),H()&&J({},a.NewlineAfterThrow),e=be(),ee(),m.createThrowStatement(e)}(),s);case"try":return m.markEnd(xe(),s);case"var":return m.markEnd((Z("var"),o=we(),ee(),m.createVariableDeclaration(o,"var")),s);case"while":return m.markEnd(function(){var e,t,n;return Z("while"),K("("),e=be(),K(")"),n=y.inIteration,y.inIteration=!0,t=Oe(),y.inIteration=n,m.createWhileStatement(e,t)}(),s);case"with":return m.markEnd(function(){var e,t;return l&&(P(),X({},a.StrictModeWith)),Z("with"),K("("),e=be(),K(")"),t=Oe(),m.createWithStatement(e,t)}(),s)}return(e=be()).type===i.Identifier&&Q(":")?(U(),r="$"+e.name,Object.prototype.hasOwnProperty.call(y.labelSet,r)&&J({},a.Redeclaration,"Label",e.name),y.labelSet[r]=!0,n=Oe(),delete y.labelSet[r],m.markEnd(m.createLabeledStatement(e,n),s)):(ee(),m.markEnd(m.createExpressionStatement(e),s))}function _e(){var e,n,r,s,o,c,p,f,g=[];for(f=b,K("{");h<d&&b.type===t.StringLiteral&&(n=b,e=je(),g.push(e),e.expression.type===i.Literal);)"use strict"===u.slice(n.start+1,n.end-1)?(l=!0,r&&X(r,a.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(s=y.labelSet,o=y.inIteration,c=y.inSwitch,p=y.inFunctionBody,y.labelSet={},y.inIteration=!1,y.inSwitch=!1,y.inFunctionBody=!0;h<d&&!Q("}")&&void 0!==(e=je());)g.push(e);return K("}"),y.labelSet=s,y.inIteration=o,y.inSwitch=c,y.inFunctionBody=p,m.markEnd(m.createBlockStatement(g),f)}function Ee(e){var t,n,r,i,s,o,c=[];if(K("("),!Q(")"))for(i={};h<d&&(n=b,t=ge(),s="$"+n.value,l?(j(n.value)&&(r=n,o=a.StrictParamName),Object.prototype.hasOwnProperty.call(i,s)&&(r=n,o=a.StrictParamDupe)):e||(j(n.value)?(e=n,o=a.StrictParamName):C(n.value)?(e=n,o=a.StrictReservedWord):Object.prototype.hasOwnProperty.call(i,s)&&(e=n,o=a.StrictParamDupe)),c.push(t),i[s]=!0,!Q(")"));)K(",");return K(")"),{params:c,stricted:r,firstRestricted:e,message:o}}function Ce(){var e,t,n,r,i,s,o,c,u,h;return h=b,Z("function"),r=b,e=ge(),l?j(r.value)&&X(r,a.StrictFunctionName):j(r.value)?(o=r,c=a.StrictFunctionName):C(r.value)&&(o=r,c=a.StrictReservedWord),t=(s=Ee(o)).params,i=s.stricted,o=s.firstRestricted,s.message&&(c=s.message),u=l,n=_e(),l&&o&&J(o,c),l&&i&&X(i,c),l=u,m.markEnd(m.createFunctionDeclaration(e,t,[],n),h)}function je(){if(b.type===t.Keyword)switch(b.value){case"const":case"let":return e=b.value,r=b,Z(e),n=we(e),ee(),m.markEnd(m.createVariableDeclaration(n,e),r);case"function":return Ce();default:return Oe()}var e,n,r;if(b.type!==t.EOF)return Oe()}function Te(){var e,n;return P(),q(),n=b,l=!1,e=function(){for(var e,n,r,s=[];h<d&&(n=b).type===t.StringLiteral&&(e=je(),s.push(e),e.expression.type===i.Literal);)"use strict"===u.slice(n.start+1,n.end-1)?(l=!0,r&&X(r,a.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(;h<d&&void 0!==(e=je());)s.push(e);return s}(),m.markEnd(m.createProgram(e),n)}function Ie(){var e,t,n,r=[];for(e=0;e<g.tokens.length;++e)n={type:(t=g.tokens[e]).type,value:t.value},g.range&&(n.range=t.range),g.loc&&(n.loc=t.loc),r.push(n);g.tokens=r}(n={})[(t={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",n[t.EOF]="<end>",n[t.Identifier]="Identifier",n[t.Keyword]="Keyword",n[t.NullLiteral]="Null",n[t.NumericLiteral]="Numeric",n[t.Punctuator]="Punctuator",n[t.StringLiteral]="String",n[t.RegularExpression]="RegularExpression",r=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],i={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},s={Data:1,Get:2,Set:4},a={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},o={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},c={name:"SyntaxTree",processComment:function(e){var t,n;if(!(e.type===i.Program&&e.body.length>0)){for(g.trailingComments.length>0?g.trailingComments[0].range[0]>=e.range[1]?(n=g.trailingComments,g.trailingComments=[]):g.trailingComments.length=0:g.bottomRightStack.length>0&&g.bottomRightStack[g.bottomRightStack.length-1].trailingComments&&g.bottomRightStack[g.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(n=g.bottomRightStack[g.bottomRightStack.length-1].trailingComments,delete g.bottomRightStack[g.bottomRightStack.length-1].trailingComments);g.bottomRightStack.length>0&&g.bottomRightStack[g.bottomRightStack.length-1].range[0]>=e.range[0];)t=g.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):g.leadingComments.length>0&&g.leadingComments[g.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=g.leadingComments,g.leadingComments=[]),n&&(e.trailingComments=n),g.bottomRightStack.push(e)}},markEnd:function(e,t){return g.range&&(e.range=[t.start,h]),g.loc&&(e.loc=new G(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),p,h-f),this.postProcess(e)),g.attachComment&&this.processComment(e),e},postProcess:function(e){return g.source&&(e.loc.source=g.source),e},createArrayExpression:function(e){return{type:i.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,n){return{type:i.AssignmentExpression,operator:e,left:t,right:n}},createBinaryExpression:function(e,t,n){return{type:"||"===e||"&&"===e?i.LogicalExpression:i.BinaryExpression,operator:e,left:t,right:n}},createBlockStatement:function(e){return{type:i.BlockStatement,body:e}},createBreakStatement:function(e){return{type:i.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:i.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:i.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,n){return{type:i.ConditionalExpression,test:e,consequent:t,alternate:n}},createContinueStatement:function(e){return{type:i.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:i.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:i.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:i.EmptyStatement}},createExpressionStatement:function(e){return{type:i.ExpressionStatement,expression:e}},createForStatement:function(e,t,n,r){return{type:i.ForStatement,init:e,test:t,update:n,body:r}},createForInStatement:function(e,t,n){return{type:i.ForInStatement,left:e,right:t,body:n,each:!1}},createFunctionDeclaration:function(e,t,n,r){return{type:i.FunctionDeclaration,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,n,r){return{type:i.FunctionExpression,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:i.Identifier,name:e}},createIfStatement:function(e,t,n){return{type:i.IfStatement,test:e,consequent:t,alternate:n}},createLabeledStatement:function(e,t){return{type:i.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:i.Literal,value:e.value,raw:u.slice(e.start,e.end)}},createMemberExpression:function(e,t,n){return{type:i.MemberExpression,computed:"["===e,object:t,property:n}},createNewExpression:function(e,t){return{type:i.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:i.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:i.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:i.Program,body:e}},createProperty:function(e,t,n){return{type:i.Property,key:t,value:n,kind:e}},createReturnStatement:function(e){return{type:i.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:i.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:i.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:i.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:i.ThisExpression}},createThrowStatement:function(e){return{type:i.ThrowStatement,argument:e}},createTryStatement:function(e,t,n,r){return{type:i.TryStatement,block:e,guardedHandlers:t,handlers:n,finalizer:r}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:i.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:i.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:i.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:i.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:i.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:i.WithStatement,object:e,body:t}}},e.version="1.2.2",e.tokenize=function(e,n){var r;"string"==typeof e||e instanceof String||(e=String(e)),m=c,h=0,p=(u=e).length>0?1:0,f=0,d=u.length,b=null,y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},g={},(n=n||{}).tokens=!0,g.tokens=[],g.tokenize=!0,g.openParenToken=-1,g.openCurlyToken=-1,g.range="boolean"==typeof n.range&&n.range,g.loc="boolean"==typeof n.loc&&n.loc,"boolean"==typeof n.comment&&n.comment&&(g.comments=[]),"boolean"==typeof n.tolerant&&n.tolerant&&(g.errors=[]);try{if(q(),b.type===t.EOF)return g.tokens;for(U();b.type!==t.EOF;)try{U()}catch(e){if(g.errors){g.errors.push(e);break}throw e}Ie(),r=g.tokens,void 0!==g.comments&&(r.comments=g.comments),void 0!==g.errors&&(r.errors=g.errors)}catch(e){throw e}finally{g={}}return r},e.parse=function(e,t){var n,r;r=String,"string"==typeof e||e instanceof String||(e=r(e)),m=c,h=0,p=(u=e).length>0?1:0,f=0,d=u.length,b=null,y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},g={},void 0!==t&&(g.range="boolean"==typeof t.range&&t.range,g.loc="boolean"==typeof t.loc&&t.loc,g.attachComment="boolean"==typeof t.attachComment&&t.attachComment,g.loc&&null!==t.source&&void 0!==t.source&&(g.source=r(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(g.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(g.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(g.errors=[]),g.attachComment&&(g.range=!0,g.comments=[],g.bottomRightStack=[],g.trailingComments=[],g.leadingComments=[]));try{n=Te(),void 0!==g.comments&&(n.comments=g.comments),void 0!==g.tokens&&(Ie(),n.tokens=g.tokens),void 0!==g.errors&&(n.errors=g.errors)}catch(e){throw e}finally{g={}}return n},e.Syntax=function(){var e,t={};for(e in"function"==typeof Object.create&&(t=Object.create(null)),i)i.hasOwnProperty(e)&&(t[e]=i[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()}))},{}],1:[function(e,t,n){(function(r){var i=function(){var e={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(e,n,r,i,s,a,o){i.ast||(i.ast=t,t.initialize());var c=a.length-1;switch(s){case 1:return i.ast.set({expression:{type:"root",value:a[c]}}),i.ast.unshift(),i.ast.yield();case 2:return i.ast.set({expression:{type:"root",value:a[c-1]}}),i.ast.unshift(),i.ast.yield();case 3:return i.ast.unshift(),i.ast.yield();case 4:return i.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:a[c-1]}}),i.ast.unshift(),i.ast.yield();case 5:case 6:break;case 7:i.ast.set({operation:"member"}),i.ast.push();break;case 8:i.ast.set({operation:"subscript"}),i.ast.push();break;case 9:i.ast.set({scope:"child"});break;case 10:i.ast.set({scope:"descendant"});break;case 11:break;case 12:i.ast.set({scope:"child",operation:"member"});break;case 13:break;case 14:i.ast.set({expression:{type:"wildcard",value:a[c]}});break;case 15:i.ast.set({expression:{type:"identifier",value:a[c]}});break;case 16:i.ast.set({expression:{type:"script_expression",value:a[c]}});break;case 17:i.ast.set({expression:{type:"numeric_literal",value:parseInt(a[c])}});break;case 18:break;case 19:i.ast.set({scope:"child"});break;case 20:i.ast.set({scope:"descendant"});break;case 21:case 22:case 23:break;case 24:a[c].length>1?i.ast.set({expression:{type:"union",value:a[c]}}):this.$=a[c];break;case 25:this.$=[a[c]];break;case 26:this.$=a[c-2].concat(a[c]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(a[c])}},i.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:a[c]}},i.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:a[c]}},i.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:a[c]}},i.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:a[c]}},i.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:a[c]}},i.ast.set(this.$);break;case 33:case 34:this.$=a[c]}},table:[{3:1,4:[1,2],6:3,13:4,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,12],12:[2,12],14:[2,12],22:[2,12]},{1:[2,14],12:[2,14],14:[2,14],22:[2,14]},{1:[2,15],12:[2,15],14:[2,15],22:[2,15]},{1:[2,16],12:[2,16],14:[2,16],22:[2,16]},{1:[2,17],12:[2,17],14:[2,17],22:[2,17]},{1:[2,18],12:[2,18],14:[2,18],22:[2,18]},{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,5],12:[2,5],14:[2,5],22:[2,5]},{1:[2,7],12:[2,7],14:[2,7],22:[2,7]},{1:[2,8],12:[2,8],14:[2,8],22:[2,8]},{1:[2,9],12:[2,9],14:[2,9],22:[2,9]},{1:[2,10],12:[2,10],14:[2,10],22:[2,10]},{1:[2,19],12:[2,19],14:[2,19],22:[2,19]},{1:[2,20],12:[2,20],14:[2,20],22:[2,20]},{13:23,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{13:24,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9],22:[1,25]},{15:[1,29],17:[1,30],18:[1,33],23:26,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,6],12:[2,6],14:[2,6],22:[2,6]},{1:[2,11],12:[2,11],14:[2,11],22:[2,11]},{1:[2,13],12:[2,13],14:[2,13],22:[2,13]},{15:[1,29],17:[1,30],18:[1,33],23:38,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},{24:[2,25],28:[2,25]},{24:[2,27],28:[2,27]},{24:[2,28],28:[2,28]},{24:[2,29],28:[2,29]},{24:[2,33],28:[2,33]},{24:[2,34],28:[2,34]},{24:[1,41]},{1:[2,21],12:[2,21],14:[2,21],22:[2,21]},{18:[1,33],27:42,29:34,30:[1,35],32:[1,36],33:[1,37]},{1:[2,22],12:[2,22],14:[2,22],22:[2,22]},{24:[2,26],28:[2,26]}],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,n=[0],r=[null],i=[],s=this.table,a="",o=0,c=0,u=0,l=2,h=1,p=i.slice.call(arguments,1);this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;i.push(f);var d=this.lexer.options&&this.lexer.options.ranges;function m(){var e;return"number"!=typeof(e=t.lexer.lex()||h)&&(e=t.symbols_[e]||e),e}"function"==typeof this.yy.parseError?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,y,g,v,w,k,S,x,O,_={};;){if(g=n[n.length-1],this.defaultActions[g]?v=this.defaultActions[g]:(null==b&&(b=m()),v=s[g]&&s[g][b]),void 0===v||!v.length||!v[0]){var E="";for(k in O=[],s[g])this.terminals_[k]&&k>l&&O.push("'"+this.terminals_[k]+"'");E=this.lexer.showPosition?"Parse error on line "+(o+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+O.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(o+1)+": Unexpected "+(b==h?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(E,{text:this.lexer.match,token:this.terminals_[b]||b,line:this.lexer.yylineno,loc:f,expected:O})}if(v[0]instanceof Array&&v.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+b);switch(v[0]){case 1:n.push(b),r.push(this.lexer.yytext),i.push(this.lexer.yylloc),n.push(v[1]),b=null,y?(b=y,y=null):(c=this.lexer.yyleng,a=this.lexer.yytext,o=this.lexer.yylineno,f=this.lexer.yylloc,u>0&&u--);break;case 2:if(S=this.productions_[v[1]][1],_.$=r[r.length-S],_._$={first_line:i[i.length-(S||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(S||1)].first_column,last_column:i[i.length-1].last_column},d&&(_._$.range=[i[i.length-(S||1)].range[0],i[i.length-1].range[1]]),void 0!==(w=this.performAction.apply(_,[a,c,o,this.yy,v[1],r,i].concat(p))))return w;S&&(n=n.slice(0,-1*S*2),r=r.slice(0,-1*S),i=i.slice(0,-1*S)),n.push(this.productions_[v[1]][0]),r.push(_.$),i.push(_._$),x=s[n[n.length-2]][n[n.length-1]],n.push(x);break;case 3:return!0}}return!0}},t={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(e){for(var t in e)this._node[t]=e[t];return this._node},node:function(e){return arguments.length&&(this._node=e),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var e=this._nodes;return this.initialize(),e}},n={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(r=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var s in i)this[s]=i[s];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),s=0;s<i.length;s++)if((n=this._input.match(this.rules[i[s]]))&&(!t||n[0].length>t[0].length)){if(t=n,r=s,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,i[s])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[r]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,r){switch(n){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return t.yytext=t.yytext.substr(1,t.yyleng-2),32;case 11:return t.yytext=t.yytext.substr(1,t.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function r(){this.yy={}}return e.lexer=n,r.prototype=e,e.Parser=r,new r}();void 0!==e&&void 0!==n&&(n.parser=i,n.Parser=i.Parser,n.parse=function(){return i.parse.apply(i,arguments)},n.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),r.exit(1));var i=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return n.parser.parse(i)},void 0!==t&&e.main===t&&n.main(r.argv.slice(1)))}).call(this,e("_process"))},{_process:14,fs:12,path:13}],2:[function(e,t,n){t.exports={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"}},{}],3:[function(e,t,n){var r=e("./dict"),i=e("fs"),s={lex:{macros:{esc:"\\\\",int:r.integer},rules:[["\\$","return 'DOLLAR'"],["\\.\\.","return 'DOT_DOT'"],["\\.","return 'DOT'"],["\\*","return 'STAR'"],[r.identifier,"return 'IDENTIFIER'"],["\\[","return '['"],["\\]","return ']'"],[",","return ','"],["({int})?\\:({int})?(\\:({int})?)?","return 'ARRAY_SLICE'"],["{int}","return 'INTEGER'"],[r.qq_string,"yytext = yytext.substr(1,yyleng-2); return 'QQ_STRING';"],[r.q_string,"yytext = yytext.substr(1,yyleng-2); return 'Q_STRING';"],["\\(.+?\\)(?=\\])","return 'SCRIPT_EXPRESSION'"],["\\?\\(.+?\\)(?=\\])","return 'FILTER_EXPRESSION'"]]},start:"JSON_PATH",bnf:{JSON_PATH:[["DOLLAR",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["DOLLAR PATH_COMPONENTS",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["LEADING_CHILD_MEMBER_EXPRESSION","yy.ast.unshift(); return yy.ast.yield()"],["LEADING_CHILD_MEMBER_EXPRESSION PATH_COMPONENTS",'yy.ast.set({ operation: "member", scope: "child", expression: { type: "identifier", value: $1 }}); yy.ast.unshift(); return yy.ast.yield()']],PATH_COMPONENTS:[["PATH_COMPONENT",""],["PATH_COMPONENTS PATH_COMPONENT",""]],PATH_COMPONENT:[["MEMBER_COMPONENT",'yy.ast.set({ operation: "member" }); yy.ast.push()'],["SUBSCRIPT_COMPONENT",'yy.ast.set({ operation: "subscript" }); yy.ast.push() ']],MEMBER_COMPONENT:[["CHILD_MEMBER_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_MEMBER_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_MEMBER_COMPONENT:[["DOT MEMBER_EXPRESSION",""]],LEADING_CHILD_MEMBER_EXPRESSION:[["MEMBER_EXPRESSION",'yy.ast.set({ scope: "child", operation: "member" })']],DESCENDANT_MEMBER_COMPONENT:[["DOT_DOT MEMBER_EXPRESSION",""]],MEMBER_EXPRESSION:[["STAR",'yy.ast.set({ expression: { type: "wildcard", value: $1 } })'],["IDENTIFIER",'yy.ast.set({ expression: { type: "identifier", value: $1 } })'],["SCRIPT_EXPRESSION",'yy.ast.set({ expression: { type: "script_expression", value: $1 } })'],["INTEGER",'yy.ast.set({ expression: { type: "numeric_literal", value: parseInt($1) } })'],["END",""]],SUBSCRIPT_COMPONENT:[["CHILD_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_SUBSCRIPT_COMPONENT:[["[ SUBSCRIPT ]",""]],DESCENDANT_SUBSCRIPT_COMPONENT:[["DOT_DOT [ SUBSCRIPT ]",""]],SUBSCRIPT:[["SUBSCRIPT_EXPRESSION",""],["SUBSCRIPT_EXPRESSION_LIST",'$1.length > 1? yy.ast.set({ expression: { type: "union", value: $1 } }) : $$ = $1']],SUBSCRIPT_EXPRESSION_LIST:[["SUBSCRIPT_EXPRESSION_LISTABLE","$$ = [$1]"],["SUBSCRIPT_EXPRESSION_LIST , SUBSCRIPT_EXPRESSION_LISTABLE","$$ = $1.concat($3)"]],SUBSCRIPT_EXPRESSION_LISTABLE:[["INTEGER",'$$ = { expression: { type: "numeric_literal", value: parseInt($1) } }; yy.ast.set($$)'],["STRING_LITERAL",'$$ = { expression: { type: "string_literal", value: $1 } }; yy.ast.set($$)'],["ARRAY_SLICE",'$$ = { expression: { type: "slice", value: $1 } }; yy.ast.set($$)']],SUBSCRIPT_EXPRESSION:[["STAR",'$$ = { expression: { type: "wildcard", value: $1 } }; yy.ast.set($$)'],["SCRIPT_EXPRESSION",'$$ = { expression: { type: "script_expression", value: $1 } }; yy.ast.set($$)'],["FILTER_EXPRESSION",'$$ = { expression: { type: "filter_expression", value: $1 } }; yy.ast.set($$)']],STRING_LITERAL:[["QQ_STRING","$$ = $1"],["Q_STRING","$$ = $1"]]}};i.readFileSync&&(s.moduleInclude=i.readFileSync(e.resolve("../include/module.js")),s.actionInclude=i.readFileSync(e.resolve("../include/action.js"))),t.exports=s},{"./dict":2,fs:12}],4:[function(e,t,n){var r=e("./aesprim"),i=e("./slice"),s=e("static-eval"),a=e("underscore").uniq,o=function(){return this.initialize.apply(this,arguments)};function c(t,n,i){var s=e("./index"),a=f(r.parse(n).body[0].expression,{"@":t.value}),o=i.replace(/\{\{\s*value\s*\}\}/g,a),c=s.nodes(t.value,o);return c.forEach((function(e){e.path=t.path.concat(e.path.slice(1))})),c}function u(e){return Array.isArray(e)}function l(e){return function(t,n,r,i){var s=t.value,a=t.path,o=[],c=function(t,s){var a;u(t)?(t.forEach((function(e,t){o.length>=i||r(t,e,n)&&o.push({path:s.concat(t),value:e})})),t.forEach((function(t,n){o.length>=i||e&&c(t,s.concat(n))}))):(a=t)&&!(a instanceof Array)&&a instanceof Object&&(this.keys(t).forEach((function(e){o.length>=i||r(e,t[e],n)&&o.push({path:s.concat(e),value:t[e]})})),this.keys(t).forEach((function(n){o.length>=i||e&&c(t[n],s.concat(n))})))}.bind(this);return c(s,a),o}}function h(e){return function(t,n,r){return this.descend(n,t.expression.value,e,r)}}function p(e){return function(t,n,r){return this.traverse(n,t.expression.value,e,r)}}function f(){try{return s.apply(this,arguments)}catch(e){}}function d(e){return e=e.filter((function(e){return e})),a(e,(function(e){return e.path.map((function(e){return String(e).replace("-","--")})).join("-")}))}function m(e){var t=String(e);return t.match(/^-?[0-9]+$/)?parseInt(t):null}o.prototype.initialize=function(){this.traverse=l(!0),this.descend=l()},o.prototype.keys=Object.keys,o.prototype.resolve=function(e){var t=[e.operation,e.scope,e.expression.type].join("-"),n=this._fns[t];if(!n)throw new Error("couldn't resolve key: "+t);return n.bind(this)},o.prototype.register=function(e,t){if(!t instanceof Function)throw new Error("handler must be a function");this._fns[e]=t},o.prototype._fns={"member-child-identifier":function(e,t){var n=e.expression.value,r=t.value;if(r instanceof Object&&n in r)return[{value:r[n],path:t.path.concat(n)}]},"member-descendant-identifier":p((function(e,t,n){return e==n})),"subscript-child-numeric_literal":h((function(e,t,n){return e===n})),"member-child-numeric_literal":h((function(e,t,n){return String(e)===String(n)})),"subscript-descendant-numeric_literal":p((function(e,t,n){return e===n})),"member-child-wildcard":h((function(){return!0})),"member-descendant-wildcard":p((function(){return!0})),"subscript-descendant-wildcard":p((function(){return!0})),"subscript-child-wildcard":h((function(){return!0})),"subscript-child-slice":function(e,t){if(u(t.value)){var n=e.expression.value.split(":").map(m),r=t.value.map((function(e,n){return{value:e,path:t.path.concat(n)}}));return i.apply(null,[r].concat(n))}},"subscript-child-union":function(e,t){var n=[];return e.expression.value.forEach((function(e){var r={operation:"subscript",scope:"child",expression:e.expression},i=this.resolve(r)(r,t);i&&(n=n.concat(i))}),this),d(n)},"subscript-descendant-union":function(t,n,r){var i=e(".."),s=this,a=[];return i.nodes(n,"$..*").slice(1).forEach((function(e){a.length>=r||t.expression.value.forEach((function(t){var n={operation:"subscript",scope:"child",expression:t.expression},r=s.resolve(n)(n,e);a=a.concat(r)}))})),d(a)},"subscript-child-filter_expression":function(e,t,n){var i=e.expression.value.slice(2,-1),s=r.parse(i).body[0].expression;return this.descend(t,null,(function(e,t){return f(s,{"@":t})}),n)},"subscript-descendant-filter_expression":function(e,t,n){var i=e.expression.value.slice(2,-1),s=r.parse(i).body[0].expression;return this.traverse(t,null,(function(e,t){return f(s,{"@":t})}),n)},"subscript-child-script_expression":function(e,t){return c(t,e.expression.value.slice(1,-1),"$[{{value}}]")},"member-child-script_expression":function(e,t){return c(t,e.expression.value.slice(1,-1),"$.{{value}}")},"member-descendant-script_expression":function(e,t){return c(t,e.expression.value.slice(1,-1),"$..value")}},o.prototype._fns["subscript-child-string_literal"]=o.prototype._fns["member-child-identifier"],o.prototype._fns["member-descendant-numeric_literal"]=o.prototype._fns["subscript-descendant-string_literal"]=o.prototype._fns["member-descendant-identifier"],t.exports=o},{"..":"jsonpath","./aesprim":"./aesprim","./index":5,"./slice":7,"static-eval":15,underscore:12}],5:[function(e,t,n){var r=e("assert"),i=e("./dict"),s=e("./parser"),a=e("./handlers"),o=function(){this.initialize.apply(this,arguments)};function c(e){return"[object String]"==Object.prototype.toString.call(e)}o.prototype.initialize=function(){this.parser=new s,this.handlers=new a},o.prototype.parse=function(e){return r.ok(c(e),"we need a path"),this.parser.parse(e)},o.prototype.parent=function(e,t){r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path");var n=this.nodes(e,t)[0];return n.path.pop(),this.value(e,n.path)},o.prototype.apply=function(e,t,n){r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),r.equal(typeof n,"function","fn needs to be function");var i=this.nodes(e,t).sort((function(e,t){return t.path.length-e.path.length}));return i.forEach((function(t){var r=t.path.pop(),i=this.value(e,this.stringify(t.path)),s=t.value=n.call(e,i[r]);i[r]=s}),this),i},o.prototype.value=function(e,t,n){if(r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),arguments.length>=3){var i=this.nodes(e,t).shift();if(!i)return this._vivify(e,t,n);var s=i.path.slice(-1).shift(),a=this.parent(e,this.stringify(i.path));a[s]=n}return this.query(e,this.stringify(t),1).shift()},o.prototype._vivify=function(e,t,n){var i=this;r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path");var s=this.parser.parse(t).map((function(e){return e.expression.value})),a=function(t,n){var r=t.pop(),s=i.value(e,t);s||(a(t.concat(),"string"==typeof r?{}:[]),s=i.value(e,t)),s[r]=n};return a(s,n),this.query(e,t)[0]},o.prototype.query=function(e,t,n){return r.ok(e instanceof Object,"obj needs to be an object"),r.ok(c(t),"we need a path"),this.nodes(e,t,n).map((function(e){return e.value}))},o.prototype.paths=function(e,t,n){return r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),this.nodes(e,t,n).map((function(e){return e.path}))},o.prototype.nodes=function(e,t,n){if(r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),0===n)return[];var i=this.parser.parse(t),s=this.handlers,a=[{path:["$"],value:e}],o=[];return i.length&&"root"==i[0].expression.type&&i.shift(),i.length?(i.forEach((function(e,t){if(!(o.length>=n)){var r=s.resolve(e),c=[];a.forEach((function(s){if(!(o.length>=n)){var a=r(e,s,n);t==i.length-1?o=o.concat(a||[]):c=c.concat(a||[])}})),a=c}})),n?o.slice(0,n):o):a},o.prototype.stringify=function(e){r.ok(e,"we need a path");var t="$",n={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return(e=this._normalize(e)).forEach((function(e){if("root"!=e.expression.type){var r,i=[e.scope,e.operation].join("-"),s=n[i];if(r="string_literal"==e.expression.type?JSON.stringify(e.expression.value):e.expression.value,!s)throw new Error("couldn't find template "+i);t+=s.replace(/{{value}}/,r)}})),t},o.prototype._normalize=function(e){if(r.ok(e,"we need a path"),"string"==typeof e)return this.parser.parse(e);if(Array.isArray(e)&&"string"==typeof e[0]){var t=[{expression:{type:"root",value:"$"}}];return e.forEach((function(e,n){if("$"!=e||0!==n)if("string"==typeof e&&e.match("^"+i.identifier+"$"))t.push({operation:"member",scope:"child",expression:{value:e,type:"identifier"}});else{var r="number"==typeof e?"numeric_literal":"string_literal";t.push({operation:"subscript",scope:"child",expression:{value:e,type:r}})}})),t}if(Array.isArray(e)&&"object"==typeof e[0])return e;throw new Error("couldn't understand path "+e)},o.Handlers=a,o.Parser=s;var u=new o;u.JSONPath=o,t.exports=u},{"./dict":2,"./handlers":4,"./parser":6,assert:8}],6:[function(e,t,n){var r=e("./grammar"),i=e("../generated/parser"),s=function(){var e=new i.Parser,t=e.parseError;return e.yy.parseError=function(){e.yy.ast&&e.yy.ast.initialize(),t.apply(e,arguments)},e};s.grammar=r,t.exports=s},{"../generated/parser":1,"./grammar":3}],7:[function(e,t,n){function r(e){return String(e).match(/^[0-9]+$/)?parseInt(e):Number.isFinite(e)?parseInt(e,10):0}t.exports=function(e,t,n,i){if("string"==typeof t)throw new Error("start cannot be a string");if("string"==typeof n)throw new Error("end cannot be a string");if("string"==typeof i)throw new Error("step cannot be a string");var s=e.length;if(0===i)throw new Error("step cannot be zero");if(i=i?r(i):1,n=n<0?s+n:n,t=r(0===(t=t<0?s+t:t)?0:t||(i>0?0:s-1)),n=r(0===n?0:n||(i>0?s:-1)),t=i>0?Math.max(0,t):Math.min(s,t),n=i>0?Math.min(n,s):Math.max(-1,n),i>0&&n<=t)return[];if(i<0&&t<=n)return[];for(var a=[],o=t;o!=n&&!(i<0&&o<=n||i>0&&o>=n);o+=i)a.push(e[o]);return a}},{}],8:[function(e,t,n){var r=e("util/"),i=Array.prototype.slice,s=Object.prototype.hasOwnProperty,a=t.exports=l;function o(e,t){return r.isUndefined(t)?""+t:r.isNumber(t)&&!isFinite(t)||r.isFunction(t)||r.isRegExp(t)?t.toString():t}function c(e,t){return r.isString(e)?e.length<t?e:e.slice(0,t):e}function u(e,t,n,r,i){throw new a.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function l(e,t){e||u(e,!0,t,"==",a.ok)}function h(e,t){if(e===t)return!0;if(r.isBuffer(e)&&r.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return r.isDate(e)&&r.isDate(t)?e.getTime()===t.getTime():r.isRegExp(e)&&r.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:r.isObject(e)||r.isObject(t)?function(e,t){if(r.isNullOrUndefined(e)||r.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(r.isPrimitive(e)||r.isPrimitive(t))return e===t;var n=p(e),s=p(t);if(n&&!s||!n&&s)return!1;if(n)return e=i.call(e),t=i.call(t),h(e,t);var a,o,c=m(e),u=m(t);if(c.length!=u.length)return!1;for(c.sort(),u.sort(),o=c.length-1;o>=0;o--)if(c[o]!=u[o])return!1;for(o=c.length-1;o>=0;o--)if(a=c[o],!h(e[a],t[a]))return!1;return!0}(e,t):e==t}function p(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function f(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function d(e,t,n,i){var s;r.isString(n)&&(i=n,n=null);try{t()}catch(e){s=e}if(i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),e&&!s&&u(s,n,"Missing expected exception"+i),!e&&f(s,n)&&u(s,n,"Got unwanted exception"+i),e&&s&&n&&!f(s,n)||!e&&s)throw s}a.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return c(JSON.stringify(e.actual,o),128)+" "+e.operator+" "+c(JSON.stringify(e.expected,o),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=t.name,s=r.indexOf("\n"+i);if(s>=0){var a=r.indexOf("\n",s+1);r=r.substring(a+1)}this.stack=r}}},r.inherits(a.AssertionError,Error),a.fail=u,a.ok=l,a.equal=function(e,t,n){e!=t&&u(e,t,n,"==",a.equal)},a.notEqual=function(e,t,n){e==t&&u(e,t,n,"!=",a.notEqual)},a.deepEqual=function(e,t,n){h(e,t)||u(e,t,n,"deepEqual",a.deepEqual)},a.notDeepEqual=function(e,t,n){h(e,t)&&u(e,t,n,"notDeepEqual",a.notDeepEqual)},a.strictEqual=function(e,t,n){e!==t&&u(e,t,n,"===",a.strictEqual)},a.notStrictEqual=function(e,t,n){e===t&&u(e,t,n,"!==",a.notStrictEqual)},a.throws=function(e,t,n){d.apply(this,[!0].concat(i.call(arguments)))},a.doesNotThrow=function(e,t){d.apply(this,[!1].concat(i.call(arguments)))},a.ifError=function(e){if(e)throw e};var m=Object.keys||function(e){var t=[];for(var n in e)s.call(e,n)&&t.push(n);return t}},{"util/":11}],9:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],10:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],11:[function(e,n,r){(function(t,n){var i=/%[sdj%]/g;r.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,s=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=s)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<s;c=r[++n])m(c)||!w(c)?a+=" "+c:a+=" "+o(c);return a},r.deprecate=function(e,i){if(g(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return function(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}};var s,a={};function o(e,t){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(t)?n.showHidden=t:t&&r._extend(n,t),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),l(n,e,n.depth)}function c(e,t){var n=o.styles[t];return n?"["+o.colors[n][0]+"m"+e+"["+o.colors[n][1]+"m":e}function u(e,t){return e}function l(e,t,n){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return y(i)||(i=l(e,i,n)),i}var s=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):d(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,t);if(s)return s;var a=Object.keys(t),o=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),S(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(t);if(0===a.length){if(x(t)){var c=t.name?": "+t.name:"";return e.stylize("[Function"+c+"]","special")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(S(t))return h(t)}var u,w="",O=!1,_=["{","}"];return f(t)&&(O=!0,_=["[","]"]),x(t)&&(w=" [Function"+(t.name?": "+t.name:"")+"]"),v(t)&&(w=" "+RegExp.prototype.toString.call(t)),k(t)&&(w=" "+Date.prototype.toUTCString.call(t)),S(t)&&(w=" "+h(t)),0!==a.length||O&&0!=t.length?n<0?v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=O?function(e,t,n,r,i){for(var s=[],a=0,o=t.length;a<o;++a)j(t,String(a))?s.push(p(e,t,n,r,String(a),!0)):s.push("");return i.forEach((function(i){i.match(/^\d+$/)||s.push(p(e,t,n,r,i,!0))})),s}(e,t,n,o,a):a.map((function(r){return p(e,t,n,o,r,O)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(u,w,_)):_[0]+w+_[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i,s){var a,o,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?o=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(o=e.stylize("[Setter]","special")),j(r,i)||(a="["+i+"]"),o||(e.seen.indexOf(c.value)<0?(o=m(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),g(a)){if(s&&i.match(/^\d+$/))return o;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+o}function f(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function m(e){return null===e}function b(e){return"number"==typeof e}function y(e){return"string"==typeof e}function g(e){return void 0===e}function v(e){return w(e)&&"[object RegExp]"===O(e)}function w(e){return"object"==typeof e&&null!==e}function k(e){return w(e)&&"[object Date]"===O(e)}function S(e){return w(e)&&("[object Error]"===O(e)||e instanceof Error)}function x(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function _(e){return e<10?"0"+e.toString(10):e.toString(10)}r.debuglog=function(e){if(g(s)&&(s=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(s)){var n=t.pid;a[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else a[e]=function(){};return a[e]},r.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=f,r.isBoolean=d,r.isNull=m,r.isNullOrUndefined=function(e){return null==e},r.isNumber=b,r.isString=y,r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=g,r.isRegExp=v,r.isObject=w,r.isDate=k,r.isError=S,r.isFunction=x,r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},r.isBuffer=e("./support/isBuffer");var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var e=new Date,t=[_(e.getHours()),_(e.getMinutes()),_(e.getSeconds())].join(":");return[e.getDate(),E[e.getMonth()],t].join(" ")}function j(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.log=function(){console.log("%s - %s",C(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,_process:14,inherits:9}],12:[function(e,t,n){},{}],13:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}n.resolve=function(){for(var n="",i=!1,s=arguments.length-1;s>=-1&&!i;s--){var a=s>=0?arguments[s]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,i="/"===a.charAt(0))}return(i?"/":"")+(n=t(r(n.split("/"),(function(e){return!!e})),!i).join("/"))||"."},n.normalize=function(e){var s=n.isAbsolute(e),a="/"===i(e,-1);return(e=t(r(e.split("/"),(function(e){return!!e})),!s).join("/"))||s||(e="."),e&&a&&(e+="/"),(s?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(r(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var i=r(e.split("/")),s=r(t.split("/")),a=Math.min(i.length,s.length),o=a,c=0;c<a;c++)if(i[c]!==s[c]){o=c;break}var u=[];for(c=o;c<i.length;c++)u.push("..");return(u=u.concat(s.slice(o))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!i){r=s;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},n.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var o=e.charCodeAt(a);if(47!==o)-1===r&&(i=!1,r=a+1),46===o?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1);else if(!i){n=a+1;break}}return-1===t||-1===r||0===s||1===s&&t===r-1&&t===n+1?"":e.slice(t,r)};var i="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,e("_process"))},{_process:14}],14:[function(e,t,n){var r,i,s=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var u,l=[],h=!1,p=-1;function f(){h&&u&&(h=!1,u.length?l=u.concat(l):p=-1,l.length&&d())}function d(){if(!h){var e=c(f);h=!0;for(var t=l.length;t;){for(u=l,l=[];++p<t;)u&&u[p].run();p=-1,t=l.length}u=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function b(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),1!==l.length||h||c(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=b,s.addListener=b,s.once=b,s.off=b,s.removeListener=b,s.removeAllListeners=b,s.emit=b,s.prependListener=b,s.prependOnceListener=b,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],15:[function(e,t,n){var r=e("escodegen").generate;t.exports=function(e,t){t||(t={});var n={},i=function e(i,s){if("Literal"===i.type)return i.value;if("UnaryExpression"===i.type){var a=e(i.argument);return"+"===i.operator?+a:"-"===i.operator?-a:"~"===i.operator?~a:"!"===i.operator?!a:n}if("ArrayExpression"===i.type){for(var o=[],c=0,u=i.elements.length;c<u;c++){if((y=e(i.elements[c]))===n)return n;o.push(y)}return o}if("ObjectExpression"===i.type){var l={};for(c=0;c<i.properties.length;c++){var h=null===(g=i.properties[c]).value?g.value:e(g.value);if(h===n)return n;l[g.key.value||g.key.name]=h}return l}if("BinaryExpression"===i.type||"LogicalExpression"===i.type){if((u=e(i.left))===n)return n;var p=e(i.right);if(p===n)return n;var f=i.operator;return"=="===f?u==p:"==="===f?u===p:"!="===f?u!=p:"!=="===f?u!==p:"+"===f?u+p:"-"===f?u-p:"*"===f?u*p:"/"===f?u/p:"%"===f?u%p:"<"===f?u<p:"<="===f?u<=p:">"===f?u>p:">="===f?u>=p:"|"===f?u|p:"&"===f?u&p:"^"===f?u^p:"&&"===f?u&&p:"||"===f?u||p:n}if("Identifier"===i.type)return{}.hasOwnProperty.call(t,i.name)?t[i.name]:n;if("ThisExpression"===i.type)return{}.hasOwnProperty.call(t,"this")?t.this:n;if("CallExpression"===i.type){var d=e(i.callee);if(d===n)return n;if("function"!=typeof d)return n;var m=i.callee.object?e(i.callee.object):n;m===n&&(m=null);var b=[];for(c=0,u=i.arguments.length;c<u;c++){var y;if((y=e(i.arguments[c]))===n)return n;b.push(y)}return d.apply(m,b)}var g;if("MemberExpression"===i.type)return(l=e(i.object))===n||"function"==typeof l?n:"Identifier"===i.property.type?l[i.property.name]:(g=e(i.property))===n?n:l[g];if("ConditionalExpression"===i.type)return(a=e(i.test))===n?n:e(a?i.consequent:i.alternate);if("ExpressionStatement"===i.type)return(a=e(i.expression))===n?n:a;if("ReturnStatement"===i.type)return e(i.argument);if("FunctionExpression"===i.type){var v=i.body.body,w={};for(Object.keys(t).forEach((function(e){w[e]=t[e]})),c=0;c<i.params.length;c++){var k=i.params[c];if("Identifier"!=k.type)return n;t[k.name]=null}for(var c in v)if(e(v[c])===n)return n;t=w;var S=Object.keys(t),x=S.map((function(e){return t[e]}));return Function(S.join(", "),"return "+r(i)).apply(null,x)}if("TemplateLiteral"===i.type){var O="";for(c=0;c<i.expressions.length;c++)O+=e(i.quasis[c]),O+=e(i.expressions[c]);return O+=e(i.quasis[c])}if("TaggedTemplateExpression"===i.type){var _=e(i.tag),E=i.quasi,C=E.quasis.map(e),j=E.expressions.map(e);return _.apply(null,[C].concat(j))}return"TemplateElement"===i.type?i.value.cooked:n}(e);return i===n?void 0:i}},{escodegen:12}],jsonpath:[function(e,t,n){t.exports=e("./lib/index")},{"./lib/index":5}]},{},["jsonpath"])("jsonpath")}).call(this,n(6))},function(e,t,n){(()=>{const t=n(4),{Task:r}=n(7),{ScriptingError:i}="./exceptions";e.exports=class{constructor(e,t,n){this.sessionType=n instanceof r?"task":"job",this.id=n.id,this.version=e,this.collection=t,this.initialObjects={},this.hash=this._getHash();const i=this.collection.export();this._resetState();for(const e of i.shapes)this.initialObjects.shapes[e.id]=e;for(const e of i.tracks)this.initialObjects.tracks[e.id]=e;for(const e of i.tags)this.initialObjects.tags[e.id]=e}_resetState(){this.initialObjects={shapes:{},tracks:{},tags:{}}}_getHash(){const e=this.collection.export();return JSON.stringify(e)}async _request(e,n){return await t.annotations.updateAnnotations(this.sessionType,this.id,e,n)}async _put(e){return await this._request(e,"put")}async _create(e){return await this._request(e,"create")}async _update(e){return await this._request(e,"update")}async _delete(e){return await this._request(e,"delete")}_split(e){const t={created:{shapes:[],tracks:[],tags:[]},updated:{shapes:[],tracks:[],tags:[]},deleted:{shapes:[],tracks:[],tags:[]}},n=["id","label_id","group","frame","occluded","z_order","points","type","shapes","attributes","value","spec_id","outside"];for(const r of Object.keys(e))for(const s of e[r])if(s.id in this.initialObjects[r]){JSON.stringify(s,n)!==JSON.stringify(this.initialObjects[r][s.id],n)&&t.updated[r].push(s)}else{if(void 0!==s.id)throw new i(`Id of object is defined "${s.id}"`+"but it absents in initial state");t.created[r].push(s)}const r={shapes:e.shapes.map(e=>+e.id),tracks:e.tracks.map(e=>+e.id),tags:e.tags.map(e=>+e.id)};for(const e of Object.keys(this.initialObjects))for(const n of Object.keys(this.initialObjects[e]))if(!r[e].includes(+n)){const r=this.initialObjects[e][n];t.deleted[e].push(r)}return t}_updateCreatedObjects(e,t){const n=e.tracks.length+e.shapes.length+e.tags.length,r=t.tracks.length+t.shapes.length+t.tags.length;if(r!==n)throw new i("Number of indexes is differed by number of saved objects"+`${r} vs ${n}`);for(const n of Object.keys(t))for(let r=0;r<t[n].length;r++){const i=t[n][r];this.collection.objects[i].serverID=e[n][r].id}}_receiveIndexes(e){const t={tracks:e.tracks.map(e=>e.clientID),shapes:e.shapes.map(e=>e.clientID),tags:e.tags.map(e=>e.clientID)};return e.tracks.concat(e.shapes).concat(e.tags).map(e=>(delete e.clientID,e)),t}async save(e){"function"!=typeof e&&(e=e=>{console.log(e)});const t=this.collection.export(),{flush:n}=this.collection;if(n){e("Created objects are being saved on the server");const n=this._receiveIndexes(t),r=await this._put({...t,version:this.version});this.version=r.version,this.collection.flush=!1,this._updateCreatedObjects(r,n),this._resetState();for(const e of Object.keys(this.initialObjects))for(const t of r[e])this.initialObjects[e][t.id]=t}else{const{created:n,updated:r,deleted:i}=this._split(t);e("Created objects are being saved on the server");const s=this._receiveIndexes(n),a=await this._create({...n,version:this.version});this.version=a.version,this._updateCreatedObjects(a,s);for(const e of Object.keys(this.initialObjects))for(const t of a[e])this.initialObjects[e][t.id]=t;e("Updated objects are being saved on the server"),this._receiveIndexes(r);const o=await this._update({...r,version:this.version});this.version=o.version;for(const e of Object.keys(this.initialObjects))for(const t of o[e])this.initialObjects[e][t.id]=t;e("Deleted objects are being deleted from the server"),this._receiveIndexes(i);const c=await this._delete({...i,version:this.version});this._version=c.version;for(const e of Object.keys(this.initialObjects))for(const t of c[e])delete this.initialObjects[e][t.id]}this.hash=this._getHash()}hasUnsavedChanges(){return this._getHash()!==this.hash}}})()},function(e,t){e.exports=class{constructor(){this.clear()}get(){return{undo:this._undo.map(e=>[e.action,e.frame]),redo:this._redo.map(e=>[e.action,e.frame])}}do(e,t,n,r,i){const s={clientIDs:r,action:e,undo:t,redo:n,frame:i};this._undo=this._undo.slice(-127),this._undo.push(s),this._redo=[]}undo(e){const t=[];for(let n=0;n<e;n++){const e=this._undo.pop();if(!e)break;e.undo(),this._redo.push(e),t.push(...e.clientIDs)}return t}redo(e){const t=[];for(let n=0;n<e;n++){const e=this._redo.pop();if(!e)break;e.redo(),this._undo.push(e),t.push(...e.clientIDs)}return t}clear(){this._undo=[],this._redo=[]}}},function(e){e.exports=JSON.parse('{"name":"cvat-core","version":"1.0.0","description":"Part of Computer Vision Tool which presents an interface for client-side integration","main":"babel.config.js","scripts":{"build":"webpack","test":"jest --config=jest.config.js --coverage","docs":"jsdoc --readme README.md src/*.js -p -c jsdoc.config.js -d docs","coveralls":"cat ./reports/coverage/lcov.info | coveralls"},"author":"Intel","license":"MIT","devDependencies":{"@babel/cli":"^7.4.4","@babel/core":"^7.4.4","@babel/preset-env":"^7.4.4","airbnb":"0.0.2","babel-eslint":"^10.0.1","babel-loader":"^8.0.6","coveralls":"^3.0.5","eslint":"6.1.0","eslint-config-airbnb-base":"14.0.0","eslint-plugin-import":"2.18.2","eslint-plugin-no-unsafe-innerhtml":"^1.0.16","eslint-plugin-no-unsanitized":"^3.0.2","eslint-plugin-security":"^1.4.0","jest":"^24.8.0","jest-junit":"^6.4.0","jsdoc":"^3.6.2","webpack":"^4.31.0","webpack-cli":"^3.3.2"},"dependencies":{"axios":"^0.18.0","browser-or-node":"^1.2.1","cvat-data":"../cvat-data","detect-browser":"^5.0.0","error-stack-parser":"^2.0.2","form-data":"^2.5.0","jest-config":"^24.8.0","js-cookie":"^2.2.0","jsonpath":"^1.0.2","platform":"^1.3.5","store":"^2.0.12","worker-loader":"^2.0.0"}}')},function(e,t,n){(()=>{const t=n(3),r=n(4),{isBoolean:i,isInteger:s,isEnum:a,isString:o,checkFilter:c}=n(9),{TaskStatus:u,TaskMode:l}=n(2),h=n(14),{AnnotationFormats:p}=n(23),{ArgumentError:f}=n(0),{Task:d}=n(7);function m(e,t){null!==e.assignee&&([e.assignee]=t.filter(t=>t.id===e.assignee));for(const n of e.segments)for(const e of n.jobs)null!==e.assignee&&([e.assignee]=t.filter(t=>t.id===e.assignee));return null!==e.owner&&([e.owner]=t.filter(t=>t.id===e.owner)),e}e.exports=function(e){return e.plugins.list.implementation=t.list,e.plugins.register.implementation=t.register.bind(e),e.server.about.implementation=async()=>await r.server.about(),e.server.share.implementation=async e=>await r.server.share(e),e.server.formats.implementation=async()=>{const e=await r.server.formats();return new p(e)},e.server.register.implementation=async(e,t,n,i,s,a)=>{await r.server.register(e,t,n,i,s,a)},e.server.login.implementation=async(e,t)=>{await r.server.login(e,t)},e.server.logout.implementation=async()=>{await r.server.logout()},e.server.authorized.implementation=async()=>await r.server.authorized(),e.server.request.implementation=async(e,t)=>await r.server.request(e,t),e.users.get.implementation=async e=>{c(e,{self:i});let t=null;return"self"in e&&e.self?(t=await r.users.getSelf(),t=[t]):t=await r.users.getUsers(),t=t.map(e=>new h(e)),t},e.jobs.get.implementation=async e=>{if(c(e,{taskID:s,jobID:s}),"taskID"in e&&"jobID"in e)throw new f('Only one of fields "taskID" and "jobID" allowed simultaneously');if(!Object.keys(e).length)throw new f("Job filter must not be empty");let t=null;if("taskID"in e)t=await r.tasks.getTasks(`id=${e.taskID}`);else{const n=await r.jobs.getJob(e.jobID);void 0!==n.task_id&&(t=await r.tasks.getTasks(`id=${n.task_id}`))}if(null!==t&&t.length){const n=(await r.users.getUsers()).map(e=>new h(e)),i=new d(m(t[0],n));return e.jobID?i.jobs.filter(t=>t.id===e.jobID):i.jobs}return[]},e.tasks.get.implementation=async e=>{if(c(e,{page:s,name:o,id:s,owner:o,assignee:o,search:o,status:a.bind(u),mode:a.bind(l)}),"search"in e&&Object.keys(e).length>1&&(!("page"in e)||2!==Object.keys(e).length))throw new f('Do not use the filter field "search" with others');if("id"in e&&Object.keys(e).length>1&&(!("page"in e)||2!==Object.keys(e).length))throw new f('Do not use the filter field "id" with others');const t=new URLSearchParams;for(const n of["name","owner","assignee","search","status","mode","id","page"])Object.prototype.hasOwnProperty.call(e,n)&&t.set(n,e[n]);const n=(await r.users.getUsers()).map(e=>new h(e)),i=await r.tasks.getTasks(t.toString()),p=i.map(e=>m(e,n)).map(e=>new d(e));return p.count=i.count,p},e}})()}]);
//# sourceMappingURL=cvat-core.min.js.map